(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){},27:function(e,t,a){e.exports=a(43)},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(23),c=a.n(o),i=(a(33),a(3)),l=(a(34),a(35),a(14)),u=a.n(l),s=a(19),d=a(18),b=a(10),g=a(2),f=a.n(g),m=a(4),h=a(9),p=a(6),j=a(5),O=a(7),v=f.a.PickedObject,y=f.a.SurfacePolygon;f.a.SurfaceShape,f.a.SurfacePolygon;function w(e){var t=e.id,a=e.clon,n=e.clat,o=e.alt,c=e.starfield,l=e.atmosphere,g=e.names,m=Object(r.useRef)(null),h=Object(r.useState)("3D"),p=Object(i.a)(h,2),j=(p[0],p[1]),O=Object(r.useState)(""),v=Object(i.a)(O,2),y=(v[0],v[1],Object(r.useState)([])),w=Object(i.a)(y,2),S=w[0],T=w[1],E=Object(r.useState)([]),C=Object(i.a)(E,2),k=(C[0],C[1],Object(r.useState)({latitude:n,longitude:a,altitude:o,aoi:"",pickedItems:[]})),D=Object(i.a)(k,2),L=D[0],N=D[1];function P(e){console.log(e.computeSectors(m.current.drawContext)),console.log(f.a.Sector.FULL_SPHERE);var t={service:"https://view.onda-dias.eu/instance00/ows",layerNames:"S1_IW_GRDH_FullResolution",title:"quicklook",numLevels:19,format:"image/png",size:256,sector:e.computeSectors(m.current.drawContext)[0],levelZeroDelta:new f.a.Location(90,90)},a=new f.a.WmsLayer(t,e.userProperties.date);m.current.addLayer(a),m.current.redraw(),console.log(m.current.layers)}function M(e){for(var t=0;t<m.current.layers.length;t++)if(m.current.layers[t].displayName===e)return m.current.layers[t];return null}function A(e){return R.apply(this,arguments)}function R(){return(R=Object(d.a)(u.a.mark(function e(t){var a,r,n,o,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(108e5,a=0;a<m.current.layers.length;a++){if(m.current.layers[a].displayName.includes("Products:"))for(r=0;r<m.current.layers[a].renderables.length;r++)n=m.current.layers[a].renderables[r],0!=t?(o=new Date(n.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime).getTime(),c=new Date(n.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStopTime).getTime(),n.enabled=o<=t+54e5&&c>=t-54e5):n.enabled=!1;m.current.layers[a].displayName}case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var F=function(){var e=m.current.navigator.lookAtLocation.longitude,t=m.current.navigator.lookAtLocation.latitude,a=m.current.navigator.range,r=a<2e6?function(){var e,t,a=m.current.viewport,r="";try{(e=m.current.pickTerrain(m.current.canvasCoordinates(a.x,a.y+a.height)).terrainObject().position).latitude=Math.round(1e4*e.latitude)/1e4,e.longitude=Math.round(1e4*e.longitude)/1e4}catch(n){e=null}try{(t=m.current.pickTerrain(m.current.canvasCoordinates(a.x+a.width,a.y)).terrainObject().position).latitude=Math.round(1e4*t.latitude)/1e4,t.longitude=Math.round(1e4*t.longitude)/1e4}catch(n){t=null}return null==e||null==t?r="":(e.longitude,e.latitude,t.longitude,t.latitude,r="POLYGON(("+e.longitude+" "+e.latitude+","+t.longitude+" "+e.latitude+","+t.longitude+" "+t.latitude+","+e.longitude+" "+t.latitude+","+e.longitude+" "+e.latitude+"))"),r}():"";N(function(n){return Object(s.a)({},n,{longitude:e,latitude:t,altitude:a,viewpolygon:r})})},W=function(e){var t=e.clientX,a=e.clientY,r=m.current.pick(m.current.canvasCoordinates(t,a));if(console.log(r),r.terrainObject()){m.current.removeLayer(M("quicklook"));for(var n=0;n<m.current.layers.length;n++)if(m.current.layers[n].displayName.includes("Products:"))for(var o=0;o<m.current.layers[n].renderables.length;o++){m.current.layers[n].renderables[o].highlighted=!1}for(var c=[],i=0;i<r.objects.length;i++)r.objects[i].userObject instanceof f.a.SurfaceShape&&(c.push(r.objects[i].userObject),r.objects[i].userObject.highlighted=!r.objects[i].userObject.highlighted,P(r.objects[i].userObject));console.log(c),N(function(e){return Object(s.a)({},e,{pickedItems:c})}),m.current.redraw()}else console.log("No position !")},x=function(e){console.log("double click");var t,a=e.clientX,r=e.clientY,n=m.current.pick(m.current.canvasCoordinates(a,r));if(n.terrainObject()){var o="POINT("+(t=n.terrainObject().position).longitude+" "+t.latitude+")";N(function(e){return Object(s.a)({},e,{aoi:o})})}else console.log("No position !"),N(function(e){return Object(s.a)({},e,{aoi:""})})};return Object(r.useEffect)(function(){console.log("useEffect (mount) in Eww  star/atmo: "+c+"/"+l),m.current=new f.a.WorldWindow(t),m.current.redrawCallbacks.push(F),f.a.BasicWorldWindowController.prototype.applyLimits=function(){m.current.navigator.range=f.a.WWMath.clamp(m.current.navigator.range,2e3,3e8)};var e=new f.a.ClickRecognizer(m.current,W);e.numberOfClicks=1;var r=new f.a.ClickRecognizer(m.current,x);r.numberOfClicks=2,r.recognizeSimultaneouslyWith(e),r.maxClickInterval=200;var i=new f.a.TapRecognizer(m.current,W);i.numberOfTaps=1;var u=new f.a.TapRecognizer(m.current,x);u.numberOfTaps=2,u.recognizeSimultaneouslyWith(i),u.maxTapInterval=200;var s={service:"https://tiles.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},d={service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",title:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)};f.a.configuration.baseUrl=f.a.configuration.baseUrl.slice(0,-3);for(var b=new f.a.StarFieldLayer,h=new f.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg"),p=new f.a.RenderableLayer("Quicklooks"),j=[{layer:new f.a.WmsLayer(s,""),enabled:!0},{layer:new f.a.WmsLayer(d,""),enabled:g},{layer:b,enabled:c},{layer:h,enabled:l},{layer:p,enabled:!0}],O=0;O<j.length;O++)j[O].layer.enabled=j[O].enabled,m.current.addLayer(j[O].layer);b.time=new Date,h.time=new Date,setTimeout(function(){m.current.goToAnimator.travelTime=1e3,m.current.goTo(new f.a.Position(n,a,o)),m.current.redraw()},2e3),m.current.redraw(),m.current.deepPicking=!0},[]),{ewwstate:L,removeGeojson:function(){for(var e=0;e<S.length;e++)m.current.removeLayer(S[e]);T(function(e){return[]}),m.current.redraw()},addGeojson:function(e,t){var a=new f.a.RenderableLayer("Products: "+e.properties.updated+Math.ceil(1e4*Math.random()));m.current.addLayer(a),new f.a.GeoJSONParser(e).load(function(){console.log(a),T(function(e){return[].concat(Object(b.a)(e),[a])}),A(t),m.current.redraw()},function(e,t){var a={};a.userProperties=t;var r=new f.a.PlacemarkAttributes(null);return r.imageScale=10,r.imageColor=new f.a.Color(0,1,1,.2),r.labelAttributes.offset=new f.a.Offset(f.a.OFFSET_FRACTION,5,f.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?a.attributes=new f.a.PlacemarkAttributes(r):e.isLineStringType()||e.isMultiLineStringType()?(a.attributes.drawOutline=!0,a.attributes.outlineColor=new f.a.Color(.1*a.attributes.interiorColor.red,.3*a.attributes.interiorColor.green,.7*a.attributes.interiorColor.blue,1),a.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(a.attributes=new f.a.ShapeAttributes(null),a.attributes.interiorColor=new f.a.Color(1,0,0,.2),a.attributes.outlineColor=new f.a.Color(1,0,0,.3),a.highlightAttributes=new f.a.ShapeAttributes(a.attributes),a.highlightAttributes.outlineColor=new f.a.Color(1,0,0,.4),a.highlightAttributes.interiorColor=new f.a.Color(1,0,0,0)),a},a)},addWMS:function(){},toggleStarfield:function(){console.log("toggleStarfield"),m.current.layers[2].enabled=!m.current.layers[2].enabled,m.current.redraw()},toggleAtmosphere:function(){console.log("toggleAtmosphere"),m.current.layers[3].enabled=!m.current.layers[3].enabled,m.current.redraw()},setTime:function(e){M("StarField").time=M("Atmosphere").time=new Date(e),A(e),m.current.redraw()},toggleProjection:function(){j(function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator"],a=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[a]),t[a]){case"3D":m.current.globe.projection=new f.a.ProjectionWgs84;break;case"Equirectangular":m.current.globe.projection=new f.a.ProjectionEquirectangular;break;case"Mercator":m.current.globe.projection=new f.a.ProjectionMercator;break;case"North Polar":m.current.globe.projection=new f.a.ProjectionPolarEquidistant("North");break;case"South Polar":m.current.globe.projection=new f.a.ProjectionPolarEquidistant("South");break;default:m.current.globe.projection=new f.a.ProjectionWgs84}return m.current.redraw(),t[a]})},toggleNames:function(){console.log("toggleNames"),m.current.layers[1].enabled=!m.current.layers[1].enabled,m.current.redraw()}}}var S=a(11);var T=function(e){var t=e.viewdate,a=e.id,o=w({id:a,clat:e.clat,clon:e.clon,alt:e.alt,starfield:e.starfield,atmosphere:e.atmosphere,names:e.names}),c=(o.ewwstate,o.addGeojson,o.removeGeojson),i=(o.addWMS,o.toggleProjection),l=o.toggleAtmosphere,u=o.toggleStarfield,s=o.toggleNames,d=o.setTime;return Object(S.a)("p",i),Object(S.a)("a",l),Object(S.a)("s",u),Object(S.a)("n",s),Object(S.a)("c",c),Object(r.useEffect)(function(){d(t.getTime())},[t]),n.a.createElement("canvas",{id:a,style:{background:"inherit",position:"fixed",left:0,width:"100%",height:"100%"}})},E=a(20),C=a.n(E);a(38);var k=function(e){var t=e.date,a=e.highlight,r=e.animated;return n.a.createElement("div",{className:"LabelContainer"},n.a.createElement("div",{className:"Date"},n.a.createElement("div",{className:"day"===a||"none"===a?"DayLabel":"DayLabel Greyedout",key:"day"},C()(t,"UTC:dd")),n.a.createElement("div",{className:"YearMonth"},n.a.createElement("div",{className:"month"===a||"none"===a?"MonthLabel ":"MonthLabel  Greyedout",key:"month"},C()(t,"UTC:mmm").toUpperCase()),n.a.createElement("div",{className:"year"===a||"none"===a?"YearLabel ":"YearLabel Greyedout",key:"year"},t.getUTCFullYear()))),n.a.createElement("div",{className:r?"Line  Line-active":"Line",key:"line"}),n.a.createElement("div",{className:"time"===a||"none"===a?"TimeLabel ":"TimeLabel Greyedout",key:"time"},C()(t,"UTC:HH:MM:ss")))};a(39);var D=function(e){var t=e.startdate,a=e.onDateChange,o=function(e){var t=e.autoStart,a=(e.duration,e.initdate),n=Object(r.useState)(a),o=Object(i.a)(n,2),c=o[0],l=o[1],u=Object(r.useState)(!1),s=Object(i.a)(u,2),d=s[0],b=s[1],g=Object(r.useRef)(),f=Object(r.useRef)();f.current=200;var m=Object(r.useRef)(),h=Object(r.useRef)(),p=Object(r.useRef)();function j(){console.log("start clock"),g.current||(g.current=36e5),h.current=setInterval(function(){m.current+=g.current,l(new Date(m.current))},f.current),b(!0)}function O(){console.log("stop clock"),p.current&&clearTimeout(p.current),h.current&&clearInterval(h.current),b(!1)}return Object(r.useEffect)(function(){console.log("init start useclock "+a.toJSON()),d?(O(),m.current=a.getTime(),j()):m.current=a.getTime()},[a]),Object(r.useEffect)(function(){console.log("render useclock"),m.current=(new Date).getTime(),t&&j()},[]),{date:c,playing:d,togglePause:function(){d?O():j()},reset:function(){O(),m.current=(new Date).getTime(),l(new Date(m.current))},increaseSpeed:function(){g.current=g.current>0?g.current*=2:g.current/=2,Math.abs(g.current)<f.current&&(g.current=f.current),console.log("step: "+g.current)},decreaseSpeed:function(){g.current=g.current>0?g.current/=2:g.current*=2,Math.abs(g.current)<f.current&&(g.current=-1*f.current)},forceDate:function(e){console.log("forcedate useclock: "+e.toJSON()),d?(O(),m.current=e.getTime(),j()):m.current=e.getTime()}}}({autoStart:!1,duration:6e5,initdate:t}),c=o.date,l=o.togglePause,u=o.reset,s=o.increaseSpeed,d=o.decreaseSpeed;Object(S.a)("t",l),Object(S.a)("r",function(){u()}),Object(S.a)(".",s),Object(S.a)(",",d),Object(r.useEffect)(function(){a(c)},[c]),Object(r.useEffect)(function(){},[t]);var b=Object(r.useState)(),g=Object(i.a)(b,2),f=g[0],m=g[1];return n.a.createElement("div",{className:"DateController",onClick:function(){var e=Date.now();f&&e-f<300?u():(m(e),l())}})},L=a(16),N=a(24),P=a(17);a(22);var M=function(e){var t=e.date,a=e.zoomfactor,o=e.immediate,c=Object(r.useRef)(),l=Object(r.useState)(t),u=Object(i.a)(l,2),s=(u[0],u[1],Object(r.useState)(!1)),d=Object(i.a)(s,2),b=(d[0],d[1],Object(r.useState)("")),g=Object(i.a)(b,2),f=g[0],m=g[1];Object(r.useEffect)(function(){return function(){}});var h=function(e,t){if(c.current){for(var a,r,o,i=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],l=0,u=0,s=0,d=0,b=0,g=[],f=t<2592e7,m=t<432e6,h=t<72e5,p=t<12e5,j=t<48e4,O=0;O<c.current.offsetHeight;O+=1){var v=new Date((O-c.current.offsetHeight/2)*t+e.getTime());a=v.getUTCDate(),r=i[v.getUTCMonth()],o=v.getUTCHours(),l=v.getUTCFullYear(),p?o!=b&&(0==o||o%2!=0&&!j?0==o&&(g.push({class:"DayTic",pos:O,label:a}),g.push({class:"MonthTic",pos:O,label:r}),g.push({class:"YearTic",pos:O,label:l})):g.push({class:"HourTic",pos:O,label:o})):h?a!==u&&(1!=a?g.push({class:"DayTic",pos:O,label:a}):(g.push({class:"DayTic",pos:O,label:a}),g.push({class:"MonthTic",pos:O,label:r}),g.push({class:"YearTic",pos:O,label:l}))):m?r!==s&&0!=u&&m&&("JAN"!==r?g.push({class:"MonthTic",pos:O,label:r}):(g.push({class:"MonthTic",pos:O,label:r}),g.push({class:"YearTic",pos:O,label:l}))):f&&l!==d&&0!==s&&("JAN"!==r?g.push({class:"MonthTic",pos:O,label:r}):g.push({class:"YearTic",pos:O,label:l})),u=a,d=l,s=r,b=o}return g.map(function(e){return n.a.createElement("div",{className:e.class,key:e.class+e.pos,style:{top:e.pos}},e.label)})}},p=Object(L.b)(function(){return{dater:t.getTime(),zoomer:a}}),j=Object(i.a)(p,2),O=j[0],v=O.dater,y=O.zoomer,w=j[1];return Object(r.useLayoutEffect)(function(){w({to:{zoomer:a,dater:t.getTime()},config:{duration:400},immediate:!1,onFrame:function(){m(h(new Date(v.value),y.value))}})},[a]),Object(r.useLayoutEffect)(function(){w({to:{zoomer:a,dater:t.getTime()},config:{duration:400},immediate:o,onFrame:function(){m(h(new Date(v.value),y.value))}})},[t]),n.a.createElement(L.a.div,{ref:c,className:"DateSelectorScale"},f)};var A=function(e){var t=e.startdate,a=e.onDateChange,o=e.onFinalDateChange,c=[36e5,864e5,1296e6],l=[36e5,6e5,108e3,27e3,864e5],u=Object(r.useRef)(),s=Object(r.useRef)();s.current||(s.current=[0,0]);var d=Object(r.useState)(t),b=Object(i.a)(d,2),g=b[0],f=b[1],m=Object(r.useState)(t),h=Object(i.a)(m,2),p=h[0],j=h[1],O=Object(r.useState)(t),v=Object(i.a)(O,2),y=v[0],w=v[1],S=Object(r.useState)(!1),T=Object(i.a)(S,2),E=T[0],C=T[1],k=Object(r.useState)(c[0]),D=Object(i.a)(k,2),A=D[0],R=D[1],F=Object(L.b)(function(){return{xy:[0,0]}}),W=Object(i.a)(F,2),x=W[0].xy,U=W[1],z=Object(N.a)({onDrag:function(e){var t,a,r=e.event,n=e.first,i=e.down,d=e.delta,b=e.velocity,m=e.direction,h=e.temp,p=void 0===h?{xy:x.getValue(),laststeparea:0,deltaoffset:[0,0]}:h,O=u.current.parentElement.offsetWidth-(r.pageX?r.pageX:u.current.parentElement.offsetWidth);return(r.pageY?r.pageY:u.current.parentElement.offsetHeight)-u.current.offsetHeight/2>0?(t=Math.min(c.length-1,Math.floor((O-u.current.offsetWidth)/60+1)),a=c[t=(t=t>c.length-1?c.length:t)<0?0:t]):(t=Math.min(l.length-1,Math.floor((O-u.current.offsetWidth)/60+1)),a=l[t=(t=t>l.length-1?l.length:t)<0?0:t]),t!==p.laststeparea&&(console.log(" step changed: "+p.laststeparea+" to "+t),R(a),w(g),p.laststeparea=t,p.xy=[0,0],p.deltaoffset=d),n&&C(!0),b=Math.abs(b)<.2?0:b,U({xy:Object(P.add)(Object(P.scale)(Object(P.add)(Object(P.sub)(d,p.deltaoffset),s.current),1),p.xy),immediate:i,config:{velocity:Object(P.scale)(m,1*b),decay:!0},onFrame:function(){var e=new Date(y.getTime()-x.getValue()[1]*A);f(e),j(e)},onRest:function(){if(!i){C(!1);var e=new Date(y.getTime()-x.getValue()[1]*A);o(e),s.current=[0,0]}}}),p}});return Object(r.useEffect)(function(){E||(s.current[1]-=(t.getTime()-p.getTime())/A,f(t),j(t))},[t]),Object(r.useEffect)(function(){a(g)},[g]),n.a.createElement(L.a.div,Object.assign({},z(),{className:"DateSelector",ref:u}),n.a.createElement("div",{className:"Mask"},n.a.createElement(M,{className:"scale",date:g,zoomfactor:A,immediate:E}),n.a.createElement("div",{className:"TriangleContainer"},n.a.createElement("svg",{height:"40",width:"20",className:"Triangle"},n.a.createElement("polygon",{points:"20,5 20,35 12,20"})))))};var R=function(e){var t=e.startdate,a=e.onDateChange,o=(e.onFinalDateChange,e.searching),c=Object(r.useState)(t),l=Object(i.a)(c,2),u=l[0],s=l[1],d=Object(r.useState)(t),b=Object(i.a)(d,2),g=b[0],f=b[1],m=Object(r.useState)(t),h=Object(i.a)(m,2),p=h[0],j=h[1];return Object(r.useEffect)(function(){s(t)},[t]),n.a.createElement("div",null,n.a.createElement(D,{startdate:g,onDateChange:function(e){s(e)}}),n.a.createElement(k,{date:p,highlight:"none",animated:o}),n.a.createElement(A,{startdate:u,onDateChange:function(e){j(e),a(e)},onFinalDateChange:function(e){f(e)}}))},F=a(25),W=a.n(F),x=a(26);var U=function(){var e=new Date,t=Object(r.useState)(e),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(r.useState)(e),u=Object(i.a)(l,1)[0],s=Object(r.useState)(!1),d=Object(i.a)(s,1)[0];Object(r.useEffect)(function(){},[]),Object(r.useEffect)(function(){},[u]);var b=Object(r.useState)(!1),g=Object(i.a)(b,2),f=g[0],m=g[1],h=Object(x.a)(window.document.body),p=h.isFullscreen,j=h.toggleFullscreen;return Object(S.a)("f",j),n.a.createElement("div",{className:"App"},n.a.createElement(W.a,{enabled:f,onChange:function(){p||m(!1)}},n.a.createElement("div",{className:"Earth"},n.a.createElement(T,{viewdate:o,id:"globe",starfield:"true",atmosphere:"true",clon:"0.5",clat:"40",names:"true"})),n.a.createElement(R,{startdate:u,searching:d,onDateChange:function(e){c(e)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.8eb643e8.chunk.js.map