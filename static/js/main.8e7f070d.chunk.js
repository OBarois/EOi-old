(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,a){},41:function(e,t,a){e.exports=a(73)},47:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(37),o=a.n(i),s=(a(47),a(2)),c=a(3),l=a.n(c),u=(a(61),a(62),a(11)),h=a.n(u),g=a(12),m=a(21),d=a(15),f=a(1),b=a.n(f),E=a(5),_=a(9),v=a(8),p=a(6),S=a(7),M=b.a.Angle,O=b.a.ArgumentError,R=b.a.Logger,A={getAsGeographicLocation:function(e){if(e instanceof Date===!1)throw new O(R.logMessage(R.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var t=this.getAsCelestialLocation(e);return this.celestialToGeographic(t,e)},getAsCelestialLocation:function(e){if(e instanceof Date===!1)throw new O(R.logMessage(R.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var t=this.computeJulianDate(e)-2451545,a=this.normalizeAngle360(280.46+.9856474*t),n=this.normalizeAngle360(357.528+.9856003*t)*M.DEGREES_TO_RADIANS,r=a+1.915*Math.sin(n)+.02*Math.sin(2*n),i=r*M.DEGREES_TO_RADIANS,o=(23.439-4e-7*t)*M.DEGREES_TO_RADIANS,s=Math.asin(Math.sin(o)*Math.sin(i))*M.RADIANS_TO_DEGREES,c=Math.atan(Math.cos(o)*Math.tan(i))*M.RADIANS_TO_DEGREES;return r>=90&&r<270&&(c+=180),{declination:s,rightAscension:c=this.normalizeAngle360(c)}},celestialToGeographic:function(e,t){if(!e)throw new O(R.logMessage(R.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(t instanceof Date===!1)throw new O(R.logMessage(R.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var a=this.computeJulianDate(t)-2451545,n=this.normalizeAngle360(280.46061837+360.98564736629*a),r=this.normalizeAngle360(n-e.rightAscension),i=M.normalizedDegreesLongitude(-r);return{latitude:e.declination,longitude:i}},computeJulianDate:function(e){if(e instanceof Date===!1)throw new O(R.logMessage(R.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var t=e.getUTCFullYear(),a=e.getUTCMonth()+1,n=e.getUTCDate(),r=(e.getUTCHours()+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24;a<=2&&(t-=1,a+=12);var i=Math.trunc(t/100),o=2-i+Math.trunc(i/4);return Math.trunc(365.25*(t+4716))+Math.trunc(30.6001*(a+1))+n+o-1524.5+r},normalizeAngle360:function(e){var t=e%360;return t>=0?t:t<0?360+t:360-t}},y=b.a.Angle,w={SUN:0,MERCURY:1,VENUS:2,MARS:4,JUPITER:5,SATURN:6,URANUS:7,NEPTUNE:8,getCelestialLocation:function(e,t){var a,n=A.computeJulianDate(t)-2451543.5;switch(e){case this.SUN:a=this.computeSun(n);break;case this.MERCURY:a=this.computeMercury(n);break;case this.VENUS:a=this.computeVenus(n);break;case this.MARS:a=this.computeMars(n);break;case this.JUPITER:a=this.computeJupiter(n);break;case this.SATURN:a=this.computeSaturn(n);break;case this.URANUS:a=this.computeUranus(n);break;case this.NEPTUNE:a=this.computeNeptune(n)}return this.computePosition(n,a)},computeMercury:function(e){return{N:48.3313+324587e-10*e,i:7.0047+5e-8*e,w:29.1241+101444e-10*e,a:.387098,e:.205635+5.59e-10*e,M:168.6562+4.0923344368*e}},computeVenus:function(e){return{N:76.6799+24659e-9*e,i:3.3946+2.75e-8*e,w:54.891+138374e-10*e,a:.72333,e:.006773-1.302e-9*e,M:48.0052+1.6021302244*e}},computeMars:function(e){return{N:49.5574+211081e-10*e,i:1.8497-1.78e-8*e,w:286.5016+292961e-10*e,a:1.523688,e:.093405+2.516e-9*e,M:18.6021+.5240207766*e}},computeJupiter:function(e){return{N:100.4542+276854e-10*e,i:1.303-1.557e-7*e,w:273.8777+164505e-10*e,a:5.20256,e:.048498+4.469e-9*e,M:19.895+.0830853001*e}},computeSaturn:function(e){return{N:113.6634+23898e-9*e,i:2.4886-1.081e-7*e,w:339.3939+297661e-10*e,a:9.55475,e:.055546-9.499e-9*e,M:316.967+.0334442282*e}},computeUranus:function(e){return{N:74.0005+13978e-9*e,i:.7733+1.9e-8*e,w:96.6612+30565e-9*e,a:19.18171-1.55e-8*e,e:.047318+7.45e-9*e,M:142.5905+.011725806*e}},computeNeptune:function(e){return{N:131.7806+30173e-9*e,i:1.77-2.55e-7*e,w:272.8461-6027e-9*e,a:30.05826+3.313e-8*e,e:.008606+2.15e-9*e,M:260.2471+.005995147*e}},computeSun:function(e){return{N:0,i:0,w:282.9404+470935e-10*e,a:1,e:.016709-1.151e-9*e,M:356.047+.9856002585*e}},computePosition:function(e,t){var a=t.N,n=t.i,r=t.w,i=t.a,o=t.e,s=t.M;a=A.normalizeAngle360(a)*y.DEGREES_TO_RADIANS,n=A.normalizeAngle360(n)*y.DEGREES_TO_RADIANS,r=A.normalizeAngle360(r)*y.DEGREES_TO_RADIANS;var c=(s=A.normalizeAngle360(s)*y.DEGREES_TO_RADIANS)+o*Math.sin(s)*(1+o*Math.cos(s));if(o>=.06)for(var l=0;l<10;l++){var u=c-(c-o*Math.sin(c)-s)/(1-o*Math.cos(c));if(Math.abs(u-c)<.001){c=u;break}c=u}var h=i*(Math.cos(c)-o),g=i*(Math.sqrt(1-o*o)*Math.sin(c)),m=Math.atan2(g,h),d=Math.sqrt(h*h+g*g),f=d*(Math.cos(a)*Math.cos(m+r)-Math.sin(a)*Math.sin(m+r)*Math.cos(n)),b=d*(Math.sin(a)*Math.cos(m+r)+Math.cos(a)*Math.sin(m+r)*Math.cos(n)),E=d*(Math.sin(m+r)*Math.sin(n)),_=382394e-10*(0-e)*y.DEGREES_TO_RADIANS,v=Math.atan2(b,f)+_,p=Math.atan2(E,Math.sqrt(f*f+b*b));f=d*Math.cos(v)*Math.cos(p),b=d*Math.sin(v)*Math.cos(p),E=d*Math.sin(p);var S=this.getLonSun(e,this.computeSun(e)),M=S.lonsun,O=S.rsun;M*=y.RADIANS_TO_DEGREES,M=A.normalizeAngle360(M)*y.DEGREES_TO_RADIANS;var R=f+O*Math.cos(M),w=b+O*Math.sin(M),D=E,j=A.normalizeAngle360(23.4393-3.563e-7*e)*y.DEGREES_TO_RADIANS,T=R,L=w*Math.cos(j)-D*Math.sin(j),C=w*Math.sin(j)+D*Math.cos(j);return{ra:A.normalizeAngle360(Math.atan2(L,T)*y.RADIANS_TO_DEGREES),dec:Math.atan2(C,Math.sqrt(T*T+L*L))*y.RADIANS_TO_DEGREES}},getLonSun:function(e,t){var a=t.w,n=t.e,r=t.M;a=A.normalizeAngle360(a)*y.DEGREES_TO_RADIANS;var i=(r=A.normalizeAngle360(r)*y.DEGREES_TO_RADIANS)+n*Math.sin(r)*(1+n*Math.cos(r)),o=Math.cos(i)-n,s=Math.sqrt(1-n*n)*Math.sin(i);return{lonsun:Math.atan2(s,o)+a,rsun:Math.sqrt(o*o+s*s)}}},D=b.a.ArgumentError,j=b.a.GpuProgram,T=b.a.Logger,L=b.a.Matrix,C=b.a.Color,N=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e,"attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}","precision mediump float;\nuniform sampler2D textureSampler;\nuniform int fragMode;\nuniform vec4 color;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (fragMode == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else if (fragMode == 0) {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n   else if (fragMode == 2) {\n       gl_FragColor = color;\n   }\n}",["vertexPoint"]))).FRAG_MODE_MIX_COLOR=0,a.FRAG_MODE_TEXTURE=1,a.FRAG_MODE_COLOR=2,a.vertexPointLocation=a.attributeLocation(e,"vertexPoint"),a.mvpMatrixLocation=a.uniformLocation(e,"mvpMatrix"),a.numDaysLocation=a.uniformLocation(e,"numDays"),a.magnitudeRangeLocation=a.uniformLocation(e,"magnitudeRange"),a.textureUnitLocation=a.uniformLocation(e,"textureSampler"),a.fragModeLocation=a.uniformLocation(e,"fragMode"),a.colorLocation=a.uniformLocation(e,"color"),a.localState={mvpMatrix:null,numDays:null,magnitudeRange:null,textureUnit:null,fragMode:null,color:null},a}return Object(S.a)(t,e),Object(_.a)(t,[{key:"loadModelviewProjection",value:function(e,t){if(!t)throw new D(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));var a=!1;null===this.localState.mvpMatrix&&(a=!0,this.localState.mvpMatrix=L.fromIdentity()),!a&&this.localState.mvpMatrix.equals(t)||(this.loadUniformMatrix(e,t,this.mvpMatrixLocation),this.localState.mvpMatrix.copy(t))}},{key:"loadNumDays",value:function(e,t){if(null==t)throw new D(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));this.localState.numDays!==t&&(e.uniform1f(this.numDaysLocation,t),this.localState.numDays=t)}},{key:"loadMagnitudeRange",value:function(e,t,a){if(null==t)throw new D(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==a)throw new D(T.logMessage(T.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));var n=!1;null===this.localState.magnitudeRange&&(n=!0,this.localState.magnitudeRange=[t,a]),(n||this.localState.magnitudeRange[0]!==t||this.localState.magnitudeRange[1]!==a)&&(e.uniform2f(this.magnitudeRangeLocation,t,a),this.localState.magnitudeRange[0]=t,this.localState.magnitudeRange[1]=a)}},{key:"loadTextureUnit",value:function(e,t){this.localState.textureUnit!==t&&(e.uniform1i(this.textureUnitLocation,t-e.TEXTURE0),this.localState.textureUnit=t)}},{key:"loadFragMode",value:function(e,t){this.localState.fragMode!==t&&(e.uniform1i(this.fragModeLocation,t),this.localState.fragMode=t)}},{key:"loadColor",value:function(e,t){var a=!1;null===this.localState.color&&(a=!0,this.localState.color=new C(0,0,0,0)),!a&&this.localState.color.equals(t)||(this.loadUniformColor(e,t,this.colorLocation),this.localState.color.copy(t))}}]),t}(j);N.key="WorldWindGpuStarFieldFullProgram";var P=N,I=b.a.Angle,x=b.a.ArgumentError,G=b.a.Logger,F={getAsGeographicLocation:function(e){if(e instanceof Date===!1)throw new x(G.logMessage(G.LEVEL_SEVERE,"MoonPosition","getAsGeographicLocation","missingDate"));var t=this.getAsCelestialLocation(e);return this.celestialToGeographic(t,e)},getAsCelestialLocation:function(e){if(e instanceof Date===!1)throw new x(G.logMessage(G.LEVEL_SEVERE,"MoonPosition","getAsCelestialLocation","missingDate"));var t=this.computeJulianDate(e)-2451545,a=this.normalizeAngle360(218.316+13.176396*t)*I.DEGREES_TO_RADIANS,n=this.normalizeAngle360(134.963+13.064993*t)*I.DEGREES_TO_RADIANS,r=this.normalizeAngle360(93.272+13.22935*t)*I.DEGREES_TO_RADIANS,i=a+6.289*Math.sin(n)*I.DEGREES_TO_RADIANS,o=5.128*Math.sin(r)*I.DEGREES_TO_RADIANS,s=(23.439-4e-7*t)*I.DEGREES_TO_RADIANS,c=Math.atan2(Math.sin(i)*Math.cos(s)-Math.tan(o)*Math.sin(s),Math.cos(i))*I.RADIANS_TO_DEGREES;return{declination:Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.sin(i))*I.RADIANS_TO_DEGREES,rightAscension:c=this.normalizeAngle360(c)}},celestialToGeographic:function(e,t){if(!e)throw new x(G.logMessage(G.LEVEL_SEVERE,"MoonPosition","celestialToGeographic","missingCelestialLocation"));if(t instanceof Date===!1)throw new x(G.logMessage(G.LEVEL_SEVERE,"MoonPosition","celestialToGeographic","missingDate"));var a=this.computeJulianDate(t)-2451545,n=this.normalizeAngle360(280.46061837+360.98564736629*a),r=this.normalizeAngle360(n-e.rightAscension),i=I.normalizedDegreesLongitude(-r);return{latitude:e.declination,longitude:i}},computeJulianDate:function(e){if(e instanceof Date===!1)throw new x(G.logMessage(G.LEVEL_SEVERE,"MoonPosition","computeJulianDate","missingDate"));var t=e.getUTCFullYear(),a=e.getUTCMonth()+1,n=e.getUTCDate(),r=(e.getUTCHours()+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24;a<=2&&(t-=1,a+=12);var i=Math.trunc(t/100),o=2-i+Math.trunc(i/4);return Math.trunc(365.25*(t+4716))+Math.trunc(30.6001*(a+1))+n+o-1524.5+r},normalizeAngle360:function(e){var t=e%360;return t>=0?t:t<0?360+t:360-t}},V=(b.a.Color,b.a.Layer),k=b.a.Logger,U=b.a.Matrix,z=b.a.REDRAW_EVENT_TYPE,B=function(e){function t(e){var a;Object(E.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,"StarField"))).pickEnabled=!1,a.sunSize=128,a.showSun=!0,a.showMoon=!0,a._starDataSource=e||b.a.configuration.baseUrl+"data/stars.json",a._sunImageSource=b.a.configuration.baseUrl+"images/sunTexture.png",a._moonImageSource=b.a.configuration.baseUrl+"images/moonTexture.png",a._matrix=U.fromIdentity(),a._starsPositionsVboCacheKey=null,a._numStars=0,a._starData=null,a._minMagnitude=Number.MAX_VALUE,a._maxMagnitude=Number.MIN_VALUE,a._loadStarted=!1,a._minScale=3e7,a._scale=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,a._sunPositionsCacheKey="",a._sunBufferView=new Float32Array(4),a._moonPositionsCacheKey="",a._moonBufferView=new Float32Array(4),a._MAX_GL_POINT_SIZE=0,a.showPlanets=!0;return a.planets=[{id:w.MERCURY,url:"images/Mercury64.png",size:8,ra:null,dec:null},{id:w.VENUS,url:"images/Venus64.png",size:8,ra:null,dec:null},{id:w.MARS,url:"images/Mars64.png",size:8,ra:null,dec:null},{id:w.JUPITER,url:"images/Jupiter64.png",size:32,ra:null,dec:null},{id:w.SATURN,url:"images/Saturn64.png",size:32,ra:null,dec:null},{id:w.URANUS,url:"images/Uranus64.png",size:16,ra:null,dec:null},{id:w.NEPTUNE,url:"images/Neptune64.png",size:16,ra:null,dec:null}],a._planetsBufferView=null,a._cacheKeys={sunPosition:"",planetPositions:"",starPositions:""},a}return Object(S.a)(t,e),Object(_.a)(t,[{key:"doRender",value:function(e){if(!e.globe.is2D())if(this.haveResources(e)){this.beginRendering(e);try{this.doDraw(e)}finally{this.endRendering(e)}}else this.loadResources(e)}},{key:"haveResources",value:function(e){var t=e.gpuResourceCache.resourceForKey(this._sunImageSource),a=e.gpuResourceCache.resourceForKey(this._moonImageSource),n=this.planets.every(function(t){return!!e.gpuResourceCache.resourceForKey(t.url)});return null!=this._starData&&null!=t&&null!=a&&n}},{key:"loadResources",value:function(e){var t=e.currentGlContext,a=e.gpuResourceCache;this._starData||this.fetchStarData(),a.resourceForKey(this._sunImageSource)||a.retrieveTexture(t,this._sunImageSource),a.resourceForKey(this._moonImageSource)||a.retrieveTexture(t,this._moonImageSource),this.planets.forEach(function(e){a.resourceForKey(e.url)||a.retrieveTexture(t,e.url)})}},{key:"beginRendering",value:function(e){var t=e.currentGlContext;e.findAndBindProgram(P),t.enableVertexAttribArray(0),t.depthMask(!1)}},{key:"doDraw",value:function(e){this.loadCommonUniforms(e),this.renderStars(e),this.showSun&&this.renderSun(e),this.showMoon&&this.renderMoon(e),this.showPlanets&&this.renderPlanets(e)}},{key:"loadCommonUniforms",value:function(e){var t=e.currentGlContext,a=e.currentProgram,n=e.modelviewProjection||e.navigatorState.modelviewProjection;this._matrix.copy(n),this._matrix.multiplyByScale(this._scale,this._scale,this._scale),a.loadModelviewProjection(t,this._matrix);var r=A.computeJulianDate(this.time||new Date);a.loadNumDays(t,r-2451545)}},{key:"renderStars",value:function(e){var t=e.currentGlContext,a=e.gpuResourceCache,n=e.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=a.generateCacheKey());var r=a.resourceForKey(this._starsPositionsVboCacheKey);if(r)t.bindBuffer(t.ARRAY_BUFFER,r);else{r=t.createBuffer();var i=this.createStarsGeometry();a.putResource(this._starsPositionsVboCacheKey,r,4*i.length),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW)}e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),n.loadMagnitudeRange(t,this._minMagnitude,this._maxMagnitude),n.loadFragMode(t,n.FRAG_MODE_MIX_COLOR),t.drawArrays(t.POINTS,0,this._numStars)}},{key:"renderPlanets",value:function(e){var t=this,a=e.currentGlContext,n=e.currentProgram,r=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&k.log(k.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE),this.planets.forEach(function(e){var a=w.getCelestialLocation(e.id,t.time||new Date),n=a.ra,r=a.dec;e.ra=n,e.dec=r},this),this._planetsBufferView||(this._planetsBufferView=new Float32Array(4*this.planets.length));for(var i=0;i<this.planets.length;i++){var o=this.planets[i];this._planetsBufferView[4*i+0]=o.dec,this._planetsBufferView[4*i+1]=o.ra,this._planetsBufferView[4*i+2]=Math.min(o.size,this._MAX_GL_POINT_SIZE),this._planetsBufferView[4*i+3]=1}this._planetsPositionsVboCacheKey||(this._planetsPositionsVboCacheKey=r.generateCacheKey());var s=r.resourceForKey(this._planetsPositionsVboCacheKey);s?(a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferSubData(a.ARRAY_BUFFER,0,this._planetsBufferView)):(s=a.createBuffer(),r.putResource(this._planetsPositionsVboCacheKey,s,4*this._planetsBufferView.length),a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,this._planetsBufferView,a.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),a.vertexAttribPointer(0,4,a.FLOAT,!1,0,0),n.loadFragMode(a,n.FRAG_MODE_TEXTURE);for(var c=0;c<this.planets.length;c++){var l=this.planets[c].url;e.gpuResourceCache.resourceForKey(l).bind(e),a.drawArrays(a.POINTS,c,1)}}},{key:"renderSun",value:function(e){var t=e.currentGlContext,a=e.currentProgram,n=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&k.log(k.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var r=A.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=r.declination,this._sunBufferView[1]=r.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=n.generateCacheKey());var i=n.resourceForKey(this._sunPositionsCacheKey);i?(t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferSubData(t.ARRAY_BUFFER,0,this._sunBufferView)):(i=t.createBuffer(),n.putResource(this._sunPositionsCacheKey,i,4*this._sunBufferView.length),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,this._sunBufferView,t.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),a.loadFragMode(t,a.FRAG_MODE_TEXTURE),e.gpuResourceCache.resourceForKey(this._sunImageSource).bind(e),t.drawArrays(t.POINTS,0,1)}},{key:"renderMoon",value:function(e){var t=e.currentGlContext,a=e.currentProgram,n=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&k.log(k.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var r=F.getAsCelestialLocation(this.time||new Date);this._moonBufferView[0]=r.declination,this._moonBufferView[1]=r.rightAscension,this._moonBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._moonBufferView[3]=1,this._moonPositionsCacheKey||(this._moonPositionsCacheKey=n.generateCacheKey());var i=n.resourceForKey(this._moonPositionsCacheKey);i?(t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferSubData(t.ARRAY_BUFFER,0,this._moonBufferView)):(i=t.createBuffer(),n.putResource(this._moonPositionsCacheKey,i,4*this._moonBufferView.length),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,this._moonBufferView,t.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),a.loadFragMode(t,a.FRAG_MODE_TEXTURE),e.gpuResourceCache.resourceForKey(this._moonImageSource).bind(e),t.drawArrays(t.POINTS,0,1)}},{key:"endRendering",value:function(e){var t=e.currentGlContext;t.depthMask(!0),t.disableVertexAttribArray(0)}},{key:"fetchStarData",value:function(){if(!this._loadStarted){this._loadStarted=!0;var e=this,t=new XMLHttpRequest;t.onload=function(){if(this.status>=200&&this.status<300)try{e._starData=JSON.parse(this.response),e.sendRedrawRequest()}catch(t){k.log(k.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+t.toString())}else k.log(k.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);e._loadStarted=!1},t.onerror=function(){k.log(k.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),e._loadStarted=!1},t.ontimeout=function(){k.log(k.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),e._loadStarted=!1},t.open("GET",this._starDataSource,!0),t.send()}}},{key:"createStarsGeometry",value:function(){var e=this.parseStarsMetadata(this._starData.metadata);if(-1===e.raIndex)throw new Error(k.logMessage(k.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(-1===e.decIndex)throw new Error(k.logMessage(k.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(-1===e.magIndex)throw new Error(k.logMessage(k.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var t=this._starData.data,a=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var n=0,r=t.length;n<r;n++){var i=t[n],o=i[e.decIndex],s=i[e.raIndex],c=i[e.magIndex],l=c<2?2:1;a.push(o,s,l,c),this._minMagnitude=Math.min(this._minMagnitude,c),this._maxMagnitude=Math.max(this._maxMagnitude,c)}return this._numStars=Math.floor(a.length/4),a}},{key:"parseStarsMetadata",value:function(e){for(var t=-1,a=-1,n=-1,r=0,i=e.length;r<i;r++){var o=e[r];"ra"===o.name&&(t=r),"dec"===o.name&&(a=r),"vmag"===o.name&&(n=r)}return{raIndex:t,decIndex:a,magIndex:n}}},{key:"invalidateStarData",value:function(){this._starData=null,this._starsPositionsVboCacheKey=null}},{key:"sendRedrawRequest",value:function(){var e=document.createEvent("Event");e.initEvent(z,!0,!0),window.dispatchEvent(e)}},{key:"starDataSource",get:function(){return this._starDataSource},set:function(e){this._starDataSource=e,this.invalidateStarData()}},{key:"sunImageSource",get:function(){return this._sunImageSource},set:function(e){this._sunImageSource=e}},{key:"moonImageSource",get:function(){return this._moonImageSource},set:function(e){this._moonImageSource=e}}]),t}(V),K=b.a.PickedObject,Y=b.a.SurfacePolygon,W=(b.a.SurfaceShape,b.a.SurfacePolygon,b.a.ColladaScene),J=b.a.Matrix,X=function(e){function t(e,a,n){var r;Object(E.a)(this,t),(r=Object(v.a)(this,Object(p.a)(t).call(this)))._satellite=a;var i=r.parse(e);return r.draw(n,i),r}return Object(S.a)(t,e),Object(_.a)(t,[{key:"position",value:function(e){this._model.position=e}},{key:"draw",value:function(e,t){var a=this._satellite,n=a.rotations,r=a.translations,i=a.preRotations,o=a.scale,s=a.shortName,c=a.ignoreLocalTransforms,l=new W(e,t);l.type=this.type,l.satShortName=s,l.nodesToHide=["PlatformCircleAndName","SolarWingsCircleAndName","C-SarCircleAndName","PlatformTextsAndArrows","SolarWingsTextsAndArrows","C-SarTextsAndArrows","SolarArrayGroup","WingsDetailsGroup","Group004","MsiGroup","SatteliteGroup","SatteliteDimensionsGroup","MWRGroup","SRALGroup","OLCIGroup","SLSTRGroup"],l.hideNodes=!0,l.useTexturePaths=!1,l.localTransforms=c,l.scale=o,l.xRotation=n.x,l.yRotation=n.y,l.zRotation=n.z,l.xTranslation=r.x,l.yTranslation=r.y,l.zTranslation=r.z,l.preX=i.x,l.preY=i.y,l.preZ=i.z,this._model=l,t=null}},{key:"parse",value:function(e){var t=e.meshes,a=e.root.children,n=e.materials;for(var r in t)if(t.hasOwnProperty(r))for(var i=t[r].buffers,o=0;o<i.length;o++){var s=i[o].vertices||[],c=i[o].normals||[],l=i[o].uvs||[],u=i[o].indices||[],h=new Float32Array(s),g=new Float32Array(c),m=new Float32Array(l),d=new Uint16Array(u);i[o].vertices=h,i[o].normals=g,i[o].uvs=m,i[o].indices=d}for(var f=0;f<a.length;f++){var b=a[f];if(b.mesh){var E=b.worldMatrix.slice(0);b.worldMatrix=J.fromIdentity(),b.worldMatrix.copy(E),b.children.length&&console.info("node has children",b)}}for(var _ in n)if(n.hasOwnProperty(_)){var v=n[_];"_3_-_Default-material"===v.id?v.reflective&&(v.reflective[0]=.289219,v.reflective[1]=.713497,v.reflective[2]=.870753,v.reflective[3]=1):"_1_-_Default_004-material"===v.id?v.diffuse[3]=0:"_1_-_Default-material"===v.id?v.diffuse[3]=0:"Chrome-material"===v.id?(v.textures=null,v.diffuse[0]=.3137,v.diffuse[1]=.3137,v.diffuse[2]=.3137):"Satellite_panel-material"===v.id?v.textures.reflective.mapId="image9":"_3_-_Default"===v.id?v.textures.reflective.mapId="image4":"_4_-_Default-material"===v.id?v.textures.reflective.mapId="image5":"_5_-_Default_002-material"===v.id?v.textures.reflective.mapId="image6":"_5_-_Default-material"===v.id&&(v.textures.reflective.mapId="image5")}return e}},{key:"render",value:function(e){this._model&&this.enabled&&this._model.render(e)}}]),t}(b.a.Renderable),H=b.a.Position,q=new(0,b.a.RenderableLayer)("Model");fetch("./data/sentinel1/s1.json").then(function(e){return e.json()}).then(function(e){q.addRenderable(new X(e,{rotations:{x:0,y:0,z:0,headingAxis:[0,0,1],headingAdd:-90,headingMultiply:1},preRotations:{x:0,y:0,z:0},scale:5e5,translations:{x:-.1,y:-.1,z:0},ignoreLocalTransforms:!0},new H(51,14,1e5)))});var Z=q,Q=function(e){var t=e.id,a=e.clon,r=e.clat,i=e.alt,o=e.starfield,c=e.atmosphere,l=e.names;console.log("useEww renders");var u=Object(n.useRef)(null),f=(Object(n.useRef)(null),Object(n.useRef)(null),Object(n.useState)("3D")),E=Object(s.a)(f,2),_=(E[0],E[1]),v=Object(n.useState)(""),p=Object(s.a)(v,2),S=(p[0],p[1],Object(n.useState)(c)),M=Object(s.a)(S,2),O=M[0],R=M[1],A=Object(n.useState)([]),y=Object(s.a)(A,2),w=y[0],D=y[1],j=Object(n.useState)([]),T=Object(s.a)(j,2),L=(T[0],T[1],Object(n.useState)()),C=Object(s.a)(L,2),N=(C[0],C[1]),P=Object(n.useState)(),I=Object(s.a)(P,2),x=(I[0],I[1],Object(n.useRef)()),G=Object(n.useRef)(),F=Object(n.useRef)(),V=Object(n.useState)(),k=Object(s.a)(V,2),U=k[0],z=k[1];function K(e){console.log(e.computeSectors(u.current.drawContext)),console.log(b.a.Sector.FULL_SPHERE);var t={service:"https://view.onda-dias.eu/instance00/ows",layerNames:"S1_IW_GRDH_FullResolution",title:"quicklook",numLevels:19,format:"image/png",size:256,sector:e.computeSectors(u.current.drawContext)[0],levelZeroDelta:new b.a.Location(90,90)},a=new b.a.WmsLayer(t,e.userProperties.date);u.current.addLayer(a),u.current.redraw(),console.log(u.current.layers)}function Y(e){for(var t=0;t<u.current.layers.length;t++)if(u.current.layers[t].displayName===e)return u.current.layers[t];return null}function W(e){return J.apply(this,arguments)}function J(){return(J=Object(m.a)(h.a.mark(function e(t){var a,n,r,i,o;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(108e5,a=0;a<u.current.layers.length;a++){if(u.current.layers[a].displayName.includes("Products:"))for(n=0;n<u.current.layers[a].renderables.length;n++)r=u.current.layers[a].renderables[n],0!=t?(i=new Date(r.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime).getTime(),o=new Date(r.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStopTime).getTime(),r.enabled=i<=t+54e5&&o>=t-54e5):r.enabled=!1;u.current.layers[a].displayName}case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var X=function(){u.current.navigator.lookAtLocation.longitude,u.current.navigator.lookAtLocation.latitude;var e=u.current.navigator.range;z(e<=1e3?"firstperson":"arcball")},H=function(e){var t=e.clientX,a=e.clientY,n=u.current.pick(u.current.canvasCoordinates(t,a));if(console.log(n),n.terrainObject()){u.current.removeLayer(Y("quicklook"));for(var r=0;r<u.current.layers.length;r++)if(u.current.layers[r].displayName.includes("Products:"))for(var i=0;i<u.current.layers[r].renderables.length;i++){u.current.layers[r].renderables[i].highlighted=!1}for(var o=[],s=0;s<n.objects.length;s++)n.objects[s].userObject instanceof b.a.SurfaceShape&&(o.push(n.objects[s].userObject),n.objects[s].userObject.highlighted=!n.objects[s].userObject.highlighted,K(n.objects[s].userObject));console.log(o),N(function(e){return Object(g.a)({},e,{pickedItems:o})}),u.current.redraw()}else console.log("No position !")},q=function(e){console.log("double click");var t,a=e.clientX,n=e.clientY,r=u.current.pick(u.current.canvasCoordinates(a,n));if(r.terrainObject()){var i="POINT("+(t=r.terrainObject().position).longitude+" "+t.latitude+")";N(function(e){return Object(g.a)({},e,{aoi:i})})}else console.log("No position !"),N(function(e){return Object(g.a)({},e,{aoi:""})})};return Object(n.useLayoutEffect)(function(){console.log("Creating the world...");var e=new b.a.ElevationModel;u.current=new b.a.WorldWindow(t,e),x.current=new b.a.FirstPersonCamera(u.current),G.current=new b.a.ArcBallCamera(u.current),u.current.redrawCallbacks.push(X);var n=new b.a.ClickRecognizer(u.current,H);n.numberOfClicks=1;var s=new b.a.ClickRecognizer(u.current,q);s.numberOfClicks=2,s.recognizeSimultaneouslyWith(n),s.maxClickInterval=200;var c=new b.a.TapRecognizer(u.current,H);c.numberOfTaps=1;var h=new b.a.TapRecognizer(u.current,q);h.numberOfTaps=2,h.recognizeSimultaneouslyWith(c),h.maxTapInterval=200;var g={service:"https://tiles.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:b.a.Sector.FULL_SPHERE,levelZeroDelta:new b.a.Location(90,90)},m={service:"https://tiles.maps.eox.at/wms",layerNames:"terrain",title:"terrain",numLevels:19,format:"image/png",size:256,sector:b.a.Sector.FULL_SPHERE,levelZeroDelta:new b.a.Location(90,90)},d={service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",title:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:b.a.Sector.FULL_SPHERE,levelZeroDelta:new b.a.Location(90,90)};b.a.configuration.baseUrl=b.a.configuration.baseUrl.slice(0,-3);for(var f=new B,E=new b.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg"),_=new b.a.RenderableLayer("Quicklooks"),v=[{layer:new b.a.WmsLayer(g,""),enabled:!0},{layer:new b.a.WmsLayer(m,""),enabled:!1},{layer:new b.a.WmsLayer(d,""),enabled:l},{layer:f,enabled:o},{layer:E,enabled:O},{layer:_,enabled:!0},{layer:Z,enabled:!1}],p=0;p<v.length;p++)v[p].layer.enabled=v[p].enabled,u.current.addLayer(v[p].layer);f.time=new Date,E.time=new Date,setTimeout(function(){u.current.goToAnimator.travelTime=1e3,u.current.goTo(new b.a.Position(r,a,i)),u.current.redraw()},2e3),u.current.redraw(),u.current.deepPicking=!0},[]),Object(n.useEffect)(function(){console.log("running effect cameramode"),U&&function(e){var t=function(e,t){t.position.latitude=e.position.latitude,t.position.longitude=e.position.longitude,t.heading=e.heading,t.tilt=e.tilt,t.roll=e.roll,t.range=e.range};"firstperson"===e&&u.current.navigator.camera instanceof b.a.ArcBallCamera?(F.current=u.current.navigator.camera.tilt,t(u.current.navigator.camera,x.current),u.current.navigator.camera=x.current,u.current.navigator.camera.tilt=0):"arcball"===e&&u.current.navigator.camera instanceof b.a.FirstPersonCamera&&(t(u.current.navigator.camera,G.current),G.current.tilt=F.current,u.current.navigator.camera=G.current)}(U)},[U]),{removeGeojson:function(){for(var e=0;e<w.length;e++)u.current.removeLayer(w[e]);D(function(e){return[]}),u.current.redraw()},addGeojson:function(e,t){var a=new b.a.RenderableLayer("Products: "+e.properties.updated+Math.ceil(1e4*Math.random()));u.current.addLayer(a),new b.a.GeoJSONParser(e).load(function(){console.log(a),D(function(e){return[].concat(Object(d.a)(e),[a])}),W(t),u.current.redraw()},function(e,t){var a={};a.userProperties=t;var n=new b.a.PlacemarkAttributes(null);return n.imageScale=10,n.imageColor=new b.a.Color(0,1,1,.2),n.labelAttributes.offset=new b.a.Offset(b.a.OFFSET_FRACTION,5,b.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?a.attributes=new b.a.PlacemarkAttributes(n):e.isLineStringType()||e.isMultiLineStringType()?(a.attributes.drawOutline=!0,a.attributes.outlineColor=new b.a.Color(.1*a.attributes.interiorColor.red,.3*a.attributes.interiorColor.green,.7*a.attributes.interiorColor.blue,1),a.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(a.attributes=new b.a.ShapeAttributes(null),a.attributes.interiorColor=new b.a.Color(1,0,0,.2),a.attributes.outlineColor=new b.a.Color(1,0,0,.3),a.highlightAttributes=new b.a.ShapeAttributes(a.attributes),a.highlightAttributes.outlineColor=new b.a.Color(1,0,0,.4),a.highlightAttributes.interiorColor=new b.a.Color(1,0,0,0)),a},a)},addWMS:function(){},setStarfield:function(e){console.log("toggleStarfield"),Y("StarField").enabled=e,u.current.redraw()},setAtmosphere:function(e){console.log("toggleAtmosphere"),Y("Atmosphere").enabled=e,R(e),u.current.redraw()},setTime:function(e){Y("StarField").time=Y("Atmosphere").time=new Date(e),W(e),u.current.redraw()},toggleProjection:function(){_(function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator"],a=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[a]),t[a]){case"3D":u.current.globe.projection=new b.a.ProjectionWgs84;break;case"Equirectangular":u.current.globe.projection=new b.a.ProjectionEquirectangular;break;case"Mercator":u.current.globe.projection=new b.a.ProjectionMercator;break;case"North Polar":u.current.globe.projection=new b.a.ProjectionPolarEquidistant("North");break;case"South Polar":u.current.globe.projection=new b.a.ProjectionPolarEquidistant("South");break;default:u.current.globe.projection=new b.a.ProjectionWgs84}return u.current.redraw(),t[a]})},setNames:function(e){console.log("toggleNames"),Y("overlay_bright").enabled=e,u.current.redraw()},toggleModel:function(){console.log("toggleModel"),Y("Model").enabled=!Y("Model").enabled,u.current.redraw()},toggleBg:function(){console.log("toggleTerrain"),Y("terrain").enabled=!Y("terrain").enabled,Y("s2cloudless-2018").enabled=!Y("s2cloudless-2018").enabled,u.current.redraw()},northUp:function(){var e=u.current,t=1;Math.abs(e.navigator.heading)>60?t=2:Math.abs(navigator.heading)>120&&(t=3),e.navigator.heading>0&&(t=-t),setTimeout(function a(){Math.abs(e.navigator.heading)>Math.abs(t)?(e.navigator.heading+=t,setTimeout(a,10)):e.navigator.heading=0,e.redraw()},10)}}},$=a(4),ee=function(e){var t=e.viewdate,a=e.id,i=e.clat,o=e.clon,s=e.alt,c=e.starfield,l=e.atmosphere,u=e.names;console.log("render Earth");var h=Q({id:a,clat:i,clon:o,alt:s,starfield:c,atmosphere:l,names:u}),g=(h.ewwstate,h.addGeojson,h.removeGeojson),m=(h.addWMS,h.toggleProjection),d=h.setAtmosphere,f=h.setStarfield,b=h.setNames,E=h.toggleBg,_=h.toggleModel,v=h.setTime,p=h.northUp;Object($.a)("p",m),Object($.a)("c",g),Object($.a)("u",p),Object($.a)("b",E),Object($.a)("m",_),Object(n.useEffect)(function(){v(t.getTime())},[t,v]),Object(n.useEffect)(function(){f(c)},[c]),Object(n.useEffect)(function(){b(u)},[u]),Object(n.useEffect)(function(){d(l)},[l]);return r.a.createElement("canvas",{id:a,style:{background:"inherit",position:"fixed",left:0,width:"100%",height:"100%"}})},te=a(16),ae=a(23);a(65);var ne=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),i=a[0],o=a[1],c=Object(te.b)(function(){return{mr:-300}}),l=Object(s.a)(c,2),u=l[0].mr,h=l[1],g=Object(ae.a)({onDrag:function(e){var t=e.down,a=e.delta,n=e.vxvy;console.log(a[0]),n[0]>1||!t&&a[0]>100?(h({mr:-300}),o(!0)):(h({mr:t?-Math.max(a[0],0):0}),o(!1))}});return r.a.createElement(te.a.div,Object.assign({},g(),{style:{right:u,top:0},className:"ControlPanel"}),r.a.createElement("div",null,r.a.createElement("img",{id:"logo",className:"Logo",src:"./images/EOi_logo.png",alt:"",onClick:function(){return h(i?{mr:0}:{mr:-300})}})),e.children)},re=a(19),ie=a.n(re);a(66);var oe=function(e){var t=e.date,a=e.highlight,n=e.animated;return r.a.createElement("div",{className:"LabelContainer"},r.a.createElement("div",{className:"Date"},r.a.createElement("div",{className:"day"!==a||"none"===a?"DayLabel":"DayLabel Highlighted",key:"day"},ie()(t,"UTC:dd")),r.a.createElement("div",{className:"YearMonth"},r.a.createElement("div",{className:"month"!==a||"none"===a?"MonthLabel ":"MonthLabel  Highlighted",key:"month"},ie()(t,"UTC:mmm").toUpperCase()),r.a.createElement("div",{className:"year"!==a||"none"===a?"YearLabel ":"YearLabel Highlighted",key:"year"},t.getUTCFullYear()))),r.a.createElement("div",{className:n?"Line  Line-active":"Line",key:"line"}),r.a.createElement("div",{className:"TimeLabel"},r.a.createElement("div",{className:"hour"!==a||"none"===a?"HourLabel ":"HourLabel Highlighted",key:"hour"},ie()(t,"UTC:HH")," "),r.a.createElement("div",{className:"hourseparator"},":"),r.a.createElement("div",{className:"minseparator"},":"),r.a.createElement("div",{className:"minute"!==a||"none"===a?"MinuteLabel ":"MinuteLabel Highlighted",key:"minute"},ie()(t,"UTC:MM")),r.a.createElement("div",{className:"second"!==a||"none"===a?"SecondLabel ":"SecondLabel Highlighted",key:"second"},ie()(t,"UTC:ss"))))},se=a(38);a(36);var ce=function(e){var t=e.date,a=e.zoomfactor,i=Object(n.useRef)();return r.a.createElement("div",{ref:i,className:"DateSelectorScale"},function(e,t){if(i.current){for(var a,n,o,s,c=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],l=0,u=0,h=0,g=0,m=0,d=0,f=[],b=0;b<i.current.offsetHeight;b+=1){var E=new Date((b-i.current.offsetHeight/2)*t+e.getTime());switch(a=E.getUTCDate(),n=E.getUTCMonth(),o=E.getUTCHours(),s=E.getUTCFullYear(),l=E.getUTCMinutes(),!0){case t<2e3:l!==d&&(0!==l||0!==o?f.push({class:"HourTic",pos:b,label:_(o,2)+":"+_(l,2)}):0===l&&0===o&&(f.push({class:"DayTic_h",pos:b,label:a}),f.push({class:"MonthTic_h2",pos:b,label:c[n]})));break;case t<4e4:l!==d&&(0===l&&0==o||l%10!==0?0===l&&0===o&&(f.push({class:"DayTic_h",pos:b,label:a}),f.push({class:"MonthTic_h2",pos:b,label:c[n]})):f.push({class:"HourTic",pos:b,label:_(o,2)+":"+_(l,2)}));break;case t<18e4:o!==m&&(0!==o?f.push({class:"HourTic",pos:b,label:_(o,2)+":00"}):(f.push({class:"DayTic_h",pos:b,label:a}),f.push({class:"MonthTic_h2",pos:b,label:c[n]})));break;case t<42e4:o!==m&&(0!==o&&o%3===0?f.push({class:"HourTic",pos:b,label:_(o,2)+":00"}):0===o&&(f.push({class:"DayTic_h",pos:b,label:a}),f.push({class:"MonthTic_h2",pos:b,label:c[n]})));break;case t<42e5:a!==u&&(1!==a?f.push({class:"DayTic",pos:b,label:a}):(f.push({class:"MonthTic_h",pos:b,label:c[n]}),0===n&&f.push({class:"YearTic_h2",pos:b,label:s})));break;case t<288e5:a!==u&&(1!==a&&30!==a&&a%5===0?f.push({class:"DayTic",pos:b,label:a}):1==a&&(f.push({class:"MonthTic_h",pos:b,label:c[n]}),0===n&&f.push({class:"YearTic_h2",pos:b,label:s})));break;case t<2592e5:n!==h&&(0!==n?f.push({class:"MonthTic",pos:b,label:c[n]}):(f.push({class:"MonthTic_h",pos:b,label:c[n]}),f.push({class:"YearTic_h2",pos:b,label:s})));break;case t<2592e7:s!==g&&(0!==n?f.push({class:"MonthTic",pos:b,label:c[n]}):f.push({class:"YearTic",pos:b,label:s}))}u=a,g=s,h=n,m=o,d=l}return f.map(function(e){return r.a.createElement("div",{className:e.class,key:e.class+e.pos,style:{top:e.pos}},e.label)})}function _(e,t){for(var a=""+e;a.length<t;)a="0"+a;return a}}(t,a))};var le=function(e){var t=e.startdate,a=(e.increment,e.incrementSpeed,e.onDateChange),i=e.onFinalDateChange,o=e.onStepChange,c=Object(n.useRef)(),l=Object(n.useRef)();l.current||(l.current=36e5);var u=Object(n.useState)(t),h=Object(s.a)(u,2),g=h[0],m=h[1],d=Object(n.useState)(t),f=Object(s.a)(d,2),b=f[0],E=f[1],_=Object(n.useState)(!1),v=Object(s.a)(_,2),p=v[0],S=v[1],M=Object(n.useState)(6e4),O=Object(s.a)(M,2),R=O[0],A=O[1],y=Object(n.useState)("hour"),w=Object(s.a)(y,2),D=w[0],j=w[1],T=Object(n.useState)(36e5),L=Object(s.a)(T,2),C=L[0],N=L[1];l.current||(l.current=36e5);var P=Object(n.useRef)(),I=Object(n.useRef)(),x=Object(te.b)(function(){return{posxy_drag:[0,0]}}),G=Object(s.a)(x,2),F=G[0].posxy_drag,V=G[1],k=Object(te.b)(function(){return{xy2:[0,0]}}),U=Object(s.a)(k,3),z=U[0].xy2,B=U[1],K=U[2],Y=Object(te.b)(function(){return{posxy_wheel:[0,0]}}),W=Object(s.a)(Y,3),J=W[0].posxy_wheel,X=W[1],H=W[2],q=Object(ae.a)({onDragEnd:function(){l.current=C},onWheel:function(e){e.delta;var t,n=e.movement,r=e.shiftKey,o=e.first,s=e.direction,c=e.down,l=e.last,u=(e.wheeling,e.memo),h=void 0===u?{lastposxy:J.getValue()}:u;return o&&(H(),S(!0),E(g)),r?((t=C-C/5*s[0])<1e3&&(t=1e3),t>1296e6&&(t=1296e6),N(t),c||S(!1),h):(X({posxy_wheel:n,immediate:!0,onFrame:function(){var e=Math.ceil(J.getValue()[1]*C/R);0==e&&n[1]<=0&&(e=-1),0==e&&n[1]>=0&&(e=1);var t=b.getTime()+e*R,r=new Date(t);m(r),a(r)},onRest:function(){var e=Math.ceil(J.getValue()[1]*C/R);0==e&&n[1]<=0&&(e=-1),0==e&&n[1]>=0&&(e=1);var t=b.getTime()+e*R,r=new Date(t);m(r),a(r),i(r),E(r),l&&(J.setValue([0,0]),S(!1))}}),h)},onDrag:function(e){e.event;var t,n=e.first,r=e.direction,o=e.down,s=e.movement,c=e.delta,l=e.velocity,u=e.shiftKey;if(n&&(console.log("shiftKey: "+u),S(!0),function(){var e=Date.now();P.current&&e-P.current<300?I.current=!0:(P.current=e,I.current=!1)}(),E(g)),I.current||u)return(t=C-C/50*c[1])<1e3&&(t=1e3),t>1296e6&&(t=1296e6),N(t),void(o||S(!1));l=Math.abs(l)<.2?0:l,V({posxy_drag:s,immediate:o,config:{velocity:Object(se.scale)(r,l),decay:!0},onFrame:function(){if(!n){var e=b.getTime()-Math.ceil(F.getValue()[1]*C/R)*R,t=new Date(e);m(t),a(t)}},onRest:function(){if(!o){var e=b.getTime()-Math.ceil(F.getValue()[1]*C/R)*R,t=new Date(e);m(t),a(t),i(t),E(t),S(!1)}}})}},{});return Object(n.useEffect)(function(){p||(console.log("DateSelector moving date to: "+t.toJSON()),function(e){if(!p){var t=[0,(b.getTime()-e.getTime())/C];K(),B({xy2:t,immediate:!1,config:{reset:!0},onFrame:function(){var e=new Date(b.getTime()-z.getValue()[1]*C);m(e),a(e)},onRest:function(){var e=new Date(b.getTime()-z.getValue()[1]*C);z.setValue([0,0]),m(e),a(e),E(e),i(e)}})}}(t))},[t]),Object(n.useEffect)(function(){console.log("Selector active: "+p)},[p]),Object(n.useEffect)(function(){o(D)},[D]),Object(n.useEffect)(function(){switch(!0){case C>120426316:A(2592e6),j("month");break;case C>14544702:A(864e5),j("day");break;case C>735259:A(36e5),j("hour");break;case C>32274:A(6e4),j("minute");break;default:A(1e3),j("second")}},[C]),r.a.createElement("div",Object.assign({},q(),{className:"DateSelector",ref:c}),r.a.createElement("div",{className:"Mask"},r.a.createElement(ce,{className:"scale",date:g,zoomfactor:C,step:R}),r.a.createElement("div",{className:"TriangleContainer"},r.a.createElement("svg",{height:"40",width:"20",className:"Triangle"},r.a.createElement("polygon",{points:"20,5 20,35 12,20"})))))};var ue=function(e){var t=e.startdate,a=e.onDateChange,i=e.onFinalDateChange,o=e.animated,c=Object(n.useState)(1),l=Object(s.a)(c,2),u=l[0],h=l[1],g=Object(n.useState)(t),m=Object(s.a)(g,2),d=m[0],f=m[1];return r.a.createElement("div",null,r.a.createElement(oe,{date:d,animated:o,highlight:u}),r.a.createElement(le,{startdate:t,onDateChange:function(e){f(e),a(e)},onFinalDateChange:function(e){i(e)},onStepChange:h}))};var he=function(){var e=Object(c.useGlobal)("viewDate"),t=Object(s.a)(e,2),a=(t[0],t[1]),n=Object(c.useGlobal)("searchDate"),r=Object(s.a)(n,2),i=(r[0],r[1]),o=Object(c.useGlobal)("searching"),u=Object(s.a)(o,2),h=u[0],g=(u[1],Object(c.useGlobal)("increment")),m=Object(s.a)(g,1)[0],d=Object(c.useGlobal)("incrementSpeed"),f=Object(s.a)(d,1)[0],b=Object(c.useGlobal)("dateManagerDate"),E=Object(s.a)(b,2),_=E[0];return E[1],l.a.createElement(ue,{startdate:_,increment:m,incrementSpeed:f,onDateChange:a,onFinalDateChange:i,animated:h})};function ge(e){e.autoStart;var t=e.initdate,a=Object(n.useState)(t),r=Object(s.a)(a,2),i=r[0],o=r[1],c=Object(n.useRef)(),l=Object(n.useRef)();l.current=1e3;var u=Object(n.useRef)();u.current||(u.current=l.current);var h=Object(n.useRef)();h.current||(h.current=t.getTime());var g=Object(n.useRef)();function m(){h.current+=u.current,o(new Date(h.current))}function d(){console.log("stop clock"),g.current&&clearInterval(g.current),c.current=!1}return Object(n.useEffect)(function(){console.log("dateIncrementor date changed "+t.toJSON()),c.current||(console.log("changing"),h.current=t.getTime())},[t]),{date:i,playing:c,togglePause:function(e){c.current?d():(console.log("start clock"),c.current=!0,g.current=setInterval(m,l.current))},reset:function(){d(),h.current=(new Date).getTime(),o(new Date(h.current))},increaseSpeed:function(){u.current=u.current>0?u.current*=2:u.current/=2,Math.abs(u.current)<l.current&&(u.current=l.current),console.log("step: "+u.current)},decreaseSpeed:function(){u.current=u.current>0?u.current/=2:u.current*=2,Math.abs(u.current)<l.current&&(u.current=-1*l.current),console.log("step: "+u.current)},forceDate:function(e){console.log("forcedate useclock: "+e.toJSON()),h.current=e.getTime(),o(new Date(h.current))}}}a(67);var me=function(e){var t=e.initdate,a=e.onDateChange,i=Object(n.useState)(t),o=Object(s.a)(i,2),c=o[0],l=(o[1],ge({initdate:c})),u=l.date,h=l.playing,g=l.togglePause,m=l.reset,d=l.increaseSpeed,f=l.decreaseSpeed;l.forceDate,Object($.a)("t",g),Object($.a)("r",m),Object($.a)(".",d),Object($.a)(",",f),Object(n.useEffect)(function(){u&&(console.log("date from useDateIncrementor: "+u.toJSON()),a(u))},[u,h]);var b=Object(n.useRef)();return r.a.createElement("div",{className:"DateController",onClick:function(){var e=Date.now();b.current&&e-b.current<300?m():b.current=e}})};var de=function(){var e=Object(c.useGlobal)("viewDate"),t=Object(s.a)(e,2),a=(t[0],t[1],Object(c.useGlobal)("dateManagerDate")),n=Object(s.a)(a,2),r=(n[0],n[1]),i=Object(c.useGlobal)("searchDate"),o=Object(s.a)(i,2),u=o[0],h=(o[1],Object(c.useGlobal)("searching")),g=Object(s.a)(h,2),m=(g[0],g[1],Object(c.useState)(u)),d=Object(s.a)(m,2),f=d[0],b=d[1];return Object(c.useEffect)(function(){console.log("initdate changed: "+u.toJSON()),b(u)},[u]),l.a.createElement(me,{initdate:f,onDateChange:function(e){r(e)}})};a(68);var fe=function(e){var t=e.initialmission,a=e.onMissionChange,i=Object(n.useState)(t),o=Object(s.a)(i,2),c=o[0],l=o[1];return Object($.a)("1",function(){l("S1")}),Object($.a)("2",function(){l("S2")}),Object($.a)("3",function(){l("S3")}),Object($.a)("5",function(){l("S5P")}),Object($.a)("6",function(){l("ENVISAT")}),Object(n.useEffect)(function(){console.log("Mission changed to: "+c),a(c)},[c,a]),r.a.createElement("div",{className:"MissionSelector"},r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return l("S1")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return l("S2")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return l("S3")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return l("S5P")}})))};var be=function(){var e=Object(c.useGlobal)("mission"),t=Object(s.a)(e,2),a=t[0],n=t[1];return l.a.createElement(fe,{initialmission:a,onMissionChange:n})};a(69);var Ee=function(e){var t=e.onMapSettingsChange,a=Object(n.useState)({starfield:!0,names:!0,atmosphere:!0}),i=Object(s.a)(a,2),o=i[0],c=i[1],l=function(){return c(function(e){return Object(g.a)({},e,{atmosphere:!e.atmosphere})})},u=function(){return c(function(e){return Object(g.a)({},e,{starfield:!e.starfield})})},h=function(){return c(function(e){return Object(g.a)({},e,{names:!e.names})})};return Object($.a)("a",l),Object($.a)("s",u),Object($.a)("n",h),Object(n.useEffect)(function(){t(o)},[o,t]),r.a.createElement("div",{className:"MapSelector"},r.a.createElement("div",{className:"CircleButton"},r.a.createElement("img",{className:"MapIcon",draggable:"false",src:"./images/atmosphere.png",alt:"",onClick:l})),r.a.createElement("div",{className:"CircleButton"},r.a.createElement("img",{className:"MapIcon",draggable:"false",src:"./images/starfield.png",alt:"",onClick:u})),r.a.createElement("div",{className:"CircleButton"},r.a.createElement("img",{className:"MapIcon",draggable:"false",src:"./images/names.png",alt:"",onClick:h})))};var _e=function(){var e=Object(c.useGlobal)("mapSettings"),t=Object(s.a)(e,2)[1];return l.a.createElement(Ee,{onMapSettingsChange:t})},ve=a(39),pe=a.n(ve),Se=a(40);var Me=function(){var e=Object(c.useGlobal)("mission"),t=Object(s.a)(e,1)[0],a=Object(c.useGlobal)("mapSettings"),i=Object(s.a)(a,1)[0],o=Object(c.useGlobal)("viewDate"),l=Object(s.a)(o,1)[0],u=Object(c.useGlobal)("searchDate"),h=Object(s.a)(u,1)[0];Object(n.useEffect)(function(){console.log("Search Date: "+h.toJSON())},[h]);var g=Object(n.useState)(!1),m=Object(s.a)(g,2),d=m[0],f=m[1],b=Object(Se.a)(window.document.body),E=b.isFullscreen,_=b.toggleFullscreen;return Object($.a)("f",_),r.a.createElement("div",{className:"App"},r.a.createElement(pe.a,{enabled:d,onChange:function(){E||f(!1)}},r.a.createElement("div",{className:"Earth"},r.a.createElement(ee,{viewdate:l,id:"globe",starfield:i.starfield,atmosphere:i.atmosphere,names:i.names,clon:"0.5",clat:"40"})),r.a.createElement(he,null),r.a.createElement(de,null),r.a.createElement(ne,{active:"true"},r.a.createElement(be,null),r.a.createElement(_e,null)),r.a.createElement("div",{className:"MissionLabel"},t)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.log("init global: "+(new Date).getTime()),Object(c.setGlobal)({mission:"S1",mapSettings:{atmosphere:!0,starfield:!0,names:!0},viewDate:new Date,searchDate:new Date,controllerDate:new Date,dateManagerDate:new Date,incrementSpeed:1,increment:!1}),o.a.render(r.a.createElement(Me,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.8e7f070d.chunk.js.map