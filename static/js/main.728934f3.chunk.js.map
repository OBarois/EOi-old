{"version":3,"sources":["components/earth/wwwx/layer/starfield/SunPosition.js","components/earth/wwwx/layer/starfield/Celestial.js","components/earth/wwwx/layer/starfield/StarFieldProgram.js","components/earth/wwwx/layer/starfield/MoonPosition.js","components/earth/wwwx/layer/starfield/StarFieldLayer.js","components/earth/wwwx/shapes/TexturedSurfaceShape.js","components/earth/wwwx/shapes/satellites/Model.js","components/earth/wwwx/shapes/TexturedSurfacePolygon.js","components/earth/satelliteLayer.js","components/earth/useEww.js","components/earth/Earth.js","components/controlpanel/ControlPanel.js","components/datemanager/components/datelabel/DateLabel.js","components/datemanager/components/dateselector/DateSelectorScale.js","components/datemanager/components/dateselector/DateSelector.js","components/datemanager/DateManager.js","containers/DateManagerContainer.js","components/datecontroller/useDateIncrementor.js","components/datecontroller/DateController.js","containers/DateControllerContainer.js","components/missionselector/MissionSelector.js","containers/MissionSelectorContainer.js","components/mapselector/MapSelector.js","containers/MapSelectorContainer.js","components/app/App.js","serviceWorker.js","initGlobalStates.js","index.js"],"names":["Angle","WorldWind","ArgumentError","Logger","SunPosition","getAsGeographicLocation","date","Date","logMessage","LEVEL_SEVERE","celestialLocation","this","getAsCelestialLocation","celestialToGeographic","numDays","computeJulianDate","meanLongitude","normalizeAngle360","meanAnomaly","DEGREES_TO_RADIANS","eclipticLongitude","Math","sin","eclipticLongitudeRad","obliquityOfTheEcliptic","declination","asin","RADIANS_TO_DEGREES","rightAscension","atan","cos","tan","GMST","GHA","longitude","normalizedDegreesLongitude","latitude","year","getUTCFullYear","month","getUTCMonth","day","getUTCDate","dayFraction","getUTCHours","getUTCMinutes","getUTCSeconds","A","trunc","B","degrees","angle","Celestial","SUN","MERCURY","VENUS","MARS","JUPITER","SATURN","URANUS","NEPTUNE","getCelestialLocation","id","orbitalElements","d","computeSun","computeMercury","computeVenus","computeMars","computeJupiter","computeSaturn","computeUranus","computeNeptune","computePosition","N","i","w","a","e","M","_ref","E","aa","E1","abs","xv","yv","sqrt","v","atan2","r","xh","yh","zh","lon_corr","lonecl","latecl","_this$getLonSun","getLonSun","lonsun","rsun","xg","yg","zg","ecl","xe","ye","ze","ra","dec","_ref2","GpuProgram","Matrix","Color","StarFieldProgram","gl","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","FRAG_MODE_MIX_COLOR","FRAG_MODE_TEXTURE","FRAG_MODE_COLOR","vertexPointLocation","attributeLocation","mvpMatrixLocation","uniformLocation","numDaysLocation","magnitudeRangeLocation","textureUnitLocation","fragModeLocation","colorLocation","localState","mvpMatrix","magnitudeRange","textureUnit","fragMode","color","matrix","forceLoad","fromIdentity","equals","loadUniformMatrix","copy","uniform1f","minMag","maxMag","uniform2f","unit","uniform1i","TEXTURE0","mode","loadUniformColor","key","MoonPosition","meanDistance","Layer","REDRAW_EVENT_TYPE","StarFieldLayer","starDataSource","pickEnabled","sunSize","showSun","showMoon","_starDataSource","configuration","baseUrl","_sunImageSource","_moonImageSource","_matrix","_starsPositionsVboCacheKey","_numStars","_starData","_minMagnitude","Number","MAX_VALUE","_maxMagnitude","MIN_VALUE","_loadStarted","_minScale","_scale","MAX_SAFE_INTEGER","pow","_sunPositionsCacheKey","_sunBufferView","Float32Array","_moonPositionsCacheKey","_moonBufferView","_MAX_GL_POINT_SIZE","showPlanets","planets","url","size","jupiterSize","_planetsBufferView","_cacheKeys","sunPosition","planetPositions","starPositions","dc","globe","is2D","haveResources","beginRendering","doDraw","endRendering","loadResources","sunTexture","gpuResourceCache","resourceForKey","moonTexture","planetTextures","every","planet","currentGlContext","fetchStarData","retrieveTexture","forEach","findAndBindProgram","enableVertexAttribArray","depthMask","loadCommonUniforms","renderStars","renderSun","renderMoon","renderPlanets","program","currentProgram","mvp","modelviewProjection","navigatorState","multiplyByScale","loadModelviewProjection","julianDate","time","loadNumDays","generateCacheKey","vboId","bindBuffer","ARRAY_BUFFER","createBuffer","positions","createStarsGeometry","putResource","length","bufferData","STATIC_DRAW","frameStatistics","incrementVboLoadCount","vertexAttribPointer","FLOAT","loadMagnitudeRange","loadFragMode","drawArrays","POINTS","_this2","getParameter","ALIASED_POINT_SIZE_RANGE","log","LEVEL_WARNING","_Celestial$getCelesti","min","_planetsPositionsVboCacheKey","bufferSubData","DYNAMIC_DRAW","textureSrc","bind","sunCelestialLocation","moonCelestialLocation","disableVertexAttribArray","self","xhr","XMLHttpRequest","onload","status","JSON","parse","response","sendRedrawRequest","toString","statusText","onerror","ontimeout","open","send","indexes","parseStarsMetadata","metadata","raIndex","Error","decIndex","magIndex","data","len","starInfo","magnitude","pointSize","push","max","floor","starMetaInfo","name","document","createEvent","initEvent","window","dispatchEvent","value","invalidateStarData","PickedObject","SurfacePolygon","ColladaScene","SurfaceShape","Model","model","satellite","position","_satellite","satelliteModel","draw","_model","modelData","_this$_satellite","rotations","translations","preRotations","scale","shortName","ignoreLocalTransforms","type","satShortName","nodesToHide","hideNodes","useTexturePaths","localTransforms","xRotation","x","yRotation","y","zRotation","z","xTranslation","yTranslation","zTranslation","preX","preY","preZ","jsonData","meshes","nodes","root","children","materials","hasOwnProperty","buffers","vertices","normals","uvs","indices","eVertices","eNormals","eUvs","eIndices","Uint16Array","node","mesh","worldMatrix","slice","console","info","material","reflective","diffuse","textures","mapId","enabled","render","Renderable","Position","modelsLayer","RenderableLayer","fetch","then","json","satelliteData","addRenderable","SatelliteModel","headingAxis","headingAdd","headingMultiply","useEww","clon","clat","alt","starfield","atmosphere","names","eww","useRef","_useState","useState","_useState2","slicedToArray","setProjection","_useState3","_useState4","_useState5","_useState6","atmo","setAtmo","_useState7","_useState8","geojsonlayers","setGeojsonlayers","_useState9","_useState10","_useState11","_useState12","setEwwState","_useState13","_useState14","fpcamera","abcamera","lastAbTilt","_useState15","_useState16","cameraMode","setCameraMode","addQuicklookWMS","renderable","computeSectors","current","drawContext","Sector","FULL_SPHERE","wmsConfigQL","service","layerNames","title","numLevels","format","sector","levelZeroDelta","Location","qllayer","WmsLayer","userProperties","addLayer","redraw","layers","getLayerByName","displayName","enableRenderables","_x","_enableRenderables","apply","arguments","asyncToGenerator","regenerator_default","mark","_callee","j","renderableStartDate","renderableStopDate","wrap","_context","prev","next","includes","renderables","earthObservation","acquisitionInformation","acquisitionParameter","acquisitionStartTime","getTime","acquisitionStopTime","timeOffset","stop","setGlobeStates","navigator","lookAtLocation","al","range","handleClick","recognizer","clientX","clientY","pickList","pick","canvasCoordinates","terrainObject","removeLayer","highlighted","pickedItems","objects","userObject","ewwstate","objectSpread","handleDoubleClick","point","aoi","useLayoutEffect","elevationModel","ElevationModel","addCoverage","TiledElevationCoverage","coverageSector","resolution","retrievalImageFormat","minElevation","maxElevation","urlBuilder","WcsTileUrlBuilder","WorldWindow","FirstPersonCamera","ArcBallCamera","redrawCallbacks","clickRecognizer","ClickRecognizer","numberOfClicks","doubleClickRecognizer","recognizeSimultaneouslyWith","maxClickInterval","tapRecognizer","TapRecognizer","numberOfTaps","doubleTapRecognizer","maxTapInterval","wmsConfigBg_s2","wmsConfigBg_terrain","wmsConfigNames","starFieldLayer","atmosphereLayer","AtmosphereLayer","quicklookLayer","layer","l","setTimeout","goToAnimator","travelTime","goTo","deepPicking","useEffect","copyParamCamera","fromcamera","tocamera","heading","tilt","roll","camera","setCamera","removeGeojson","addGeojson","epoch","renderableLayer","properties","updated","ceil","random","GeoJSONParser","load","concat","toConsumableArray","geometry","placemarkAttributes","PlacemarkAttributes","imageScale","imageColor","labelAttributes","offset","Offset","OFFSET_FRACTION","isPointType","isMultiPointType","attributes","isLineStringType","isMultiLineStringType","drawOutline","outlineColor","interiorColor","red","green","blue","outlineWidth","isPolygonType","isMultiPolygonType","ShapeAttributes","highlightAttributes","addWMS","setStarfield","bool","setAtmosphere","setTime","toggleProjection","prevProj","supportedProjections","newProj","indexOf","projection","ProjectionWgs84","ProjectionEquirectangular","ProjectionMercator","ProjectionPolarEquidistant","setNames","toggleModel","toggleBg","northUp","wwd","headingIncrement","runOperation","Earth","viewdate","_useEww","useHotkeys","react_default","createElement","style","background","left","width","height","ControlPanel","props","setOpen","_useSpring","useSpring","mr","_useSpring2","set","useGesture","onDrag","down","delta","vxvy","web","div","assign","right","top","className","src","onClick","DateLabel","highlight","animated","dateFormat","toUpperCase","DateSelectorScale","zoomfactor","ref","_start","_zoom","hour","monthcode","minute","lastday","lastmonth","lastyear","lasthour","lastminute","tics","offsetHeight","refdate","class","pos","label","pad","map","item","number","str","scaleText","DateSelector","startdate","onDateChange","increment","incrementSpeed","onFinalDateChange","onStepChange","selector","lastZoom","scaledate","setScaledate","lastStartdate","setlLastStartdate","active","setActive","step","setStep","stepLabel","setStepLabel","setZoomfactor","lastTap","doubleTap","posxy_drag","setyOnDrag","_useSpring3","xy2","_useSpring4","sety2","stop2","_useSpring5","posxy_wheel","_useSpring6","setyOnWheel","onDragEnd","onWheel","zoom","movement","shiftKey","first","direction","last","_ref2$memo","wheeling","memo","lastposxy","getValue","immediate","onFrame","factor","nd","newdate","onRest","setValue","_ref3","event","velocity","now","handleDoubleTap","config","decay","toJSON","deltaoffset","reset","moveToDate","dateselector_DateSelectorScale","points","DateManager","dateLabelHighlight","setDateLabelHighlight","dateLabelDate","setDateLabeDate","datelabel_DateLabel","dateselector_DateSelector","CDateManager","_useGlobal","useGlobal","_useGlobal2","setViewDate","_useGlobal3","_useGlobal4","setSearchDate","_useGlobal5","_useGlobal6","searching","_useGlobal7","_useGlobal9","_useGlobal11","_useGlobal12","dateManagerDate","build_default","datemanager_DateManager","useDateIncrementor","autoStart","initdate","setDate","playing","refreshrate","ldate","intervalRef","clearInterval","togglePause","setInterval","increaseSpeed","decreaseSpeed","forceDate","DateController","startingDate","_useDateIncrementor","CDateController","setDateManagerDate","searchDate","_useGlobal8","dateControllerDate","setDateControllerDate","datecontroller_DateController","MissionSelector","initialmission","onMissionChange","mission","setMission","CMissionSelector","missionselector_MissionSelector","MapSelector","onMapSettingsChange","mapSettings","setMapSettings","toggleAtmosphere","toggleStarfield","toggleNames","draggable","CMapSelector","mapselector_MapSelector","App","viewDate","isFull","setIsfull","_useFullscreen","useFullscreen","body","isFullscreen","toggleFullscreen","dist_default","onChange","components_earth_Earth","DateManagerContainer","DateControllerContainer","controlpanel_ControlPanel","MissionSelectorContainer","MapSelectorContainer","Boolean","location","hostname","match","setGlobal","controllerDate","ReactDOM","app_App","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"+eAiBIA,EAGAC,IAHAD,MACAE,EAEAD,IAFAC,cACAC,EACAF,IADAE,OA8JWC,EAvJK,CAQhBC,wBAAyB,SAAUC,GAC/B,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,cAAe,0BAClD,gBAGZ,IAAIC,EAAoBC,KAAKC,uBAAuBN,GACpD,OAAOK,KAAKE,sBAAsBH,EAAmBJ,IASzDM,uBAAwB,SAAUN,GAC9B,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,cAAe,yBAClD,gBAGZ,IAGIK,EAHaH,KAAKI,kBAAkBT,GAGb,QAEvBU,EAAgBL,KAAKM,kBAAkB,OAAU,SAAYH,GAE7DI,EAAcP,KAAKM,kBAAkB,QAAU,SAAYH,GAAWd,EAAMmB,mBAE5EC,EAAoBJ,EAAgB,MAAQK,KAAKC,IAAIJ,GAAe,IAAOG,KAAKC,IAAI,EAAIJ,GACxFK,EAAuBH,EAAoBpB,EAAMmB,mBAEjDK,GAA0B,OAAS,KAAYV,GAAWd,EAAMmB,mBAEhEM,EAAcJ,KAAKK,KAAKL,KAAKC,IAAIE,GAA0BH,KAAKC,IAAIC,IACpEvB,EAAM2B,mBAENC,EAAiBP,KAAKQ,KAAKR,KAAKS,IAAIN,GAA0BH,KAAKU,IAAIR,IACvEvB,EAAM2B,mBAQV,OALIP,GAAqB,IAAMA,EAAoB,MAC/CQ,GAAkB,KAIf,CACHH,YAAaA,EACbG,eAJJA,EAAiBjB,KAAKM,kBAAkBW,KAgB5Cf,sBAAuB,SAAUH,EAAmBJ,GAChD,IAAKI,EACD,MAAM,IAAIR,EACNC,EAAOK,WAAWL,EAAOM,aAAc,cAAe,wBAClD,6BAEZ,GAAIH,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,cAAe,wBAAyB,gBAGvF,IAGIK,EAHaH,KAAKI,kBAAkBT,GAGb,QAGvB0B,EAAOrB,KAAKM,kBAAkB,aAAe,gBAAkBH,GAG/DmB,EAAMtB,KAAKM,kBAAkBe,EAAOtB,EAAkBkB,gBAEtDM,EAAYlC,EAAMmC,4BAA4BF,GAElD,MAAO,CACHG,SAAU1B,EAAkBe,YAC5BS,UAAWA,IAUnBnB,kBAAmB,SAAUT,GACzB,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,cAAe,oBAAqB,gBAGnF,IAAI4B,EAAO/B,EAAKgC,iBACZC,EAAQjC,EAAKkC,cAAgB,EAC7BC,EAAMnC,EAAKoC,aAKXC,GAJOrC,EAAKsC,cACHtC,EAAKuC,gBAGiB,GAFtBvC,EAAKwC,gBAE+B,MAAQ,GAErDP,GAAS,IACTF,GAAQ,EACRE,GAAS,IAGb,IAAIQ,EAAI1B,KAAK2B,MAAMX,EAAO,KACtBY,EAAI,EAAIF,EAAI1B,KAAK2B,MAAMD,EAAI,GAG/B,OAFW1B,KAAK2B,MAAM,QAAUX,EAAO,OAAShB,KAAK2B,MAAM,SAAWT,EAAQ,IAAME,EAAMQ,EAAI,OAEhFN,GAYlB1B,kBAAmB,SAASiC,GACxB,IAAIC,EAAQD,EAAU,IACtB,OAAOC,GAAS,EAAIA,EAASA,EAAQ,EAAI,IAAMA,EAAQ,IAAMA,ICzKjEnD,EACAC,IADAD,MAyOWoD,EAtOG,CAEdC,IAAK,EACLC,QAAS,EACTC,MAAO,EACPC,KAAM,EACNC,QAAS,EACTC,OAAQ,EACRC,OAAQ,EACRC,QAAS,EAETC,qBAXc,SAWOC,EAAIxD,GACrB,IAAIyD,EAEAC,EADe5D,EAAYW,kBAAkBT,GAC5B,UAGrB,OAAQwD,GACJ,KAAKnD,KAAK0C,IACNU,EAAkBpD,KAAKsD,WAAWD,GAClC,MAEJ,KAAKrD,KAAK2C,QACNS,EAAkBpD,KAAKuD,eAAeF,GACtC,MAEJ,KAAKrD,KAAK4C,MACNQ,EAAkBpD,KAAKwD,aAAaH,GACpC,MAEJ,KAAKrD,KAAK6C,KACNO,EAAkBpD,KAAKyD,YAAYJ,GACnC,MAEJ,KAAKrD,KAAK8C,QACNM,EAAkBpD,KAAK0D,eAAeL,GACtC,MAEJ,KAAKrD,KAAK+C,OACNK,EAAkBpD,KAAK2D,cAAcN,GACrC,MAEJ,KAAKrD,KAAKgD,OACNI,EAAkBpD,KAAK4D,cAAcP,GACrC,MAEJ,KAAKrD,KAAKiD,QACNG,EAAkBpD,KAAK6D,eAAeR,GAI9C,OAAOrD,KAAK8D,gBAAgBT,EAAGD,IAGnCG,eAtDc,SAsDCF,GAQX,MAAO,CAACU,EAPE,QAAU,WAAaV,EAOtBW,EAND,OAAS,KAAUX,EAMfY,EALJ,QAAU,WAAaZ,EAKhBa,EAJP,QAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,SAAW,aAAef,IAKxCG,aAjEc,SAiEDH,GAQT,MAAO,CAACU,EAPE,QAAU,SAAaV,EAOtBW,EAND,OAAS,QAAUX,EAMfY,EALJ,OAAU,WAAaZ,EAKhBa,EAJP,OAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,QAAU,aAAef,IAKvCI,YA5Ec,SA4EFJ,GAQR,MAAO,CAACU,EAPE,QAAU,WAAaV,EAOtBW,EAND,OAAS,QAAUX,EAMfY,EALJ,SAAW,WAAaZ,EAKjBa,EAJP,SAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,QAAU,YAAef,IAKvCK,eAvFc,SAuFCL,GAQX,MAAO,CAACU,EAPE,SAAW,WAAaV,EAOvBW,EAND,MAAS,SAAWX,EAMhBY,EALJ,SAAW,WAAaZ,EAKjBa,EAJP,QAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,OAAU,YAAef,IAKvCM,cAlGc,SAkGAN,GAQV,MAAO,CAACU,EAPE,SAAW,SAAaV,EAOvBW,EAND,OAAS,SAAWX,EAMhBY,EALJ,SAAW,WAAaZ,EAKjBa,EAJP,QAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,QAAW,YAAef,IAKxCO,cA7Gc,SA6GAP,GAQV,MAAO,CAACU,EAPE,QAAU,SAAYV,EAOrBW,EAND,MAAS,OAASX,EAMdY,EALJ,QAAU,SAAYZ,EAKfa,EAJP,SAAW,QAAUb,EAIXc,EAHV,QAAW,QAAUd,EAGRe,EAFb,SAAW,WAAcf,IAKvCQ,eAxHc,SAwHCR,GAQX,MAAO,CAACU,EAPE,SAAW,SAAYV,EAOtBW,EAND,KAAS,QAAUX,EAMfY,EALJ,SAAW,QAAWZ,EAKfa,EAJP,SAAW,SAAWb,EAIZc,EAHV,QAAW,QAAUd,EAGRe,EAFb,SAAW,WAAcf,IAKvCC,WAnIc,SAmIHD,GAQP,MAAO,CAACU,EAPE,EAOCC,EAND,EAMIC,EALJ,SAAW,WAAaZ,EAKjBa,EAJP,EAIUC,EAHV,QAAW,SAAWd,EAGTe,EAFb,QAAW,YAAef,IAKxCS,gBA9Ic,SA8IET,EA9IFgB,GA8IyB,IAAnBN,EAAmBM,EAAnBN,EAAGC,EAAgBK,EAAhBL,EAAGC,EAAaI,EAAbJ,EAAGC,EAAUG,EAAVH,EAAGC,EAAOE,EAAPF,EAAGC,EAAIC,EAAJD,EAC/BL,EAAItE,EAAYa,kBAAkByD,GAAK1E,EAAMmB,mBAC7CwD,EAAIvE,EAAYa,kBAAkB0D,GAAK3E,EAAMmB,mBAC7CyD,EAAIxE,EAAYa,kBAAkB2D,GAAK5E,EAAMmB,mBAI7C,IAAI8D,GAFJF,EAAI3E,EAAYa,kBAAkB8D,GAAK/E,EAAMmB,oBAEjC2D,EAAIzD,KAAKC,IAAIyD,IAAM,EAAMD,EAAIzD,KAAKS,IAAIiD,IAElD,GAAID,GAAK,IACL,IAAK,IAAII,EAAK,EAAGA,EAAK,GAAIA,IAAM,CAC5B,IAAIC,EAAKF,GAAKA,EAAIH,EAAIzD,KAAKC,IAAI2D,GAAKF,IAAM,EAAID,EAAIzD,KAAKS,IAAImD,IAC3D,GAAI5D,KAAK+D,IAAID,EAAKF,GAAK,KAAO,CAC1BA,EAAIE,EACJ,MAEJF,EAAIE,EAIZ,IAAME,EAAKR,GAAKxD,KAAKS,IAAImD,GAAKH,GACxBQ,EAAKT,GAAKxD,KAAKkE,KAAK,EAAMT,EAAIA,GAAKzD,KAAKC,IAAI2D,IAE5CO,EAAInE,KAAKoE,MAAMH,EAAID,GACnBK,EAAIrE,KAAKkE,KAAKF,EAAKA,EAAKC,EAAKA,GAE/BK,EAAKD,GAAKrE,KAAKS,IAAI4C,GAAKrD,KAAKS,IAAI0D,EAAIZ,GAAKvD,KAAKC,IAAIoD,GAAKrD,KAAKC,IAAIkE,EAAIZ,GAAKvD,KAAKS,IAAI6C,IACnFiB,EAAKF,GAAKrE,KAAKC,IAAIoD,GAAKrD,KAAKS,IAAI0D,EAAIZ,GAAKvD,KAAKS,IAAI4C,GAAKrD,KAAKC,IAAIkE,EAAIZ,GAAKvD,KAAKS,IAAI6C,IACnFkB,EAAKH,GAAKrE,KAAKC,IAAIkE,EAAIZ,GAAKvD,KAAKC,IAAIqD,IAGnCmB,EAAW,YAAc,EAA8B9B,GAAKhE,EAAMmB,mBAElE4E,EAAS1E,KAAKoE,MAAMG,EAAID,GAAMG,EAC9BE,EAAS3E,KAAKoE,MAAMI,EAAIxE,KAAKkE,KAAKI,EAAKA,EAAKC,EAAKA,IAOvDD,EAAKD,EAAIrE,KAAKS,IAAIiE,GAAU1E,KAAKS,IAAIkE,GACrCJ,EAAKF,EAAIrE,KAAKC,IAAIyE,GAAU1E,KAAKS,IAAIkE,GACrCH,EAAKH,EAAIrE,KAAKC,IAAI0E,GA3CiB,IAAAC,EA6CdtF,KAAKuF,UAAUlC,EAAGrD,KAAKsD,WAAWD,IAAlDmC,EA7C8BF,EA6C9BE,OAAQC,EA7CsBH,EA6CtBG,KACbD,GAAUnG,EAAM2B,mBAChBwE,EAAS/F,EAAYa,kBAAkBkF,GAAUnG,EAAMmB,mBAEvD,IAGMkF,EAAKV,EAHAS,EAAO/E,KAAKS,IAAIqE,GAIrBG,EAAKV,EAHAQ,EAAO/E,KAAKC,IAAI6E,GAIrBI,EAAKV,EAELW,EAAMpG,EAAYa,kBAAkB,QAAU,SAAW+C,GAAKhE,EAAMmB,mBAEpEsF,EAAKJ,EACLK,EAAKJ,EAAKjF,KAAKS,IAAI0E,GAAOD,EAAKlF,KAAKC,IAAIkF,GACxCG,EAAKL,EAAKjF,KAAKC,IAAIkF,GAAOD,EAAKlF,KAAKS,IAAI0E,GAK9C,MAAO,CAACI,GAHGxG,EAAYa,kBAAkBI,KAAKoE,MAAMiB,EAAID,GAAMzG,EAAM2B,oBAGxDkF,IAFAxF,KAAKoE,MAAMkB,EAAItF,KAAKkE,KAAKkB,EAAKA,EAAKC,EAAKA,IAAO1G,EAAM2B,qBAKrEuE,UAlNc,SAkNJlC,EAlNI8C,GAkNU,IAAVlC,EAAUkC,EAAVlC,EAAGE,EAAOgC,EAAPhC,EAAGC,EAAI+B,EAAJ/B,EAChBH,EAAIxE,EAAYa,kBAAkB2D,GAAK5E,EAAMmB,mBAI7C,IAAM8D,GAFNF,EAAI3E,EAAYa,kBAAkB8D,GAAK/E,EAAMmB,oBAE/B2D,EAAIzD,KAAKC,IAAIyD,IAAM,EAAMD,EAAIzD,KAAKS,IAAIiD,IAE9CM,EAAKhE,KAAKS,IAAImD,GAAKH,EACnBQ,EAAKjE,KAAKkE,KAAK,EAAMT,EAAIA,GAAKzD,KAAKC,IAAI2D,GAO7C,MAAO,CAACkB,OALE9E,KAAKoE,MAAMH,EAAID,GAGNT,EAEHwB,KAJH/E,KAAKkE,KAAKF,EAAKA,EAAKC,EAAKA,MC7N1CpF,EAKAD,IALAC,cACA6G,EAIA9G,IAJA8G,WACA5G,EAGAF,IAHAE,OACA6G,EAEA/G,IAFA+G,OACAC,EACAhH,IADAgH,MAmBEC,cACF,SAAAA,EAAYC,GAAI,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAA1G,KAAAuG,IACZE,EAAAC,OAAAE,EAAA,EAAAF,CAAA1G,KAAA0G,OAAAG,EAAA,EAAAH,CAAAH,GAAAO,KAAA9G,KAAMwG,EAAI,wmCAsCD,ufAsBA,CAAC,kBAELO,oBAAsB,EAC3BN,EAAKO,kBAAoB,EACzBP,EAAKQ,gBAAkB,EAOvBR,EAAKS,oBAAsBT,EAAKU,kBAAkBX,EAAI,eAOtDC,EAAKW,kBAAoBX,EAAKY,gBAAgBb,EAAI,aAOlDC,EAAKa,gBAAkBb,EAAKY,gBAAgBb,EAAI,WAOhDC,EAAKc,uBAAyBd,EAAKY,gBAAgBb,EAAI,kBAOvDC,EAAKe,oBAAsBf,EAAKY,gBAAgBb,EAAI,kBAOpDC,EAAKgB,iBAAmBhB,EAAKY,gBAAgBb,EAAI,YAEjDC,EAAKiB,cAAgBjB,EAAKY,gBAAgBb,EAAI,SAE9CC,EAAKkB,WAAa,CACdC,UAAW,KACXzH,QAAS,KACT0H,eAAgB,KAChBC,YAAa,KACbC,SAAU,KACVC,MAAO,MArHCvB,uFAgIQD,EAAIyB,GACxB,IAAKA,EACD,MAAM,IAAI1I,EACNC,EAAOK,WAAWL,EAAOM,aAAc,mBAAoB,0BAA2B,kBAG9F,IAAIoI,GAAY,EACkB,OAA9BlI,KAAK2H,WAAWC,YAChBM,GAAY,EACZlI,KAAK2H,WAAWC,UAAYvB,EAAO8B,iBAGnCD,GAAclI,KAAK2H,WAAWC,UAAUQ,OAAOH,KAC/CjI,KAAKqI,kBAAkB7B,EAAIyB,EAAQjI,KAAKoH,mBACxCpH,KAAK2H,WAAWC,UAAUU,KAAKL,wCAY3BzB,EAAIrG,GACZ,GAAe,MAAXA,EACA,MAAM,IAAIZ,EACNC,EAAOK,WAAWL,EAAOM,aAAc,mBAAoB,cAAe,mBAE9EE,KAAK2H,WAAWxH,UAAYA,IAC5BqG,EAAG+B,UAAUvI,KAAKsH,gBAAiBnH,GACnCH,KAAK2H,WAAWxH,QAAUA,8CAYfqG,EAAIgC,EAAQC,GAC3B,GAAc,MAAVD,EACA,MAAM,IAAIjJ,EACNC,EAAOK,WAAWL,EAAOM,aAAc,mBAAoB,eAAgB,kBAEnF,GAAc,MAAV2I,EACA,MAAM,IAAIlJ,EACNC,EAAOK,WAAWL,EAAOM,aAAc,mBAAoB,eAAgB,kBAEnF,IAAIoI,GAAY,EACuB,OAAnClI,KAAK2H,WAAWE,iBAChBK,GAAY,EACZlI,KAAK2H,WAAWE,eAAiB,CAACW,EAAQC,KAG1CP,GAAalI,KAAK2H,WAAWE,eAAe,KAAOW,GAAUxI,KAAK2H,WAAWE,eAAe,KAAOY,KACnGjC,EAAGkC,UAAU1I,KAAKuH,uBAAwBiB,EAAQC,GAClDzI,KAAK2H,WAAWE,eAAe,GAAKW,EACpCxI,KAAK2H,WAAWE,eAAe,GAAKY,2CAS5BjC,EAAImC,GACZ3I,KAAK2H,WAAWG,cAAgBa,IAChCnC,EAAGoC,UAAU5I,KAAKwH,oBAAqBmB,EAAOnC,EAAGqC,UACjD7I,KAAK2H,WAAWG,YAAca,wCAIzBnC,EAAIsC,GACT9I,KAAK2H,WAAWI,WAAae,IAC7BtC,EAAGoC,UAAU5I,KAAKyH,iBAAkBqB,GACpC9I,KAAK2H,WAAWI,SAAWe,qCAIzBtC,EAAIwB,GACV,IAAIE,GAAY,EACc,OAA1BlI,KAAK2H,WAAWK,QAChBE,GAAY,EACZlI,KAAK2H,WAAWK,MAAQ,IAAI1B,EAAM,EAAG,EAAG,EAAG,KAG3C4B,GAAclI,KAAK2H,WAAWK,MAAMI,OAAOJ,KAC3ChI,KAAK+I,iBAAiBvC,EAAIwB,EAAOhI,KAAK0H,eACtC1H,KAAK2H,WAAWK,MAAMM,KAAKN,WAhOR5B,GA0O/BG,EAAiByC,IAAM,mCAERzC,QCxPXlH,EAGAC,IAHAD,MACAE,EAEAD,IAFAC,cACAC,EACAF,IADAE,OA8JWyJ,EAvJM,CAQjBvJ,wBAAyB,SAAUC,GAC/B,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,eAAgB,0BACnD,gBAGZ,IAAIC,EAAoBC,KAAKC,uBAAuBN,GACpD,OAAOK,KAAKE,sBAAsBH,EAAmBJ,IASzDM,uBAAwB,SAAUN,GAC9B,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,eAAgB,yBACnD,gBAGZ,IAGIK,EAHaH,KAAKI,kBAAkBT,GAGb,QAEvBc,EAAoBT,KAAKM,kBAAkB,QAAU,UAAYH,GAAWd,EAAMmB,mBAClFD,EAAcP,KAAKM,kBAAkB,QAAU,UAAaH,GAAWd,EAAMmB,mBAC7E0I,EAAelJ,KAAKM,kBAAkB,OAAS,SAAaH,GAAWd,EAAMmB,mBAE7Ee,EAAYd,EAAoB,MAAQC,KAAKC,IAAIJ,GAAelB,EAAMmB,mBACtEiB,EAAW,MAAQf,KAAKC,IAAIuI,GAAgB7J,EAAMmB,mBAClDK,GAA0B,OAAS,KAAYV,GAAWd,EAAMmB,mBAEhES,EAAiBP,KAAKoE,MAAOpE,KAAKC,IAAIY,GAAab,KAAKS,IAAIN,GAA0BH,KAAKU,IAAIK,GAAYf,KAAKC,IAAIE,GAA0BH,KAAKS,IAAII,IAC3JlC,EAAM2B,mBAYN,MAAO,CACHF,YAXcJ,KAAKK,KAAML,KAAKC,IAAIc,GAAYf,KAAKS,IAAIN,GAA0BH,KAAKS,IAAIM,GAAYf,KAAKC,IAAIE,GAA0BH,KAAKC,IAAIY,IACtJlC,EAAM2B,mBAWFC,eAJJA,EAAiBjB,KAAKM,kBAAkBW,KAgB5Cf,sBAAuB,SAAUH,EAAmBJ,GAChD,IAAKI,EACD,MAAM,IAAIR,EACNC,EAAOK,WAAWL,EAAOM,aAAc,eAAgB,wBACnD,6BAEZ,GAAIH,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,eAAgB,wBAAyB,gBAGxF,IAGIK,EAHaH,KAAKI,kBAAkBT,GAGb,QAGvB0B,EAAOrB,KAAKM,kBAAkB,aAAe,gBAAkBH,GAG/DmB,EAAMtB,KAAKM,kBAAkBe,EAAOtB,EAAkBkB,gBAEtDM,EAAYlC,EAAMmC,4BAA4BF,GAElD,MAAO,CACHG,SAAU1B,EAAkBe,YAC5BS,UAAWA,IAUnBnB,kBAAmB,SAAUT,GACzB,GAAIA,aAAgBC,QAAS,EACzB,MAAM,IAAIL,EACNC,EAAOK,WAAWL,EAAOM,aAAc,eAAgB,oBAAqB,gBAGpF,IAAI4B,EAAO/B,EAAKgC,iBACZC,EAAQjC,EAAKkC,cAAgB,EAC7BC,EAAMnC,EAAKoC,aAKXC,GAJOrC,EAAKsC,cACHtC,EAAKuC,gBAGiB,GAFtBvC,EAAKwC,gBAE+B,MAAQ,GAErDP,GAAS,IACTF,GAAQ,EACRE,GAAS,IAGb,IAAIQ,EAAI1B,KAAK2B,MAAMX,EAAO,KACtBY,EAAI,EAAIF,EAAI1B,KAAK2B,MAAMD,EAAI,GAG/B,OAFW1B,KAAK2B,MAAM,QAAUX,EAAO,OAAShB,KAAK2B,MAAM,SAAWT,EAAQ,IAAME,EAAMQ,EAAI,OAEhFN,GAYlB1B,kBAAmB,SAASiC,GACxB,IAAIC,EAAQD,EAAU,IACtB,OAAOC,GAAS,EAAIA,EAASA,EAAQ,EAAI,IAAMA,EAAQ,IAAMA,ICjKjE2G,GAIA7J,IALAgH,MAKAhH,IAJA6J,OACA3J,EAGAF,IAHAE,OACA6G,EAEA/G,IAFA+G,OACA+C,EACA9J,IADA8J,kBAinBWC,cAnlBX,SAAAA,EAAYC,GAAgB,IAAA7C,EAAAC,OAAAC,EAAA,EAAAD,CAAA1G,KAAAqJ,IACxB5C,EAAAC,OAAAE,EAAA,EAAAF,CAAA1G,KAAA0G,OAAAG,EAAA,EAAAH,CAAA2C,GAAAvC,KAAA9G,KAAM,eAGDuJ,aAAc,EASnB9C,EAAK+C,QAAU,IAOf/C,EAAKgD,SAAU,EAOfhD,EAAKiD,UAAW,EAGhBjD,EAAKkD,gBAAkBL,GAAkBhK,IAAUsK,cAAcC,QAAU,kBAC3EpD,EAAKqD,gBAAkBxK,IAAUsK,cAAcC,QAAU,wBACzDpD,EAAKsD,iBAAmBzK,IAAUsK,cAAcC,QAAU,yBAI1DpD,EAAKuD,QAAU3D,EAAO8B,eAItB1B,EAAKwD,2BAA6B,KAGlCxD,EAAKyD,UAAY,EAGjBzD,EAAK0D,UAAY,KAGjB1D,EAAK2D,cAAgBC,OAAOC,UAC5B7D,EAAK8D,cAAgBF,OAAOG,UAI5B/D,EAAKgE,cAAe,EAGpBhE,EAAKiE,UAAY,IACjBjE,EAAKkE,OAASN,OAAOO,kBAAoBlK,KAAKmK,IAAI,EAAG,IAAM,EAI3DpE,EAAKqE,sBAAwB,GAC7BrE,EAAKsE,eAAiB,IAAIC,aAAa,GAGvCvE,EAAKwE,uBAAyB,GAC9BxE,EAAKyE,gBAAkB,IAAIF,aAAa,GAGxCvE,EAAK0E,mBAAqB,EAE1B1E,EAAK2E,aAAc,EAxEK,OA4ExB3E,EAAK4E,QAAU,CACX,CACIlI,GAAIV,EAAUE,QACd2I,IAAK,uBACLC,KAAMC,EACNvF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUG,MACd0I,IAAK,qBACLC,KAAMC,EACNvF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUI,KACdyI,IAAK,oBACLC,KAAMC,EACNvF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUK,QACdwI,IAAK,uBACLC,KA3BY,GA4BZtF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUM,OACduI,IAAK,sBACLC,KAlCY,GAmCZtF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUO,OACdsI,IAAK,sBACLC,KAAMC,GACNvF,GAAI,KACJC,IAAK,MAET,CACI/C,GAAIV,EAAUQ,QACdqI,IAAK,uBACLC,KAAMC,GACNvF,GAAI,KACJC,IAAK,OAIbO,EAAKgF,mBAAqB,KAE1BhF,EAAKiF,WAAa,CACdC,YAAa,GACbC,gBAAiB,GACjBC,cAAe,IArIKpF,wEAkLnBqF,GACL,IAAIA,EAAGC,MAAMC,OAIb,GAAKhM,KAAKiM,cAAcH,GAAxB,CAKA9L,KAAKkM,eAAeJ,GACpB,IACI9L,KAAKmM,OAAOL,GADhB,QAII9L,KAAKoM,aAAaN,SATlB9L,KAAKqM,cAAcP,yCAcbA,GACV,IAAIQ,EAAaR,EAAGS,iBAAiBC,eAAexM,KAAK8J,iBACrD2C,EAAcX,EAAGS,iBAAiBC,eAAexM,KAAK+J,kBACtD2C,EAAiB1M,KAAKqL,QAAQsB,MAAM,SAAAC,GAEpC,QADgBd,EAAGS,iBAAiBC,eAAeI,EAAOtB,OAG9D,OACsB,MAAlBtL,KAAKmK,WACS,MAAdmC,GACe,MAAfG,GACAC,wCAKMZ,GACV,IAAItF,EAAKsF,EAAGe,iBACRN,EAAmBT,EAAGS,iBAErBvM,KAAKmK,WACNnK,KAAK8M,gBAGQP,EAAiBC,eAAexM,KAAK8J,kBAElDyC,EAAiBQ,gBAAgBvG,EAAIxG,KAAK8J,iBAG5ByC,EAAiBC,eAAexM,KAAK+J,mBAEnDwC,EAAiBQ,gBAAgBvG,EAAIxG,KAAK+J,kBAG9C/J,KAAKqL,QAAQ2B,QAAQ,SAAAJ,GACDL,EAAiBC,eAAeI,EAAOtB,MAEnDiB,EAAiBQ,gBAAgBvG,EAAIoG,EAAOtB,8CAMzCQ,GACX,IAAItF,EAAKsF,EAAGe,iBACZf,EAAGmB,mBAAmB1G,GACtBC,EAAG0G,wBAAwB,GAC3B1G,EAAG2G,WAAU,kCAIVrB,GACH9L,KAAKoN,mBAAmBtB,GAExB9L,KAAKqN,YAAYvB,GAEb9L,KAAKyJ,SACLzJ,KAAKsN,UAAUxB,GAGf9L,KAAK0J,UACL1J,KAAKuN,WAAWzB,GAGhB9L,KAAKoL,aACLpL,KAAKwN,cAAc1B,8CAKRA,GACf,IAAItF,EAAKsF,EAAGe,iBACRY,EAAU3B,EAAG4B,eAEbC,EAAM7B,EAAG8B,qBAAuB9B,EAAG+B,eAAeD,oBACtD5N,KAAKgK,QAAQ1B,KAAKqF,GAClB3N,KAAKgK,QAAQ8D,gBAAgB9N,KAAK2K,OAAQ3K,KAAK2K,OAAQ3K,KAAK2K,QAE5D8C,EAAQM,wBAAwBvH,EAAIxG,KAAKgK,SAKzC,IAAIgE,EAAavO,EAAYW,kBAAkBJ,KAAKiO,MAAQ,IAAIrO,MAChE6N,EAAQS,YAAY1H,EAAIwH,EAAa,6CAI7BlC,GACR,IAAItF,EAAKsF,EAAGe,iBACRN,EAAmBT,EAAGS,iBACtBkB,EAAU3B,EAAG4B,eAEZ1N,KAAKiK,6BACNjK,KAAKiK,2BAA6BsC,EAAiB4B,oBAEvD,IAAIC,EAAQ7B,EAAiBC,eAAexM,KAAKiK,4BACjD,GAAKmE,EAQD5H,EAAG6H,WAAW7H,EAAG8H,aAAcF,OARvB,CACRA,EAAQ5H,EAAG+H,eACX,IAAIC,EAAYxO,KAAKyO,sBACrBlC,EAAiBmC,YAAY1O,KAAKiK,2BAA4BmE,EAA0B,EAAnBI,EAAUG,QAC/EnI,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGoI,WAAWpI,EAAG8H,aAAc,IAAItD,aAAawD,GAAYhI,EAAGqI,aAKnE/C,EAAGgD,gBAAgBC,sBAAsB,GAEzCvI,EAAGwI,oBAAoB,EAAG,EAAGxI,EAAGyI,OAAO,EAAO,EAAG,GAEjDxB,EAAQyB,mBAAmB1I,EAAIxG,KAAKoK,cAAepK,KAAKuK,eACxDkD,EAAQ0B,aAAa3I,EAAIiH,EAAQ1G,qBAEjCP,EAAG4I,WAAW5I,EAAG6I,OAAQ,EAAGrP,KAAKkK,iDAIvB4B,GAAI,IAAAwD,EAAAtP,KACVwG,EAAKsF,EAAGe,iBACRY,EAAU3B,EAAG4B,eACbnB,EAAmBT,EAAGS,iBAErBvM,KAAKmL,qBACNnL,KAAKmL,mBAAqB3E,EAAG+I,aAAa/I,EAAGgJ,0BAA0B,IAEvExP,KAAKwJ,QAAUxJ,KAAKmL,oBACpB3L,EAAOiQ,IAAIjQ,EAAOkQ,cAAe,4DAC7B1P,KAAKmL,oBAGbnL,KAAKqL,QAAQ2B,QAAQ,SAAAJ,GAAU,IAAA+C,EACTlN,EAAUS,qBAAqB0J,EAAOzJ,GAAImM,EAAKrB,MAAQ,IAAIrO,MAAtEqG,EADoB0J,EACpB1J,GAAIC,EADgByJ,EAChBzJ,IACX0G,EAAO3G,GAAKA,EACZ2G,EAAO1G,IAAMA,GACdlG,MAEEA,KAAKyL,qBACNzL,KAAKyL,mBAAqB,IAAIT,aAAmC,EAAtBhL,KAAKqL,QAAQsD,SAG5D,IAAK,IAAI3K,EAAI,EAAGA,EAAIhE,KAAKqL,QAAQsD,OAAQ3K,IAAK,CAC1C,IAAI4I,EAAS5M,KAAKqL,QAAQrH,GAC1BhE,KAAKyL,mBAAuB,EAAJzH,EAAQ,GAAK4I,EAAO1G,IAC5ClG,KAAKyL,mBAAuB,EAAJzH,EAAQ,GAAK4I,EAAO3G,GAC5CjG,KAAKyL,mBAAuB,EAAJzH,EAAQ,GAAKtD,KAAKkP,IAAIhD,EAAOrB,KAAMvL,KAAKmL,oBAChEnL,KAAKyL,mBAAuB,EAAJzH,EAAQ,GAAK,EAGpChE,KAAK6P,+BACN7P,KAAK6P,6BAA+BtD,EAAiB4B,oBAEzD,IAAIC,EAAQ7B,EAAiBC,eAAexM,KAAK6P,8BAC5CzB,GAOD5H,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGsJ,cAActJ,EAAG8H,aAAc,EAAGtO,KAAKyL,sBAP1C2C,EAAQ5H,EAAG+H,eACXhC,EAAiBmC,YAAY1O,KAAK6P,6BAA8BzB,EAAwC,EAAjCpO,KAAKyL,mBAAmBkD,QAC/FnI,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGoI,WAAWpI,EAAG8H,aAActO,KAAKyL,mBAAoBjF,EAAGuJ,eAM/DjE,EAAGgD,gBAAgBC,sBAAsB,GACzCvI,EAAGwI,oBAAoB,EAAG,EAAGxI,EAAGyI,OAAO,EAAO,EAAG,GAEjDxB,EAAQ0B,aAAa3I,EAAIiH,EAAQzG,mBAEjC,IAAK,IAAIhD,EAAI,EAAGA,EAAIhE,KAAKqL,QAAQsD,OAAQ3K,IAAK,CAC1C,IAAIgM,EAAahQ,KAAKqL,QAAQrH,GAAGsH,IACnBQ,EAAGS,iBAAiBC,eAAewD,GACzCC,KAAKnE,GACbtF,EAAG4I,WAAW5I,EAAG6I,OAAQrL,EAAG,sCAK1B8H,GACN,IAAItF,EAAKsF,EAAGe,iBACRY,EAAU3B,EAAG4B,eACbnB,EAAmBT,EAAGS,iBAErBvM,KAAKmL,qBACNnL,KAAKmL,mBAAqB3E,EAAG+I,aAAa/I,EAAGgJ,0BAA0B,IAEvExP,KAAKwJ,QAAUxJ,KAAKmL,oBACpB3L,EAAOiQ,IAAIjQ,EAAOkQ,cAAe,4DAC7B1P,KAAKmL,oBAGb,IAAI+E,EAAuBzQ,EAAYQ,uBAAuBD,KAAKiO,MAAQ,IAAIrO,MAE/EI,KAAK+K,eAAe,GAAKmF,EAAqBpP,YAC9Cd,KAAK+K,eAAe,GAAKmF,EAAqBjP,eAC9CjB,KAAK+K,eAAe,GAAKrK,KAAKkP,IAAI5P,KAAKwJ,QAASxJ,KAAKmL,oBACrDnL,KAAK+K,eAAe,GAAK,EAEpB/K,KAAK8K,wBACN9K,KAAK8K,sBAAwByB,EAAiB4B,oBAElD,IAAIC,EAAQ7B,EAAiBC,eAAexM,KAAK8K,uBAC5CsD,GAOD5H,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGsJ,cAActJ,EAAG8H,aAAc,EAAGtO,KAAK+K,kBAP1CqD,EAAQ5H,EAAG+H,eACXhC,EAAiBmC,YAAY1O,KAAK8K,sBAAuBsD,EAAoC,EAA7BpO,KAAK+K,eAAe4D,QACpFnI,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGoI,WAAWpI,EAAG8H,aAActO,KAAK+K,eAAgBvE,EAAGuJ,eAM3DjE,EAAGgD,gBAAgBC,sBAAsB,GACzCvI,EAAGwI,oBAAoB,EAAG,EAAGxI,EAAGyI,OAAO,EAAO,EAAG,GAEjDxB,EAAQ0B,aAAa3I,EAAIiH,EAAQzG,mBAEhB8E,EAAGS,iBAAiBC,eAAexM,KAAK8J,iBAC9CmG,KAAKnE,GAEhBtF,EAAG4I,WAAW5I,EAAG6I,OAAQ,EAAG,sCAIrBvD,GACP,IAAItF,EAAKsF,EAAGe,iBACRY,EAAU3B,EAAG4B,eACbnB,EAAmBT,EAAGS,iBAErBvM,KAAKmL,qBACNnL,KAAKmL,mBAAqB3E,EAAG+I,aAAa/I,EAAGgJ,0BAA0B,IAEvExP,KAAKwJ,QAAUxJ,KAAKmL,oBACpB3L,EAAOiQ,IAAIjQ,EAAOkQ,cAAe,4DAC7B1P,KAAKmL,oBAGb,IAAIgF,EAAwBlH,EAAahJ,uBAAuBD,KAAKiO,MAAQ,IAAIrO,MAEjFI,KAAKkL,gBAAgB,GAAKiF,EAAsBrP,YAChDd,KAAKkL,gBAAgB,GAAKiF,EAAsBlP,eAChDjB,KAAKkL,gBAAgB,GAAKxK,KAAKkP,IAAI5P,KAAKwJ,QAASxJ,KAAKmL,oBACtDnL,KAAKkL,gBAAgB,GAAK,EAErBlL,KAAKiL,yBACNjL,KAAKiL,uBAAyBsB,EAAiB4B,oBAEnD,IAAIC,EAAQ7B,EAAiBC,eAAexM,KAAKiL,wBAC5CmD,GAOD5H,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGsJ,cAActJ,EAAG8H,aAAc,EAAGtO,KAAKkL,mBAP1CkD,EAAQ5H,EAAG+H,eACXhC,EAAiBmC,YAAY1O,KAAKiL,uBAAwBmD,EAAqC,EAA9BpO,KAAKkL,gBAAgByD,QACtFnI,EAAG6H,WAAW7H,EAAG8H,aAAcF,GAC/B5H,EAAGoI,WAAWpI,EAAG8H,aAActO,KAAKkL,gBAAiB1E,EAAGuJ,eAM5DjE,EAAGgD,gBAAgBC,sBAAsB,GACzCvI,EAAGwI,oBAAoB,EAAG,EAAGxI,EAAGyI,OAAO,EAAO,EAAG,GAEjDxB,EAAQ0B,aAAa3I,EAAIiH,EAAQzG,mBAEf8E,EAAGS,iBAAiBC,eAAexM,KAAK+J,kBAC9CkG,KAAKnE,GAEjBtF,EAAG4I,WAAW5I,EAAG6I,OAAQ,EAAG,wCAInBvD,GACT,IAAItF,EAAKsF,EAAGe,iBACZrG,EAAG2G,WAAU,GACb3G,EAAG4J,yBAAyB,2CAK5B,IAAIpQ,KAAKyK,aAAT,CAIAzK,KAAKyK,cAAe,EACpB,IAAI4F,EAAOrQ,KACPsQ,EAAM,IAAIC,eAEdD,EAAIE,OAAS,WACT,GAAIxQ,KAAKyQ,QAAU,KAAOzQ,KAAKyQ,OAAS,IACpC,IACIJ,EAAKlG,UAAYuG,KAAKC,MAAM3Q,KAAK4Q,UACjCP,EAAKQ,oBAET,MAAO1M,GACH3E,EAAOiQ,IAAIjQ,EAAOM,aAAc,qDAC5BqE,EAAE2M,iBAIVtR,EAAOiQ,IAAIjQ,EAAOM,aAAc,qDAC5BE,KAAKyQ,OAAS,IAAMzQ,KAAK+Q,YAEjCV,EAAK5F,cAAe,GAGxB6F,EAAIU,QAAU,WACVxR,EAAOiQ,IAAIjQ,EAAOM,aAAc,4CAChCuQ,EAAK5F,cAAe,GAGxB6F,EAAIW,UAAY,WACZzR,EAAOiQ,IAAIjQ,EAAOM,aAAc,8CAChCuQ,EAAK5F,cAAe,GAGxB6F,EAAIY,KAAK,MAAOlR,KAAK2J,iBAAiB,GACtC2G,EAAIa,sDAKJ,IAAIC,EAAUpR,KAAKqR,mBAAmBrR,KAAKmK,UAAUmH,UAErD,IAAyB,IAArBF,EAAQG,QACR,MAAM,IAAIC,MACNhS,EAAOK,WAAWL,EAAOM,aAAc,iBAAkB,sBACrD,mCAEZ,IAA0B,IAAtBsR,EAAQK,SACR,MAAM,IAAID,MACNhS,EAAOK,WAAWL,EAAOM,aAAc,iBAAkB,sBACrD,oCAEZ,IAA0B,IAAtBsR,EAAQM,SACR,MAAM,IAAIF,MACNhS,EAAOK,WAAWL,EAAOM,aAAc,iBAAkB,sBACrD,qCAGZ,IAAI6R,EAAO3R,KAAKmK,UAAUwH,KACtBnD,EAAY,GAEhBxO,KAAKoK,cAAgBC,OAAOC,UAC5BtK,KAAKuK,cAAgBF,OAAOG,UAE5B,IAAK,IAAIxG,EAAI,EAAG4N,EAAMD,EAAKhD,OAAQ3K,EAAI4N,EAAK5N,IAAK,CAC7C,IAAI6N,EAAWF,EAAK3N,GAChBlD,EAAc+Q,EAAST,EAAQK,UAC/BxQ,EAAiB4Q,EAAST,EAAQG,SAClCO,EAAYD,EAAST,EAAQM,UAC7BK,EAAYD,EAAY,EAAI,EAAI,EACpCtD,EAAUwD,KAAKlR,EAAaG,EAAgB8Q,EAAWD,GAEvD9R,KAAKoK,cAAgB1J,KAAKkP,IAAI5P,KAAKoK,cAAe0H,GAClD9R,KAAKuK,cAAgB7J,KAAKuR,IAAIjS,KAAKuK,cAAeuH,GAItD,OAFA9R,KAAKkK,UAAYxJ,KAAKwR,MAAM1D,EAAUG,OAAS,GAExCH,6CAIQ8C,GAIf,IAHA,IAAIC,GAAW,EACXE,GAAY,EACZC,GAAY,EACP1N,EAAI,EAAG4N,EAAMN,EAAS3C,OAAQ3K,EAAI4N,EAAK5N,IAAK,CACjD,IAAImO,EAAeb,EAAStN,GACF,OAAtBmO,EAAaC,OACbb,EAAUvN,GAEY,QAAtBmO,EAAaC,OACbX,EAAWzN,GAEW,SAAtBmO,EAAaC,OACbV,EAAW1N,GAGnB,MAAO,CACHuN,QAASA,EACTE,SAAUA,EACVC,SAAUA,gDAMd1R,KAAKmK,UAAY,KACjBnK,KAAKiK,2BAA6B,iDAKlC,IAAI9F,EAAIkO,SAASC,YAAY,SAC7BnO,EAAEoO,UAAUnJ,GAAmB,GAAM,GACrCoJ,OAAOC,cAActO,0CAhcrB,OAAOnE,KAAK2J,8BAGG+I,GACf1S,KAAK2J,gBAAkB+I,EACvB1S,KAAK2S,4DASL,OAAO3S,KAAK8J,8BAGG4I,GACf1S,KAAK8J,gBAAkB4I,0CASvB,OAAO1S,KAAK+J,+BAGI2I,GAChB1S,KAAK+J,iBAAmB2I,SA/KHvJ,GCzCvByJ,EAAetT,IAAUsT,aAC3BC,EAAiBvT,IAAUuT,eCA3BC,GDCexT,IAAUyT,aEDNzT,IAAUuT,eDG7BvT,IAHAwT,cACAzM,EAEA/G,IAFA+G,OA2KW2M,cA7JX,SAAAA,EAAYC,EAAOC,EAAWC,GAAU,IAAA1M,EAAAC,OAAAC,EAAA,EAAAD,CAAA1G,KAAAgT,IACpCvM,EAAAC,OAAAE,EAAA,EAAAF,CAAA1G,KAAA0G,OAAAG,EAAA,EAAAH,CAAAsM,GAAAlM,KAAA9G,QAEKoT,WAAaF,EAClB,IAAMG,EAAiB5M,EAAKkK,MAAMsC,GAJE,OAKpCxM,EAAK6M,KAAKH,EAAUE,GALgB5M,wEAY/B0M,GACLnT,KAAKuT,OAAOJ,SAAWA,+BAQtBA,EAAUK,GACX,IADsBC,EAgBlBzT,KAAKoT,WANLM,EAVkBD,EAUlBC,UACAC,EAXkBF,EAWlBE,aACAC,EAZkBH,EAYlBG,aACAC,EAbkBJ,EAalBI,MACAC,EAdkBL,EAclBK,UACAC,EAfkBN,EAelBM,sBAGEd,EAAQ,IAAIH,EAAaK,EAAUK,GACzCP,EAAMe,KAAOhU,KAAKgU,KAClBf,EAAMgB,aAAeH,EAErBb,EAAMiB,YArBc,CAChB,wBAAyB,0BAA2B,qBACpD,yBAA0B,2BAA4B,sBAEtD,kBAAmB,oBAAqB,WAAY,WAAY,iBAEhE,2BAA4B,WAAY,YAAa,YAAa,cAgBtEjB,EAAMkB,WAAY,EAClBlB,EAAMmB,iBAAkB,EACxBnB,EAAMoB,gBAAkBN,EACxBd,EAAMY,MAAQA,EACdZ,EAAMqB,UAAYZ,EAAUa,EAC5BtB,EAAMuB,UAAYd,EAAUe,EAC5BxB,EAAMyB,UAAYhB,EAAUiB,EAC5B1B,EAAM2B,aAAejB,EAAaY,EAClCtB,EAAM4B,aAAelB,EAAac,EAClCxB,EAAM6B,aAAenB,EAAagB,EAClC1B,EAAM8B,KAAOnB,EAAaW,EAC1BtB,EAAM+B,KAAOpB,EAAaa,EAC1BxB,EAAMgC,KAAOrB,EAAae,EAE1B3U,KAAKuT,OAASN,EACdO,EAAY,mCAQV0B,GACF,IAAMC,EAASD,EAASC,OAClBC,EAAQF,EAASG,KAAKC,SACtBC,EAAYL,EAASK,UAE3B,IAAK,IAAIvM,KAAOmM,EACZ,GAAIA,EAAOK,eAAexM,GAGtB,IAFA,IAAMyM,EAAUN,EAAOnM,GAAKyM,QAEnBzR,EAAI,EAAGA,EAAIyR,EAAQ9G,OAAQ3K,IAAK,CACrC,IAAM0R,EAAWD,EAAQzR,GAAG0R,UAAY,GAClCC,EAAUF,EAAQzR,GAAG2R,SAAW,GAChCC,EAAMH,EAAQzR,GAAG4R,KAAO,GACxBC,EAAUJ,EAAQzR,GAAG6R,SAAW,GAEhCC,EAAY,IAAI9K,aAAa0K,GAC7BK,EAAW,IAAI/K,aAAa2K,GAC5BK,EAAO,IAAIhL,aAAa4K,GACxBK,EAAW,IAAIC,YAAYL,GAEjCJ,EAAQzR,GAAG0R,SAAWI,EACtBL,EAAQzR,GAAG2R,QAAUI,EACrBN,EAAQzR,GAAG4R,IAAMI,EACjBP,EAAQzR,GAAG6R,QAAUI,EAKjC,IAAK,IAAIjS,EAAI,EAAGA,EAAIoR,EAAMzG,OAAQ3K,IAAK,CACnC,IAAMmS,EAAOf,EAAMpR,GACnB,GAAImS,EAAKC,KAAM,CACX,IAAMC,EAAcF,EAAKE,YAAYC,MAAM,GAC3CH,EAAKE,YAAchQ,EAAO8B,eAC1BgO,EAAKE,YAAY/N,KAAK+N,GAElBF,EAAKb,SAAS3G,QACd4H,QAAQC,KAAK,oBAAqBL,IAK9C,IAAK,IAAInN,KAAOuM,EACZ,GAAIA,EAAUC,eAAexM,GAAM,CAC/B,IAAMyN,EAAWlB,EAAUvM,GAEP,0BAAhByN,EAAStT,GACLsT,EAASC,aACTD,EAASC,WAAW,GAAK,QACzBD,EAASC,WAAW,GAAK,QACzBD,EAASC,WAAW,GAAK,QACzBD,EAASC,WAAW,GAAK,GAEN,8BAAhBD,EAAStT,GAChBsT,EAASE,QAAQ,GAAK,EACC,0BAAhBF,EAAStT,GAChBsT,EAASE,QAAQ,GAAK,EACC,oBAAhBF,EAAStT,IAChBsT,EAASG,SAAW,KACpBH,EAASE,QAAQ,GAAK,MACtBF,EAASE,QAAQ,GAAK,MACtBF,EAASE,QAAQ,GAAK,OACC,6BAAhBF,EAAStT,GAChBsT,EAASG,SAASF,WAAWG,MAAQ,SACd,iBAAhBJ,EAAStT,GAChBsT,EAASG,SAASF,WAAWG,MAAQ,SACd,0BAAhBJ,EAAStT,GAChBsT,EAASG,SAASF,WAAWG,MAAQ,SACd,8BAAhBJ,EAAStT,GAChBsT,EAASG,SAASF,WAAWG,MAAQ,SACd,0BAAhBJ,EAAStT,KAChBsT,EAASG,SAASF,WAAWG,MAAQ,UAKjD,OAAO3B,iCAMJpJ,GACC9L,KAAKuT,QAAWvT,KAAK8W,SAIzB9W,KAAKuT,OAAOwD,OAAOjL,UArKvBxM,IADA0X,YEqBAC,EAEA3X,IAFA2X,SAIEC,EAAc,IAAIC,EAFpB7X,IADA6X,iBAGoC,SACxCC,MAAM,4BAA4BC,KAAK,SAAAzG,GACnC,OAAOA,EAAS0G,SACjBD,KAAK,SAAAE,GACJL,EAAYM,cAAc,IAAIC,EAAeF,EAAe,CACxD7D,UAAW,CACPa,EAAG,EACHE,EAAG,EACHE,EAAG,EACH+C,YAAa,CAAC,EAAG,EAAG,GACpBC,YAAa,GACbC,gBAAiB,GAErBhE,aAAc,CACVW,EAAG,EACHE,EAAG,EACHE,EAAG,GAEPd,MAAO,IACPF,aAAc,CACVY,GAAI,GACJE,GAAI,GACJE,EAAG,GAEPZ,uBAAuB,GACxB,IAAIkD,EAAS,GAAI,GAAI,SAEbC,QCnBDW,EAAS,SAAAxT,GAA2D,IAAxDlB,EAAwDkB,EAAxDlB,GAAI2U,EAAoDzT,EAApDyT,KAAMC,EAA8C1T,EAA9C0T,KAAMC,EAAwC3T,EAAxC2T,IAAKC,EAAmC5T,EAAnC4T,UAAWC,EAAwB7T,EAAxB6T,WAAYC,EAAY9T,EAAZ8T,MAClE5B,QAAQ9G,IAAI,kBAGZ,IAAM2I,EAAMC,iBAAO,MAJ2DC,GAKpDD,iBAAO,MACXA,iBAAO,MAEOE,mBAAS,OARiCC,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAQ3DI,GAR2DF,EAAA,GAAAA,EAAA,IAAAG,EAUxDJ,mBAAS,IAV+CK,EAAAlS,OAAA+R,EAAA,EAAA/R,CAAAiS,EAAA,GAAAE,GAAAD,EAAA,GAAAA,EAAA,GAWtDL,mBAASL,IAX6CY,EAAApS,OAAA+R,EAAA,EAAA/R,CAAAmS,EAAA,GAWvEE,EAXuED,EAAA,GAWjEE,EAXiEF,EAAA,GAAAG,EAYpCV,mBAAS,IAZ2BW,EAAAxS,OAAA+R,EAAA,EAAA/R,CAAAuS,EAAA,GAYvEE,EAZuED,EAAA,GAYxDE,EAZwDF,EAAA,GAAAG,EAahCd,mBAAS,IAbuBe,EAAA5S,OAAA+R,EAAA,EAAA/R,CAAA2S,EAAA,GAAAE,GAAAD,EAAA,GAAAA,EAAA,GAe9Cf,sBAf8CiB,EAAA9S,OAAA+R,EAAA,EAAA/R,CAAA6S,EAAA,GAe7DE,GAf6DD,EAAA,GAAAA,EAAA,IAAAE,EAgBxDnB,qBAhBwDoB,EAAAjT,OAAA+R,EAAA,EAAA/R,CAAAgT,EAAA,GAiBxEE,GAjBwED,EAAA,GAAAA,EAAA,GAiB7DtB,oBACXwB,EAAWxB,mBACXyB,EAAazB,mBAnB2D0B,EAoB1CxB,qBApB0CyB,EAAAtT,OAAA+R,EAAA,EAAA/R,CAAAqT,EAAA,GAoBvEE,EApBuED,EAAA,GAoB3DE,EApB2DF,EAAA,GA4N9E,SAASG,EAAgBC,GAErB7D,QAAQ9G,IAAI2K,EAAWC,eAAejC,EAAIkC,QAAQC,cAClDhE,QAAQ9G,IAAInQ,IAAUkb,OAAOC,aAO7B,IAAIC,EAAc,CACdC,QAAS,2CAGTC,WAAY,4BAGZC,MAAO,YACPC,UAAW,GACXC,OAAQ,YACRxP,KAAM,IACNyP,OAAQZ,EAAWC,eAAejC,EAAIkC,QAAQC,aAAa,GAG3DU,eAAgB,IAAI3b,IAAU4b,SAAS,GAAI,KAc3CC,EAAW,IAAI7b,IAAU8b,SAASV,EAAaN,EAAWiB,eAAe1b,MAC7EyY,EAAIkC,QAAQgB,SAASH,GACrB/C,EAAIkC,QAAQiB,SACZhF,QAAQ9G,IAAI2I,EAAIkC,QAAQkB,QAG5B,SAASC,EAAerJ,GACpB,IAAK,IAAIpO,EAAI,EAAGA,EAAIoU,EAAIkC,QAAQkB,OAAO7M,OAAQ3K,IAE3C,GAAIoU,EAAIkC,QAAQkB,OAAOxX,GAAG0X,cAAgBtJ,EAAM,OAAOgG,EAAIkC,QAAQkB,OAAOxX,GAE9E,OAAO,KA7QmE,SAgR/D2X,EAhR+DC,GAAA,OAAAC,EAAAC,MAAA9b,KAAA+b,WAAA,SAAAF,IAAA,OAAAA,EAAAnV,OAAAsV,EAAA,EAAAtV,CAAAuV,EAAA/X,EAAAgY,KAgR9E,SAAAC,EAAiClO,GAAjC,IAAAjK,EAAAoY,EAAAhC,EAAAiC,EAAAC,EAAA,OAAAL,EAAA/X,EAAAqY,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAEI,IADiB,MACR1Y,EAAI,EAAGA,EAAIoU,EAAIkC,QAAQkB,OAAO7M,OAAQ3K,IAAK,CAChD,GAAIoU,EAAIkC,QAAQkB,OAAOxX,GAAG0X,YAAYiB,SAAS,aAE3C,IAASP,EAAI,EAAGA,EAAIhE,EAAIkC,QAAQkB,OAAOxX,GAAG4Y,YAAYjO,OAAQyN,IACtDhC,EAAahC,EAAIkC,QAAQkB,OAAOxX,GAAG4Y,YAAYR,GACvC,GAARnO,GACIoO,EAAuB,IAAIzc,KAAKwa,EAAWiB,eAAewB,iBAAiBC,uBAAuB,GAAGC,qBAAqBC,sBAAuBC,UACjJX,EAAsB,IAAI1c,KAAKwa,EAAWiB,eAAewB,iBAAiBC,uBAAuB,GAAGC,qBAAqBG,qBAAsBD,UACnJ7C,EAAWtD,QAAWuF,GAAuBpO,EAAKkP,MAAgBb,GAAsBrO,EAAKkP,MAE7F/C,EAAWtD,SAAU,EAI7BsB,EAAIkC,QAAQkB,OAAOxX,GAAG0X,YAhBlC,wBAAAc,EAAAY,SAAAjB,OAhR8EL,MAAA9b,KAAA+b,WA4Y5E,IA2BIsB,EAAiB,WAEVjF,EAAIkC,QAAQgD,UAAUC,eAAehc,UACrC6W,EAAIkC,QAAQgD,UAAUC,eAAe9b,SAD9C,IAEI+b,EAAKpF,EAAIkC,QAAQgD,UAAUG,MAM/BvD,EAAesD,GAAM,IAAM,cAAc,YAUvCE,EAAe,SAACC,GAElB,IAAIpJ,EAAIoJ,EAAWC,QACfnJ,EAAIkJ,EAAWE,QAGfC,EAAW1F,EAAIkC,QAAQyD,KAAK3F,EAAIkC,QAAQ0D,kBAAkBzJ,EAAGE,IAEjE,GADA8B,QAAQ9G,IAAIqO,GACRA,EAASG,gBAAb,CAGI7F,EAAIkC,QAAQ4D,YAAYzC,EAAe,cAEvC,IAAK,IAAIzX,EAAI,EAAGA,EAAIoU,EAAIkC,QAAQkB,OAAO7M,OAAQ3K,IAC3C,GAAIoU,EAAIkC,QAAQkB,OAAOxX,GAAG0X,YAAYiB,SAAS,aAC3C,IAAK,IAAIP,EAAI,EAAGA,EAAIhE,EAAIkC,QAAQkB,OAAOxX,GAAG4Y,YAAYjO,OAAQyN,IAAK,CAC9ChE,EAAIkC,QAAQkB,OAAOxX,GAAG4Y,YAAYR,GACxC+B,aAAc,EAOrC,IADA,IAAIC,EAAc,GACTpa,EAAI,EAAGA,EAAI8Z,EAASO,QAAQ1P,OAAQ3K,IACrC8Z,EAASO,QAAQra,GAAGsa,sBAAsBhf,IAAUyT,eACpDqL,EAAYpM,KAAK8L,EAASO,QAAQra,GAAGsa,YACrCR,EAASO,QAAQra,GAAGsa,WAAWH,aAAeL,EAASO,QAAQra,GAAGsa,WAAWH,YAE7EhE,EAAgB2D,EAASO,QAAQra,GAAGsa,aAG5C/H,QAAQ9G,IAAI2O,GACZ3E,EAAY,SAAC8E,GAAe,OAAO7X,OAAA8X,EAAA,EAAA9X,CAAA,GAAI6X,EAAX,CAAqBH,YAAaA,MAC9DhG,EAAIkC,QAAQiB,cAEZhF,QAAQ9G,IAAI,kBAOdgP,EAAqB,SAACd,GACxBpH,QAAQ9G,IAAI,gBACZ,IAII0D,EAJAoB,EAAIoJ,EAAWC,QACfnJ,EAAIkJ,EAAWE,QACfC,EAAW1F,EAAIkC,QAAQyD,KAAK3F,EAAIkC,QAAQ0D,kBAAkBzJ,EAAGE,IAMjE,GAAIqJ,EAASG,gBAAiB,CAI1B,IAAIS,EAAQ,UAHZvL,EAAW2K,EAASG,gBAAgB9K,UAGN5R,UAAU,IAAI4R,EAAS1R,SAAS,IAE9DgY,EAAY,SAAC8E,GAAe,OAAO7X,OAAA8X,EAAA,EAAA9X,CAAA,GAAI6X,EAAX,CAAqBI,IAAKD,WAGpDnI,QAAQ9G,IAAI,iBACZgK,EAAY,SAAC8E,GAAe,OAAO7X,OAAA8X,EAAA,EAAA9X,CAAA,GAAI6X,EAAX,CAAqBI,IAAK,QAyJlE,OAxIEC,0BAAgB,WACZrI,QAAQ9G,IAAI,yBAGZ,IAAIoP,EAAiB,IAAIvf,IAAUwf,eACnCD,EAAeE,YAAY,IAAIzf,IAAU0f,uBAAuB,CAC5DC,eAAgB3f,IAAUkb,OAAOC,YACjCyE,WAAY,iBACZC,qBAAsB,kBACtBC,cAAe,KACfC,aAAc,KACdC,WAAY,IAAIhgB,IAAUigB,kBAAkB,wCAAyC,SAAU,YAEnGnH,EAAIkC,QAAU,IAAIhb,IAAUkgB,YAAYrc,EAAI0b,GAK5CjF,EAASU,QAAU,IAAIhb,IAAUmgB,kBAAkBrH,EAAIkC,SACvDT,EAASS,QAAU,IAAIhb,IAAUogB,cAActH,EAAIkC,SAOnDlC,EAAIkC,QAAQqF,gBAAgB3N,KAAKqL,GAejC,IAAIuC,EAAkB,IAAItgB,IAAUugB,gBAAgBzH,EAAIkC,QAASoD,GACjEkC,EAAgBE,eAAiB,EACjC,IAAIC,EAAwB,IAAIzgB,IAAUugB,gBAAgBzH,EAAIkC,QAASmE,GACvEsB,EAAsBD,eAAiB,EACvCC,EAAsBC,4BAA4BJ,GAClDG,EAAsBE,iBAAmB,IAEzC,IAAIC,EAAgB,IAAI5gB,IAAU6gB,cAAc/H,EAAIkC,QAASoD,GAC7DwC,EAAcE,aAAe,EAC7B,IAAIC,EAAsB,IAAI/gB,IAAU6gB,cAAc/H,EAAIkC,QAASmE,GACnE4B,EAAoBD,aAAe,EACnCC,EAAoBL,4BAA4BE,GAChDG,EAAoBC,eAAiB,IAKrC,IAAIC,EAAiB,CACjB5F,QAAS,gCACTC,WAAY,mBACZC,MAAO,mBACPC,UAAW,GACXC,OAAQ,YACRxP,KAAM,IACNyP,OAAQ1b,IAAUkb,OAAOC,YACzBQ,eAAgB,IAAI3b,IAAU4b,SAAS,GAAI,KAE3CsF,EAAsB,CACtB7F,QAAS,gCACTC,WAAY,UACZC,MAAO,UACPC,UAAW,GACXC,OAAQ,YACRxP,KAAM,IACNyP,OAAQ1b,IAAUkb,OAAOC,YACzBQ,eAAgB,IAAI3b,IAAU4b,SAAS,GAAI,KAG3CuF,EAAiB,CACjB9F,QAAS,gCACTC,WAAY,iBACZC,MAAO,iBACPC,UAAW,GACXC,OAAQ,YACRxP,KAAM,IACNyP,OAAQ1b,IAAUkb,OAAOC,YACzBQ,eAAgB,IAAI3b,IAAU4b,SAAS,GAAI,KAG/C5b,IAAUsK,cAAcC,QAAUvK,IAAUsK,cAAcC,QAAQyM,MAAM,GAAG,GAsB3E,IAlBA,IAAIoK,EAAiB,IAAIrX,EACrBsX,EAAkB,IAAIrhB,IAAUshB,gBAAgB,qCAKhDC,EAAiB,IAAIvhB,IAAU6X,gBAAgB,cAE/CqE,EAAS,CACT,CAAEsF,MAAO,IAAIxhB,IAAU8b,SAASmF,EAAgB,IAAKzJ,SAAS,GAC9D,CAAEgK,MAAO,IAAIxhB,IAAU8b,SAASoF,EAAqB,IAAK1J,SAAS,GACnE,CAAEgK,MAAO,IAAIxhB,IAAU8b,SAASqF,EAAgB,IAAK3J,QAASqB,GAC9D,CAAE2I,MAAOJ,EAAgB5J,QAASmB,GAClC,CAAE6I,MAAOH,EAAiB7J,QAASiC,GACnC,CAAE+H,MAAOD,EAAgB/J,SAAS,GAClC,CAAEgK,MAAO5J,EAAaJ,SAAS,IAG1BiK,EAAI,EAAGA,EAAIvF,EAAO7M,OAAQoS,IAC/BvF,EAAOuF,GAAGD,MAAMhK,QAAU0E,EAAOuF,GAAGjK,QACpCsB,EAAIkC,QAAQgB,SAASE,EAAOuF,GAAGD,OAGnCJ,EAAezS,KAAO,IAAIrO,KAC1B+gB,EAAgB1S,KAAO,IAAIrO,KAC3BohB,WAAW,WACP5I,EAAIkC,QAAQ2G,aAAaC,WAAa,IACtC9I,EAAIkC,QAAQ6G,KAAK,IAAI7hB,IAAU2X,SAASc,EAAMD,EAAME,IACpDI,EAAIkC,QAAQiB,UACT,KAEPnD,EAAIkC,QAAQiB,SACZnD,EAAIkC,QAAQ8G,aAAc,GAE3B,IAEHC,oBAAU,WACN9K,QAAQ9G,IAAI,6BACTwK,GAnQa,SAACnR,GACjB,IAAMwY,EAAkB,SAACC,EAAYC,GACjCA,EAASrO,SAAS1R,SAAW8f,EAAWpO,SAAS1R,SACjD+f,EAASrO,SAAS5R,UAAYggB,EAAWpO,SAAS5R,UAClDigB,EAASC,QAAUF,EAAWE,QAC9BD,EAASE,KAAOH,EAAWG,KAC3BF,EAASG,KAAOJ,EAAWI,KAC3BH,EAAS/D,MAAQ8D,EAAW9D,OAIjB,gBAAT3U,GAA0BsP,EAAIkC,QAAQgD,UAAUsE,kBAAkBtiB,IAAUogB,eAC9E5F,EAAWQ,QAAUlC,EAAIkC,QAAQgD,UAAUsE,OAAOF,KAClDJ,EAAgBlJ,EAAIkC,QAAQgD,UAAUsE,OAAQhI,EAASU,SACvDlC,EAAIkC,QAAQgD,UAAUsE,OAAShI,EAASU,QACxClC,EAAIkC,QAAQgD,UAAUsE,OAAOF,KAAO,GAExB,YAAT5Y,GAAsBsP,EAAIkC,QAAQgD,UAAUsE,kBAAkBtiB,IAAUmgB,oBAC3E6B,EAAgBlJ,EAAIkC,QAAQgD,UAAUsE,OAAQ/H,EAASS,SACvDT,EAASS,QAAQoH,KAAO5H,EAAWQ,QACnClC,EAAIkC,QAAQgD,UAAUsE,OAAS/H,EAASS,SA+O7BuH,CAAU5H,IAC1B,CAACA,IAGC,CAAE6H,cArcP,WACI,IAAI,IAAI9d,EAAE,EAAEA,EAAEmV,EAAcxK,OAAO3K,IACjCoU,EAAIkC,QAAQ4D,YAAY/E,EAAcnV,IAIxCoV,EAAiB,SAACD,GAAD,MAAiB,KAElCf,EAAIkC,QAAQiB,UA6bMwG,WAzgBH,SAACzW,EAAI0W,GAyDpB,IAAIC,EAAkB,IAAI3iB,IAAU6X,gBAAgB,aAAa7L,EAAI4W,WAAWC,QAAQzhB,KAAK0hB,KAAqB,IAAhB1hB,KAAK2hB,WAEvGjK,EAAIkC,QAAQgB,SAAS2G,GAIP,IAAI3iB,IAAUgjB,cAAchX,GAClCiX,KAfR,WACIhM,QAAQ9G,IAAIwS,GACZ7I,EAAiB,SAACD,GAAD,SAAAqJ,OAAA9b,OAAA+b,EAAA,EAAA/b,CAAqByS,GAArB,CAAmC8I,MACpDtG,EAAkBqG,GAClB5J,EAAIkC,QAAQiB,UAjDhB,SAAoCmH,EAAUR,GAC1C,IAAItY,EAAgB,GACpBA,EAAcyR,eAAiB6G,EAE/B,IAAIS,EAAsB,IAAIrjB,IAAUsjB,oBAAoB,MAqC5D,OApCAD,EAAoBE,WAAa,GACjCF,EAAoBG,WAAa,IAAIxjB,IAAUgH,MAAM,EAAG,EAAG,EAAG,IAC9Dqc,EAAoBI,gBAAgBC,OAAS,IAAI1jB,IAAU2jB,OACvD3jB,IAAU4jB,gBAAiB,EAC3B5jB,IAAU4jB,gBAAiB,GAI3BR,EAASS,eAAiBT,EAASU,mBACnCxZ,EAAcyZ,WAAa,IAAI/jB,IAAUsjB,oBAAoBD,GAEtDD,EAASY,oBAAsBZ,EAASa,yBAC/C3Z,EAAcyZ,WAAWG,aAAc,EACvC5Z,EAAcyZ,WAAWI,aAAe,IAAInkB,IAAUgH,MAClD,GAAMsD,EAAcyZ,WAAWK,cAAcC,IAC7C,GAAM/Z,EAAcyZ,WAAWK,cAAcE,MAC7C,GAAMha,EAAcyZ,WAAWK,cAAcG,KAC7C,GAEJja,EAAcyZ,WAAWS,aAAe,IACjCpB,EAASqB,iBAAmBrB,EAASsB,wBAC5Cpa,EAAcyZ,WAAa,IAAI/jB,IAAU2kB,gBAAgB,MACzDra,EAAcyZ,WAAWK,cAAgB,IAAIpkB,IAAUgH,MAAM,EAAG,EAAG,EAAG,IACtEsD,EAAcyZ,WAAWI,aAAe,IAAInkB,IAAUgH,MAAM,EAAG,EAAG,EAAG,IAErEsD,EAAcsa,oBAAsB,IAAI5kB,IAAU2kB,gBAAgBra,EAAcyZ,YAChFzZ,EAAcsa,oBAAoBT,aAAe,IAAInkB,IAAUgH,MAAM,EAAG,EAAG,EAAG,IAC9EsD,EAAcsa,oBAAoBR,cAAgB,IAAIpkB,IAAUgH,MAAM,EAAG,EAAG,EAAG,IAS5EsD,GAmBoDqY,IAycjCkC,OA1blC,aA0b0CC,aA7kB1C,SAAsBC,GAClB9N,QAAQ9G,IAAI,mBACZgM,EAAe,aAAa3E,QAAUuN,EACtCjM,EAAIkC,QAAQiB,UA0kBwC+I,cA7lBxD,SAAuBD,GACnB9N,QAAQ9G,IAAI,oBACZgM,EAAe,cAAc3E,QAAUuN,EACvCrL,EAAQqL,GACRjM,EAAIkC,QAAQiB,UAylBuDgJ,QAjTvE,SAAiBvC,GACbvG,EAAe,aAAaxN,KAAOwN,EAAe,cAAcxN,KAAO,IAAIrO,KAAKoiB,GAChFrG,EAAkBqG,GAGlB5J,EAAIkC,QAAQiB,UA4SgEiJ,iBAtShF,WACI9L,EAAe,SAAA+L,GACblO,QAAQ9G,IAAI,mBAAmBgV,GAC/B,IAAIC,EAAuB,CAAE,KAAM,kBAAmB,YAClDC,GAAWD,EAAqBE,QAAQH,GAAY,GAAGC,EAAqB/V,OAEhF,OADA4H,QAAQ9G,IAAI,kBAAkBiV,EAAqBC,IAC3CD,EAAqBC,IAC3B,IAAK,KACDvM,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAUwlB,gBAC7C,MACJ,IAAK,kBACD1M,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAUylB,0BAC7C,MACJ,IAAK,WACD3M,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAU0lB,mBAC7C,MACJ,IAAK,cACD5M,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAU2lB,2BAA2B,SACxE,MACJ,IAAK,cACD7M,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAU2lB,2BAA2B,SACxE,MACJ,QACA7M,EAAIkC,QAAQvO,MAAM8Y,WAAa,IAAIvlB,IAAUwlB,gBAG/C,OADA1M,EAAIkC,QAAQiB,SACLmJ,EAAqBC,MA4QgEO,SAtkBlG,SAAkBb,GACd9N,QAAQ9G,IAAI,eACZgM,EAAe,kBAAkB3E,QAAUuN,EAC3CjM,EAAIkC,QAAQiB,UAmkB4F4J,YAplB5G,WACI5O,QAAQ9G,IAAI,eACZgM,EAAe,SAAS3E,SAAW2E,EAAe,SAAS3E,QAC3DsB,EAAIkC,QAAQiB,UAilByG6J,SAhkBzH,WACI7O,QAAQ9G,IAAI,iBACZgM,EAAe,WAAW3E,SAAW2E,EAAe,WAAW3E,QAC/D2E,EAAe,oBAAoB3E,SAAW2E,EAAe,oBAAoB3E,QACjFsB,EAAIkC,QAAQiB,UA4jBmH8J,QA5nBnI,WACI,IAAMC,EAAMlN,EAAIkC,QACZiL,EAAmB,EACnB7kB,KAAK+D,IAAI6gB,EAAIhI,UAAUmE,SAAW,GAClC8D,EAAmB,EACZ7kB,KAAK+D,IAAI6Y,UAAUmE,SAAW,MACrC8D,EAAmB,GAEnBD,EAAIhI,UAAUmE,QAAU,IACxB8D,GAAoBA,GAYxBvE,WATmB,SAAfwE,IACI9kB,KAAK+D,IAAI6gB,EAAIhI,UAAUmE,SAAW/gB,KAAK+D,IAAI8gB,IAC3CD,EAAIhI,UAAUmE,SAAW8D,EACzBvE,WAAWwE,EAAc,KAEzBF,EAAIhI,UAAUmE,QAAU,EAE5B6D,EAAI/J,UAEiB,cCTlBkK,GA/DD,SAAAphB,GAAsE,IAAnEqhB,EAAmErhB,EAAnEqhB,SAAUviB,EAAyDkB,EAAzDlB,GAAI4U,EAAqD1T,EAArD0T,KAAMD,EAA+CzT,EAA/CyT,KAAME,EAAyC3T,EAAzC2T,IAAKC,EAAoC5T,EAApC4T,UAAWC,EAAyB7T,EAAzB6T,WAAYC,EAAa9T,EAAb8T,MACvE5B,QAAQ9G,IAAI,gBADwE,IAAAkW,EAgB5E9N,EAAO,CACP1U,GAAIA,EACJ4U,KAAMA,EACND,KAAMA,EACNE,IAAKA,EACLC,UAAWA,EACXC,WAAYA,EACZC,MAAOA,IAjBP2J,GAN4E6D,EAI5EpH,SAJ4EoH,EAK5E5D,WAL4E4D,EAM5E7D,eAEA0C,GAR4EmB,EAO5ExB,OAP4EwB,EAQ5EnB,kBACAF,EAT4EqB,EAS5ErB,cACAF,EAV4EuB,EAU5EvB,aACAc,EAX4ES,EAW5ET,SACAE,EAZ4EO,EAY5EP,SACAD,EAb4EQ,EAa5ER,YACAZ,EAd4EoB,EAc5EpB,QACAc,EAf4EM,EAe5EN,QAWJO,YAAW,IAAIpB,GACfoB,YAAW,IAAI9D,GACf8D,YAAW,IAAIP,GACfO,YAAW,IAAIR,GACfQ,YAAW,IAAIT,GAEf9D,oBAAU,WACNkD,EAAQmB,EAASzI,YACnB,CAACyI,EAAUnB,IAEblD,oBAAU,WACN+C,EAAanM,IACf,CAACA,IAEHoJ,oBAAU,WACN6D,EAAS/M,IACX,CAACA,IAEHkJ,oBAAU,WACNiD,EAAcpM,IAChB,CAACA,IAYH,OACQ2N,EAAA3hB,EAAA4hB,cAAA,UAAQ3iB,GAAIA,EAAI4iB,MATP,CACbC,WAAY,UACZ7S,SAAU,QACV8S,KAAM,EACNC,MAAO,OACPC,OAAQ,mCCfDC,OAvCf,SAAsBC,GAAO,IAAA/N,EAEDC,oBAAS,GAFRC,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAElBpH,EAFkBsH,EAAA,GAEZ8N,EAFY9N,EAAA,GAAA+N,EAIJC,aAAU,iBAAM,CAAEC,IAAM,OAJpBC,EAAAhgB,OAAA+R,EAAA,EAAA/R,CAAA6f,EAAA,GAIhBE,EAJgBC,EAAA,GAIhBD,GAAKE,EAJWD,EAAA,GAKnBzW,EAAO2W,aAAY,CACrBC,OAAQ,SAAAxiB,GAA2B,IAAxByiB,EAAwBziB,EAAxByiB,KAAMC,EAAkB1iB,EAAlB0iB,MAAOC,EAAW3iB,EAAX2iB,KACpBzQ,QAAQ9G,IAAIsX,EAAM,IACfC,EAAK,GAAG,IAAOF,GAAQC,EAAM,GAAK,KACjCJ,EAAI,CACAF,IAAK,MAETH,GAAS,KAETK,EAAI,CACAF,GAAIK,GAAMpmB,KAAKuR,IAAI8U,EAAM,GAAG,GAAG,IAEnCT,GAAS,OAMrB,OAEIT,EAAA3hB,EAAA4hB,cAACmB,GAAA,EAASC,IAAVxgB,OAAAygB,OAAA,GAAkBlX,IAAlB,CAA0B8V,MAAO,CAAEqB,MAAOX,EAAIY,IAAI,GAAKC,UAAU,iBAC7DzB,EAAA3hB,EAAA4hB,cAAA,WACID,EAAA3hB,EAAA4hB,cAAA,OAAK3iB,GAAG,OAAMmkB,UAAU,OAAOC,IAAI,wBAAwBvP,IAAI,GAAGwP,QAAS,kBAAyBb,EAApBzV,EAAwB,CAACuV,GAAG,GAAnB,CAACA,IAAI,UAGjGJ,EAAM/Q,qCCdJmS,OAvBf,SAAApjB,GAAgD,IAA5B1E,EAA4B0E,EAA5B1E,KAAM+nB,EAAsBrjB,EAAtBqjB,UAAWC,EAAWtjB,EAAXsjB,SAGjC,OACI9B,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,kBACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,QACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,QAAZI,GAAiC,SAAZA,EAAmB,WAAW,uBAAyB1e,IAAI,OAAS4e,KAAWjoB,EAAK,WACzHkmB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,aACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,UAAZI,GAAmC,SAAZA,EAAmB,cAAc,0BAA4B1e,IAAI,SAAU4e,KAAWjoB,EAAK,WAAWkoB,eAC7IhC,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,SAAZI,GAAkC,SAAZA,EAAmB,aAAa,wBAA0B1e,IAAI,QAASrJ,EAAKgC,oBAG1HkkB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAWK,EAAS,oBAAoB,OAAQ3e,IAAI,SACzD6c,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,aACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,SAAZI,GAAkC,SAAZA,EAAmB,aAAa,wBAAyB1e,IAAI,QAAS4e,KAAWjoB,EAAK,UAA5H,KACAkmB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,iBAAf,KACAzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,gBAAf,KACAzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,WAAZI,GAAoC,SAAZA,EAAmB,eAAe,0BAA2B1e,IAAI,UAAW4e,KAAWjoB,EAAK,WACpIkmB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAuB,WAAZI,GAAoC,SAAZA,EAAmB,eAAe,0BAA2B1e,IAAI,UAAW4e,KAAWjoB,EAAK,6BCyJrImoB,OA5Kf,SAAAzjB,GAA+C,IAAnB1E,EAAmB0E,EAAnB1E,KAAMooB,EAAa1jB,EAAb0jB,WAExBlU,EAAQwE,mBAoKd,OACIwN,EAAA3hB,EAAA4hB,cAAA,OAAKkC,IAAKnU,EAAOyT,UAAU,qBAnKb,SAACW,EAAQC,GAEvB,GAAIrU,EAAMyG,QAAV,CA6BA,IA3BA,IAmBIxY,EAAKF,EAAOumB,EAAMzmB,EAnBhB0mB,EAAY,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAmBzDC,EAAS,EACjCC,EAAS,EACTC,EAAY,EACZC,EAAW,EACXC,EAAW,EACXC,EAAa,EACbC,EAAO,GAED3kB,EAAE,EAAIA,EAAI6P,EAAMyG,QAAQsO,aAAe5kB,GAAG,EAAI,CACpD,IAAI6kB,EAAU,IAAIjpB,MAAOoE,EAAG6P,EAAMyG,QAAQsO,aAAa,GAAKV,EAAQD,EAAOhL,WAO3E,OANAnb,EAAM+mB,EAAQ9mB,aACdH,EAAQinB,EAAQhnB,cAChBsmB,EAAOU,EAAQ5mB,cACfP,EAAOmnB,EAAQlnB,iBACf0mB,EAASQ,EAAQ3mB,iBAET,GACJ,KAAKgmB,EA5BK,IA6BHG,IAAWK,IACK,IAAXL,GAAyB,IAATF,EAChBQ,EAAK3W,KAAK,CAAC8W,MAAM,UAAWC,IAAK/kB,EAAGglB,MAAOC,EAAId,EAAK,GAAG,IAAIc,EAAIZ,EAAO,KAEvD,IAAXA,GAAyB,IAATF,IAChBQ,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOlnB,IAC5C6mB,EAAK3W,KAAK,CAAC8W,MAAM,cAAeC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,OAKzE,MAEA,KAAKsmB,EA3CO,IA4CLG,IAAWK,IACM,IAAXL,GAAuB,GAAPF,GAAaE,EAAS,KAAO,EAG/B,IAAXA,GAAyB,IAATF,IAChBQ,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOlnB,IAC5C6mB,EAAK3W,KAAK,CAAC8W,MAAM,cAAeC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,MAJ7D+mB,EAAK3W,KAAK,CAAC8W,MAAM,UAAWC,IAAK/kB,EAAGglB,MAAOC,EAAId,EAAK,GAAG,IAAIc,EAAIZ,EAAO,MASlF,MAEA,KAAKH,EA1DM,KA2DJC,IAASM,IACK,IAATN,EACAQ,EAAK3W,KAAK,CAAC8W,MAAM,UAAWC,IAAK/kB,EAAGglB,MAAOC,EAAId,EAAK,GAAG,SAGvDQ,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOlnB,IAC5C6mB,EAAK3W,KAAK,CAAC8W,MAAM,cAAeC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,OAIrE,MAEA,KAAKsmB,EAxEO,KAyELC,IAASM,IACK,IAATN,GAAgBA,EAAO,IAAM,EAC7BQ,EAAK3W,KAAK,CAAC8W,MAAM,UAAWC,IAAK/kB,EAAGglB,MAAOC,EAAId,EAAK,GAAG,QAE1C,IAATA,IACAQ,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOlnB,IAC5C6mB,EAAK3W,KAAK,CAAC8W,MAAM,cAAeC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,OAKzE,MAEA,KAAKsmB,EAvFK,KAwFHpmB,IAAQwmB,IACM,IAARxmB,EACD6mB,EAAK3W,KAAK,CAAC8W,MAAM,SAAUC,IAAK/kB,EAAGglB,MAAOlnB,KAE1C6mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,KAC1C,IAAVA,GAAa+mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOtnB,MAK3E,MAEA,KAAKwmB,EArGM,MAsGJpmB,IAAQwmB,IACM,IAARxmB,GAAqB,KAARA,GAAcA,EAAM,IAAM,EACxC6mB,EAAK3W,KAAK,CAAC8W,MAAM,SAAUC,IAAK/kB,EAAGglB,MAAOlnB,IAE/B,GAAPA,IAEA6mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,KAC1C,IAAVA,GAAa+mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOtnB,MAO/E,MAEA,KAAKwmB,EAvHO,OAwHJtmB,IAAU2mB,IACI,IAAV3mB,EACA+mB,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,MAEtD+mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,KACxD+mB,EAAK3W,KAAK,CAAC8W,MAAM,aAAcC,IAAK/kB,EAAGglB,MAAOtnB,MAI1D,MAEA,KAAKwmB,EApIM,OAqIJxmB,IAAS8mB,IACM,IAAV5mB,EACA+mB,EAAK3W,KAAK,CAAC8W,MAAM,WAAYC,IAAK/kB,EAAGglB,MAAOZ,EAAUxmB,KAGtD+mB,EAAK3W,KAAK,CAAC8W,MAAM,UAAWC,IAAK/kB,EAAGglB,MAAOtnB,KAS3D4mB,EAAUxmB,EACV0mB,EAAW9mB,EACX6mB,EAAY3mB,EACZ6mB,EAAWN,EACXO,EAAaL,EAGjB,OAAOM,EAAKO,IAAI,SAAAC,GAAI,OAAMtD,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAW6B,EAAKL,MAAO9f,IAAKmgB,EAAKL,MAAMK,EAAKJ,IAAKhD,MAAO,CAACsB,IAAI8B,EAAKJ,MAAOI,EAAKH,SAjJ7G,SAASC,EAAIG,EAAQza,GAEjB,IADA,IAAI0a,EAAM,GAAKD,EACRC,EAAI1a,OAASA,GAChB0a,EAAM,IAAMA,EAEhB,OAAOA,GAiJLC,CAAU3pB,EAAKooB,KC+GdwB,OAjRf,SAAAllB,GAA6G,IAAtFmlB,EAAsFnlB,EAAtFmlB,UAAsCC,GAAgDplB,EAA3EqlB,UAA2ErlB,EAAhEslB,eAAgEtlB,EAAhDolB,cAAcG,EAAkCvlB,EAAlCulB,kBAAmBC,EAAexlB,EAAfwlB,aAMpFC,EAAWzR,mBACX0R,EAAW1R,mBACb0R,EAASzP,UAASyP,EAASzP,QAJf,MAJyF,IAAAhC,EAWtEC,mBAASiR,GAX6DhR,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAWlG0R,EAXkGxR,EAAA,GAWvFyR,EAXuFzR,EAAA,GAAAG,EAe7DJ,mBAASiR,GAfoD5Q,EAAAlS,OAAA+R,EAAA,EAAA/R,CAAAiS,EAAA,GAelGuR,EAfkGtR,EAAA,GAenFuR,EAfmFvR,EAAA,GAAAC,EAiB5EN,oBAAS,GAjBmEO,EAAApS,OAAA+R,EAAA,EAAA/R,CAAAmS,EAAA,GAiBlGuR,EAjBkGtR,EAAA,GAiB1FuR,EAjB0FvR,EAAA,GAAAG,EAkBhFV,mBAAS,KAlBuEW,EAAAxS,OAAA+R,EAAA,EAAA/R,CAAAuS,EAAA,GAkBlGqR,EAlBkGpR,EAAA,GAkB5FqR,EAlB4FrR,EAAA,GAAAG,EAmBtEd,mBAAS,QAnB6De,EAAA5S,OAAA+R,EAAA,EAAA/R,CAAA2S,EAAA,GAmBlGmR,EAnBkGlR,EAAA,GAmBvFmR,EAnBuFnR,EAAA,GAAAC,EAsBpEhB,mBAlBrB,MAJyFiB,EAAA9S,OAAA+R,EAAA,EAAA/R,CAAA6S,EAAA,GAsBlGwO,EAtBkGvO,EAAA,GAsBtFkR,EAtBsFlR,EAAA,GAuBpGuQ,EAASzP,UAASyP,EAASzP,QAnBhB,MAsBhB,IAAMqQ,EAAUtS,mBACVuS,EAAYvS,mBA3BuFkO,EAyCrEC,aAAU,iBAAO,CAAEqE,WAAY,CAAC,EAAE,MAzCmCnE,EAAAhgB,OAAA+R,EAAA,EAAA/R,CAAA6f,EAAA,GAyChGsE,EAzCgGnE,EAAA,GAyChGmE,WAAaC,EAzCmFpE,EAAA,GAAAqE,EA0CzEvE,aAAU,iBAAO,CAAEwE,IAAK,CAAC,EAAE,MA1C8CC,EAAAvkB,OAAA+R,EAAA,EAAA/R,CAAAqkB,EAAA,GA0ChGC,EA1CgGC,EAAA,GA0ChGD,IAAOE,EA1CyFD,EAAA,GA0ClFE,EA1CkFF,EAAA,GAAAG,EA2C5D5E,aAAU,iBAAO,CAAC6E,YAAa,CAAC,EAAE,MA3C0BC,EAAA5kB,OAAA+R,EAAA,EAAA/R,CAAA0kB,EAAA,GA2ChGC,EA3CgGC,EAAA,GA2ChGD,YAAeE,EA3CiFD,EAAA,GA2CpElO,EA3CoEkO,EAAA,GAgDnGrb,EAAO2W,aAAW,CAEpB4E,UAAW,WACHzB,EAASzP,QAAUyN,GAG3B0D,QAAS,SAAAtlB,GAGHA,EAHM4gB,MAGN,IAME2E,EATWC,EAGbxlB,EAHawlB,SAAUC,EAGvBzlB,EAHuBylB,SAAUC,EAGjC1lB,EAHiC0lB,MAAQC,EAGzC3lB,EAHyC2lB,UAAWhF,EAGpD3gB,EAHoD2gB,KAAMiF,EAG1D5lB,EAH0D4lB,KAG1DC,GAAA7lB,EAHgE8lB,SAGhE9lB,EAH0E+lB,aAG1E,IAAAF,EAHiF,CACnFG,UAAWd,EAAYe,YAErBJ,EAOF,OANIH,IACAzO,IACAiN,GAAU,GACVF,EAAkBH,IAGjB4B,IACDF,EAAO3D,EAAaA,EAAa,EAAI+D,EAAU,IA9D3C,MA+DgBJ,EA/DhB,KAgEAA,EAjEA,SAiEgBA,EAjEhB,QAkEJhB,EAAcgB,GACV5E,GAAMuD,GAAU,GACb6B,IAIXX,EAAY,CAGRF,YAAYM,EAEZU,WAAW,EAGXC,QAAS,WACD,IAAIC,EAAS7rB,KAAK0hB,KAAKiJ,EAAYe,WAAW,GAAKrE,EAAcuC,GACnD,GAAViC,GAAeZ,EAAS,IAAM,IAAGY,GAAU,GACjC,GAAVA,GAAeZ,EAAS,IAAM,IAAGY,EAAS,GAE9C,IAAIC,EAAKtC,EAAcjN,UAAYsP,EAASjC,EACxCmC,EAAU,IAAI7sB,KAAK4sB,GACvBvC,EAAawC,GACbhD,EAAagD,IAIrBC,OAAQ,WACJ,IAAIH,EAAS7rB,KAAK0hB,KAAKiJ,EAAYe,WAAW,GAAKrE,EAAcuC,GACnD,GAAViC,GAAeZ,EAAS,IAAM,IAAGY,GAAU,GACjC,GAAVA,GAAeZ,EAAS,IAAM,IAAGY,EAAS,GAE9C,IAAIC,EAAKtC,EAAcjN,UAAYsP,EAASjC,EACxCmC,EAAU,IAAI7sB,KAAK4sB,GAEvBvC,EAAawC,GACbhD,EAAagD,GACb7C,EAAkB6C,GAClBtC,EAAkBsC,GACfV,IACCV,EAAYsB,SAAS,CAAC,EAAE,IACxBtC,GAAU,OAIf6B,IAIXrF,OAAQ,SAAA+F,GAA4EA,EAAxEC,MAAwE,IAE5EnB,EAFWG,EAAiEe,EAAjEf,MAAOC,EAA0Dc,EAA1Dd,UAAUhF,EAAgD8F,EAAhD9F,KAAM6E,EAA0CiB,EAA1CjB,SAAU5E,EAAgC6F,EAAhC7F,MAAO+F,EAAyBF,EAAzBE,SAAUlB,EAAegB,EAAfhB,SAWjE,GAPIC,IACAtV,QAAQ9G,IAAI,aAAamc,GACzBvB,GAAU,GA5FE,WACpB,IAAM0C,EAAMntB,KAAKmtB,MACbpC,EAAQrQ,SAAYyS,EAAMpC,EAAQrQ,QAAW,IAC7CsQ,EAAUtQ,SAAU,GAEpBqQ,EAAQrQ,QAAUyS,EAClBnC,EAAUtQ,SAAU,GAuFhB0S,GACA7C,EAAkBH,IAGlBY,EAAUtQ,SAAWsR,EAQrB,OANAF,EAAO3D,EAAaA,EAAa,GAAOhB,EAAM,IA9H1C,MA+HgB2E,EA/HhB,KAgIAA,EAjIA,SAiIgBA,EAjIhB,QAkIJhB,EAAcgB,QAEV5E,GAAMuD,GAAU,IAIxByC,EAAYpsB,KAAK+D,IAAIqoB,GAAU,GAAI,EAAEA,EAErChC,EAAW,CACPD,WAAYc,EACZU,UAAWvF,EACXmG,OAAQ,CAAEH,SAAUjZ,iBAAMiY,EAAWgB,GAAWI,OAAO,GACvDZ,QAAS,WAEL,IAAKT,EAAO,CACR,IAAIW,EAAKtC,EAAcjN,UAAYvc,KAAK0hB,KAAKyI,EAAWuB,WAAW,GAAKrE,EAAcuC,GAAQA,EAC1FmC,EAAU,IAAI7sB,KAAK4sB,GACvBvC,EAAawC,GACbhD,EAAagD,KAKrBC,OAAQ,WACJ,IAAK5F,EAAM,CACP,IAAI0F,EAAKtC,EAAcjN,UAAYvc,KAAK0hB,KAAKyI,EAAWuB,WAAW,GAAKrE,EAAcuC,GAAQA,EAC1FmC,EAAU,IAAI7sB,KAAK4sB,GACvBvC,EAAawC,GACbhD,EAAagD,GAEb7C,EAAkB6C,GAClBtC,EAAkBsC,GAClBpC,GAAU,SAQ9B,IAqFA,OA/CAhJ,oBAAU,WACF+I,IACA7T,QAAQ9G,IAAI,gCAAgC+Z,EAAU2D,UAhC3C,SAAC3D,GAEhB,IAAKY,EAAQ,CACT,IAAIgD,EAAc,CAAC,GAAGlD,EAAcjN,UAAYuM,EAAUvM,WAAc8K,GAGxEoD,IACAD,EAAM,CACFF,IAAKoC,EACLf,WAAW,EACXY,OAAQ,CAACI,OAAO,GAChBf,QAAS,WACL,IAAIG,EAAU,IAAI7sB,KAAKsqB,EAAcjN,UAAY+N,EAAIoB,WAAW,GAAKrE,GACrEkC,EAAawC,GACbhD,EAAagD,IAEjBC,OAAQ,WACH,IAAID,EAAU,IAAI7sB,KAAKsqB,EAAcjN,UAAY+N,EAAIoB,WAAW,GAAKrE,GACtEiD,EAAI2B,SAAS,CAAC,EAAE,IAChB1C,EAAawC,GACbhD,EAAagD,GACbtC,EAAkBsC,GAClB7C,EAAkB6C,OAW1Ba,CAAW9D,KAEjB,CAACA,IAMHnI,oBAAU,WACN9K,QAAQ9G,IAAI,oBAAoB2a,IAClC,CAACA,IAGH/I,oBAAU,WACNwI,EAAaW,IACf,CAACA,IAEHnJ,oBAAU,WACN,QAAQ,GACJ,KAAK0G,EAAa,UACdwC,EAAQ,QACRE,EAAa,SACb,MACJ,KAAK1C,EAAa,SACdwC,EAAQ,OACRE,EAAa,OACb,MACJ,KAAK1C,EAAa,OACdwC,EAAQ,MACRE,EAAa,QACb,MACJ,KAAK1C,EAAa,MACdwC,EAAQ,KACRE,EAAa,UACb,MACJ,QACIF,EAAQ,KACRE,EAAa,YAEvB,CAAC1C,IAMClC,EAAA3hB,EAAA4hB,cAAA,MAAApf,OAAAygB,OAAA,GAASlX,IAAT,CAAiBqX,UAAU,eAAeU,IAAK8B,IAC3CjE,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,QAEXzB,EAAA3hB,EAAA4hB,cAACyH,GAAD,CAAmBjG,UAAU,QAAQ3nB,KAAMqqB,EAAWjC,WAAYA,EAAYuC,KAAMA,IAEpFzE,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,qBACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKK,OAAO,KAAKD,MAAM,KAAKoB,UAAU,YAClCzB,EAAA3hB,EAAA4hB,cAAA,WAAS0H,OAAO,0BC7OzBC,OAhCf,SAAAppB,GAA6E,IAAvDmlB,EAAuDnlB,EAAvDmlB,UAAWC,EAA4CplB,EAA5ColB,aAAcG,EAA8BvlB,EAA9BulB,kBAAmBjC,EAAWtjB,EAAXsjB,SAAWrP,EAGtBC,mBAAS,GAHaC,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAGlEoV,EAHkElV,EAAA,GAG/CmV,EAH+CnV,EAAA,GAAAG,EAIjCJ,mBAASiR,GAJwB5Q,EAAAlS,OAAA+R,EAAA,EAAA/R,CAAAiS,EAAA,GAIlEiV,EAJkEhV,EAAA,GAIpDiV,EAJoDjV,EAAA,GAsBzE,OACIiN,EAAA3hB,EAAA4hB,cAAA,WACED,EAAA3hB,EAAA4hB,cAACgI,GAAD,CAAWnuB,KAAMiuB,EAAejG,SAAUA,EAAUD,UAAWgG,IAC/D7H,EAAA3hB,EAAA4hB,cAACiI,GAAD,CAAcvE,UAAWA,EACnBC,aApBqB,SAAC9pB,GAC9BkuB,EAAgBluB,GAChB8pB,EAAa9pB,IAmBLiqB,kBAhB0B,SAACjqB,GAEnCiqB,EAAkBjqB,IAeVkqB,aAAc8D,MCbfK,OAff,WAAwB,IAAAC,EAEYC,oBAAU,YAFtBC,EAAAznB,OAAA+R,EAAA,EAAA/R,CAAAunB,EAAA,GAEHG,GAFGD,EAAA,GAAAA,EAAA,IAAAE,EAGgBH,oBAAU,cAH1BI,EAAA5nB,OAAA+R,EAAA,EAAA/R,CAAA2nB,EAAA,GAGDE,GAHCD,EAAA,GAAAA,EAAA,IAAAE,EAIcN,oBAAU,aAJxBO,EAAA/nB,OAAA+R,EAAA,EAAA/R,CAAA8nB,EAAA,GAIbE,EAJaD,EAAA,GAAAE,GAAAF,EAAA,GAKEP,oBAAU,cAAzBxE,EALahjB,OAAA+R,EAAA,EAAA/R,CAAAioB,EAAA,MAAAC,EAMOV,oBAAU,kBAA9BvE,EANajjB,OAAA+R,EAAA,EAAA/R,CAAAkoB,EAAA,MAAAC,EAO2BX,oBAAU,mBAPrCY,EAAApoB,OAAA+R,EAAA,EAAA/R,CAAAmoB,EAAA,GAObE,EAPaD,EAAA,GAUpB,OAVoBA,EAAA,GAWhBE,EAAA9qB,EAAA4hB,cAACmJ,GAAD,CAAazF,UAAWuF,EAAiBrF,UAAWA,EAAWC,eAAgBA,EAAgBF,aAAc2E,EAAaxE,kBAAmB2E,EAAe5G,SAAU+G,KCbvK,SAASQ,GAAT7qB,GAAqDA,EAAvB8qB,UAAuB,IAAZC,EAAY/qB,EAAZ+qB,SAAY9W,EAKhCC,mBAAS6W,GALuB5W,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAKjD3Y,EALiD6Y,EAAA,GAK3C6W,EAL2C7W,EAAA,GASlD8W,EAAUjX,mBAEVkX,EAAclX,mBAEpBkX,EAAYjV,QAAU,IAEtB,IAAMgQ,EAAOjS,mBACTiS,EAAKhQ,UAASgQ,EAAKhQ,QAAUiV,EAAYjV,SAE7C,IAAMkV,EAAQnX,mBACVmX,EAAMlV,UAASkV,EAAMlV,QAAU8U,EAASnS,WAG5C,IAAMwS,EAAcpX,mBAwCpB,SAASqR,IACL8F,EAAMlV,SAAWgQ,EAAKhQ,QAKtB+U,EAAQ,IAAIzvB,KAAK4vB,EAAMlV,UAsB3B,SAAS8C,IACL7G,QAAQ9G,IAAI,cACRggB,EAAYnV,SAASoV,cAAcD,EAAYnV,SACnDgV,EAAQhV,SAAU,EAwCxB,OAtBE+G,oBAAU,WACN9K,QAAQ9G,IAAI,gCAAgC2f,EAASjC,UAChDmC,EAAQhV,UACT/D,QAAQ9G,IAAI,YACZ+f,EAAMlV,QAAU8U,EAASnS,YAE9B,CAACmS,IAgBC,CAAEzvB,OAAM2vB,UAASK,YA/EtB,SAAqBhwB,GACb2vB,EAAQhV,QACR8C,KAiBJ7G,QAAQ9G,IAAI,eAEZ6f,EAAQhV,SAAU,EAClBmV,EAAYnV,QAAUsV,YAClBlG,EAMA6F,EAAYjV,WAkDe+S,MApCnC,WACIjQ,IACAoS,EAAMlV,SAAU,IAAI1a,MAAOqd,UAC3BoS,EAAQ,IAAIzvB,KAAK4vB,EAAMlV,WAiCgBuV,cA9F3C,WAEIvF,EAAKhQ,QAAWgQ,EAAKhQ,QAAU,EAAIgQ,EAAKhQ,SAAW,EAAEgQ,EAAKhQ,SAAW,EAClE5Z,KAAK+D,IAAI6lB,EAAKhQ,SAAWiV,EAAYjV,UAASgQ,EAAKhQ,QAAUiV,EAAYjV,SAC5E/D,QAAQ9G,IAAI,SAAS6a,EAAKhQ,UA0F4BwV,cAtF1D,WACIxF,EAAKhQ,QAAWgQ,EAAKhQ,QAAU,EAAIgQ,EAAKhQ,SAAW,EAAEgQ,EAAKhQ,SAAW,EAClE5Z,KAAK+D,IAAI6lB,EAAKhQ,SAAWiV,EAAYjV,UAASgQ,EAAKhQ,SAAW,EAAIiV,EAAYjV,SACjF/D,QAAQ9G,IAAI,SAAS6a,EAAKhQ,UAmF2CyV,UA5BzE,SAAmBtD,GACflW,QAAQ9G,IAAI,uBAAuBgd,EAAQU,UAC3CqC,EAAMlV,QAAUmS,EAAQxP,UACxBoS,EAAQ,IAAIzvB,KAAK4vB,EAAMlV,kBChDhB0V,OAxDf,SAAA3rB,GAAmD,IAAzB+qB,EAAyB/qB,EAAzB+qB,SAAU3F,EAAeplB,EAAfolB,aAAenR,EAEPC,mBAAS6W,GAFF5W,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAExC2X,EAFwCzX,EAAA,GAAA0X,GAAA1X,EAAA,GAa3C0W,GAAmB,CACnBE,SAAUa,KARVtwB,EAN2CuwB,EAM3CvwB,KACA2vB,EAP2CY,EAO3CZ,QACAK,EAR2CO,EAQ3CP,YACAtC,EAT2C6C,EAS3C7C,MACAwC,EAV2CK,EAU3CL,cACAC,EAX2CI,EAW3CJ,cAX2CI,EAY3CH,UAOJnK,YAAW,IAAI+J,GACf/J,YAAW,IAAIyH,GAEfzH,YAAW,IAAIiK,GACfjK,YAAW,IAAIkK,GAKfzO,oBAAU,WACH1hB,IACC4W,QAAQ9G,IAAI,iCAAiC9P,EAAKwtB,UAClD1D,EAAa9pB,KAEnB,CAACA,EAAM2vB,IAOT,IAAM3E,EAAUtS,mBAYhB,OACIwN,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,iBAAiBE,QAZhB,WAChB,IAAMuF,EAAMntB,KAAKmtB,MACbpC,EAAQrQ,SAAYyS,EAAMpC,EAAQrQ,QAAW,IAC/C+S,IAEE1C,EAAQrQ,QAAUyS,MCvBfoD,OAzBf,WAA2B,IAAAlC,EAESC,oBAAU,YAFnBC,EAAAznB,OAAA+R,EAAA,EAAA/R,CAAAunB,EAAA,GAAAI,GAAAF,EAAA,GAAAA,EAAA,GAGuBD,oBAAU,oBAHjCI,EAAA5nB,OAAA+R,EAAA,EAAA/R,CAAA2nB,EAAA,GAGC+B,GAHD9B,EAAA,GAAAA,EAAA,IAAAE,EAIaN,oBAAU,cAJvBO,EAAA/nB,OAAA+R,EAAA,EAAA/R,CAAA8nB,EAAA,GAIhB6B,EAJgB5B,EAAA,GAAAE,GAAAF,EAAA,GAKWP,oBAAU,cALrBoC,EAAA5pB,OAAA+R,EAAA,EAAA/R,CAAAioB,EAAA,GAAArW,GAAAgY,EAAA,GAAAA,EAAA,GAO6B/X,mBAAS8X,IAPtC7X,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAOhBiY,EAPgB/X,EAAA,GAOIgY,EAPJhY,EAAA,GAoBvB,OAXA6I,oBAAU,WACN9K,QAAQ9G,IAAI,qBAAqB4gB,EAAWlD,UAC5CqD,EAAsBH,IACxB,CAACA,IASCrB,EAAA9qB,EAAA4hB,cAAC2K,GAAD,CAAgBrB,SAAUmB,EAAoB9G,aAPf,SAAC9pB,GAChCywB,EAAmBzwB,aCkBZ+wB,OA9Bf,SAAArsB,GAA4D,IAAlCssB,EAAkCtsB,EAAlCssB,eAAgBC,EAAkBvsB,EAAlBusB,gBAAkBtY,EAG1BC,mBAASoY,GAHiBnY,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAGjDuY,EAHiDrY,EAAA,GAGxCsY,EAHwCtY,EAAA,GAkBxD,OAbAoN,YAAW,IAAI,WAAKkL,EAAW,QAC/BlL,YAAW,IAAI,WAAKkL,EAAW,QAC/BlL,YAAW,IAAI,WAAKkL,EAAW,QAC/BlL,YAAW,IAAI,WAAKkL,EAAW,SAC/BlL,YAAW,IAAI,WAAKkL,EAAW,aAE/BzP,oBAAU,WACN9K,QAAQ9G,IAAI,uBAAwBohB,GACpCD,EAAgBC,IACjB,CAACA,EAASD,IAKT/K,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,mBACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAASzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,cAAcC,IAAI,wBAAwBvP,IAAI,GAAGwP,QAAS,kBAAMsJ,EAAW,UAClHjL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAASzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,cAAcC,IAAI,wBAAwBvP,IAAI,GAAGwP,QAAS,kBAAMsJ,EAAW,UAClHjL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAASzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,cAAcC,IAAI,wBAAwBvP,IAAI,GAAGwP,QAAS,kBAAMsJ,EAAW,UAClHjL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAASzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,cAAcC,IAAI,yBAAyBvP,IAAI,GAAGwP,QAAS,kBAAMsJ,EAAW,aClBhHC,OATf,WAA4B,IAAA9C,EAEMC,oBAAU,WAFhBC,EAAAznB,OAAA+R,EAAA,EAAA/R,CAAAunB,EAAA,GAEjB4C,EAFiB1C,EAAA,GAER2C,EAFQ3C,EAAA,GAIxB,OACIa,EAAA9qB,EAAA4hB,cAACkL,GAAD,CAAiBL,eAAgBE,EAASD,gBAAiBE,WC4BpDG,OA7Bf,SAAA5sB,GAA4C,IAAtB6sB,EAAsB7sB,EAAtB6sB,oBAAsB5Y,EAGFC,mBAAS,CAACN,WAAW,EAAME,OAAO,EAAMD,YAAY,IAHlDM,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAGjC6Y,EAHiC3Y,EAAA,GAGpB4Y,EAHoB5Y,EAAA,GAIlC6Y,EAAmB,kBAAMD,EAAe,SAACD,GAAD,OAAAzqB,OAAA8X,EAAA,EAAA9X,CAAA,GAAoByqB,EAApB,CAAiCjZ,YAAYiZ,EAAYjZ,gBACjGoZ,EAAkB,kBAAMF,EAAe,SAACD,GAAD,OAAAzqB,OAAA8X,EAAA,EAAA9X,CAAA,GAAoByqB,EAApB,CAAiClZ,WAAWkZ,EAAYlZ,eAC/FsZ,EAAc,kBAAMH,EAAe,SAACD,GAAD,OAAAzqB,OAAA8X,EAAA,EAAA9X,CAAA,GAAoByqB,EAApB,CAAiChZ,OAAOgZ,EAAYhZ,WAa7F,OAXAyN,YAAW,IAAIyL,GACfzL,YAAW,IAAI0L,GACf1L,YAAW,IAAI2L,GAEflQ,oBAAU,WACN6P,EAAoBC,IACrB,CAACA,EAAaD,IAMbrL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,eACXzB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,gBAAezB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAAUkK,UAAU,QAAQjK,IAAI,0BAA0BvP,IAAI,GAAGwP,QAAS6J,KACvHxL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,gBAAezB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAAUkK,UAAU,QAAQjK,IAAI,yBAAyBvP,IAAI,GAAGwP,QAAS8J,KACtHzL,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,gBAAezB,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,UAAUkK,UAAU,QAAQjK,IAAI,qBAAqBvP,IAAI,GAAGwP,QAAS+J,OCd/GE,OAbf,WAAwB,IAAAxD,EAMOC,oBAAU,eAA5BkD,EANW1qB,OAAA+R,EAAA,EAAA/R,CAAAunB,EAAA,MAQpB,OACIe,EAAA9qB,EAAA4hB,cAAC4L,GAAD,CAAaR,oBAAqBE,kCCmD3BO,OA7Cf,WAAe,IAAA1D,EAGWC,oBAAU,WAAxB2C,EAHGnqB,OAAA+R,EAAA,EAAA/R,CAAAunB,EAAA,MAAAI,EAIcH,oBAAU,eAA3BiD,EAJGzqB,OAAA+R,EAAA,EAAA/R,CAAA2nB,EAAA,MAAAG,EAKYN,oBAAU,YAAzB0D,EALGlrB,OAAA+R,EAAA,EAAA/R,CAAA8nB,EAAA,MAAAG,EAMcT,oBAAU,cAA3BmC,EANG3pB,OAAA+R,EAAA,EAAA/R,CAAAioB,EAAA,MAiBXtN,oBAAU,WACN9K,QAAQ9G,IAAI,gBAAgB4gB,EAAWlD,WACzC,CAACkD,IAnBQ,IAAA/X,EAqBgBC,oBAAS,GArBzBC,EAAA9R,OAAA+R,EAAA,EAAA/R,CAAA4R,EAAA,GAqBJuZ,EArBIrZ,EAAA,GAqBGsZ,EArBHtZ,EAAA,GAAAuZ,EAsBgCC,aAAcxf,OAAOH,SAAS4f,MAAjEC,EAtBGH,EAsBHG,aAAcC,EAtBXJ,EAsBWI,iBAItB,OAHAvM,YAAW,IAAIuM,GAIXtM,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,OACXzB,EAAA3hB,EAAA4hB,cAACsM,GAAAluB,EAAD,CAAY4S,QAAS+a,EAAQQ,SAAU,WAAYH,GAAcJ,GAAU,KACvEjM,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,SACXzB,EAAA3hB,EAAA4hB,cAACwM,GAAD,CAAO5M,SAAUkM,EAAUzuB,GAAG,QAAQ8U,UAAWkZ,EAAYlZ,UAAWC,WAAYiZ,EAAYjZ,WAAYC,MAAOgZ,EAAYhZ,MAAQL,KAAK,MAAMC,KAAK,QAG3J8N,EAAA3hB,EAAA4hB,cAACyM,GAAD,MACA1M,EAAA3hB,EAAA4hB,cAAC0M,GAAD,MACA3M,EAAA3hB,EAAA4hB,cAAC2M,GAAD,CAAcrI,OAAO,QACrBvE,EAAA3hB,EAAA4hB,cAAC4M,GAAD,MACA7M,EAAA3hB,EAAA4hB,cAAC6M,GAAD,OAEA9M,EAAA3hB,EAAA4hB,cAAA,OAAKwB,UAAU,gBAAgBuJ,MC9C3B+B,QACW,cAA7BpgB,OAAOqgB,SAASC,UAEe,UAA7BtgB,OAAOqgB,SAASC,UAEhBtgB,OAAOqgB,SAASC,SAASC,MACvB,2DCdFxc,QAAQ9G,IAAI,iBAAiB,IAAI7P,MAAQqd,WAazC+V,oBAAU,CACNnC,QAAS,KACTM,YAAa,CACTjZ,YAAY,EACZD,WAAW,EACXE,OAAO,GAEXyZ,SAAU,IAAIhyB,KACdywB,WAAY,IAAIzwB,KAChBqzB,eAAgB,IAAIrzB,KACpBmvB,gBAAiB,IAAInvB,KACrB+pB,eAAgB,EAChBD,WAAW,ICnBnBwJ,IAASnc,OAAO8O,EAAA3hB,EAAA4hB,cAACqN,GAAD,MAAS9gB,SAAS+gB,eAAe,SFuH3C,kBAAmB9V,WACrBA,UAAU+V,cAAcC,MAAMjc,KAAK,SAAAkc,GACjCA,EAAaC","file":"static/js/main.728934f3.chunk.js","sourcesContent":["/*\n * Copyright 2015-2017 WorldWind Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport WorldWind from 'webworldwind-esa';\nconst {\n    Angle,\n    ArgumentError,\n    Logger\n} = WorldWind;\n\n/**\n * Provides utilities for determining the Sun geographic and celestial location.\n * @exports SunPosition\n */\nconst SunPosition = {\n\n    /**\n     * Computes the geographic location of the sun for a given date\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {{latitude: Number, longitude: Number}} the geographic location\n     */\n    getAsGeographicLocation: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"SunPosition\", \"getAsGeographicLocation\",\n                    \"missingDate\"));\n        }\n\n        let celestialLocation = this.getAsCelestialLocation(date);\n        return this.celestialToGeographic(celestialLocation, date);\n    },\n\n    /**\n     * Computes the celestial location of the sun for a given julianDate\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {{declination: Number, rightAscension: Number}} the celestial location\n     */\n    getAsCelestialLocation: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"SunPosition\", \"getAsCelestialLocation\",\n                    \"missingDate\"));\n        }\n\n        let julianDate = this.computeJulianDate(date);\n\n        //number of days (positive or negative) since Greenwich noon, Terrestrial Time, on 1 January 2000 (J2000.0)\n        let numDays = julianDate - 2451545;\n\n        let meanLongitude = this.normalizeAngle360(280.460 + 0.9856474 * numDays);\n\n        let meanAnomaly = this.normalizeAngle360(357.528 + 0.9856003 * numDays) * Angle.DEGREES_TO_RADIANS;\n\n        let eclipticLongitude = meanLongitude + 1.915 * Math.sin(meanAnomaly) + 0.02 * Math.sin(2 * meanAnomaly);\n        let eclipticLongitudeRad = eclipticLongitude * Angle.DEGREES_TO_RADIANS;\n\n        let obliquityOfTheEcliptic = (23.439 - 0.0000004 * numDays) * Angle.DEGREES_TO_RADIANS;\n\n        let declination = Math.asin(Math.sin(obliquityOfTheEcliptic) * Math.sin(eclipticLongitudeRad)) *\n            Angle.RADIANS_TO_DEGREES;\n\n        let rightAscension = Math.atan(Math.cos(obliquityOfTheEcliptic) * Math.tan(eclipticLongitudeRad)) *\n            Angle.RADIANS_TO_DEGREES;\n\n        //compensate for atan result\n        if (eclipticLongitude >= 90 && eclipticLongitude < 270) {\n            rightAscension += 180;\n        }\n        rightAscension = this.normalizeAngle360(rightAscension);\n\n        return {\n            declination: declination,\n            rightAscension: rightAscension\n        };\n    },\n\n    /**\n     * Converts from celestial coordinates (declination and right ascension) to geographic coordinates\n     * (latitude, longitude) for a given julian date\n     * @param {{declination: Number, rightAscension: Number}} celestialLocation\n     * @param {Date} date\n     * @throws {ArgumentError} if celestialLocation or julianDate are missing\n     * @return {{latitude: Number, longitude: Number}} the geographic location\n     */\n    celestialToGeographic: function (celestialLocation, date) {\n        if (!celestialLocation) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"SunPosition\", \"celestialToGeographic\",\n                    \"missingCelestialLocation\"));\n        }\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"SunPosition\", \"celestialToGeographic\", \"missingDate\"));\n        }\n\n        let julianDate = this.computeJulianDate(date);\n\n        //number of days (positive or negative) since Greenwich noon, Terrestrial Time, on 1 January 2000 (J2000.0)\n        let numDays = julianDate - 2451545;\n\n        //Greenwich Mean Sidereal Time\n        let GMST = this.normalizeAngle360(280.46061837 + 360.98564736629 * numDays);\n\n        //Greenwich Hour Angle\n        let GHA = this.normalizeAngle360(GMST - celestialLocation.rightAscension);\n\n        let longitude = Angle.normalizedDegreesLongitude(-GHA);\n\n        return {\n            latitude: celestialLocation.declination,\n            longitude: longitude\n        };\n    },\n\n    /**\n     * Computes the julian date from a javascript date object\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {Number} the julian date\n     */\n    computeJulianDate: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"SunPosition\", \"computeJulianDate\", \"missingDate\"));\n        }\n\n        let year = date.getUTCFullYear();\n        let month = date.getUTCMonth() + 1;\n        let day = date.getUTCDate();\n        let hour = date.getUTCHours();\n        let minute = date.getUTCMinutes();\n        let second = date.getUTCSeconds();\n\n        let dayFraction = (hour + minute / 60 + second / 3600) / 24;\n\n        if (month <= 2) {\n            year -= 1;\n            month += 12;\n        }\n\n        let A = Math.trunc(year / 100);\n        let B = 2 - A + Math.trunc(A / 4);\n        let JD0h = Math.trunc(365.25 * (year + 4716)) + Math.trunc(30.6001 * (month + 1)) + day + B - 1524.5;\n\n        return JD0h + dayFraction;\n    },\n\n    /**\n     * Restricts an angle to the range [0, 360] degrees, wrapping angles outside the range.\n     * Wrapping takes place as though traversing the edge of a unit circle;\n     * angles less than 0 wrap back to 360, while angles greater than 360 wrap back to 0.\n     *\n     * @param {Number} degrees the angle to wrap in degrees\n     *\n     * @return {Number} the specified angle wrapped to [0, 360] degrees\n     */\n    normalizeAngle360: function(degrees) {\n        let angle = degrees % 360;\n        return angle >= 0 ? angle : (angle < 0 ? 360 + angle : 360 - angle);\n    }\n\n};\n\nexport default SunPosition;","import WorldWind from 'webworldwind-esa';\nimport SunPosition from './SunPosition';\nconst {\n    Angle\n} = WorldWind;\n\nconst Celestial = {\n\n    SUN: 0,\n    MERCURY: 1,\n    VENUS: 2,\n    MARS: 4,\n    JUPITER: 5,\n    SATURN: 6,\n    URANUS: 7,\n    NEPTUNE: 8,\n\n    getCelestialLocation(id, date) {\n        let orbitalElements;\n        const julianDate = SunPosition.computeJulianDate(date);\n        let d = julianDate - 2451543.5;\n        //d = -3543.0;\n\n        switch (id) {\n            case this.SUN:\n                orbitalElements = this.computeSun(d);\n                break;\n\n            case this.MERCURY:\n                orbitalElements = this.computeMercury(d);\n                break;\n\n            case this.VENUS:\n                orbitalElements = this.computeVenus(d);\n                break;\n\n            case this.MARS:\n                orbitalElements = this.computeMars(d);\n                break;\n\n            case this.JUPITER:\n                orbitalElements = this.computeJupiter(d);\n                break;\n\n            case this.SATURN:\n                orbitalElements = this.computeSaturn(d);\n                break;\n\n            case this.URANUS:\n                orbitalElements = this.computeUranus(d);\n                break;\n\n            case this.NEPTUNE:\n                orbitalElements = this.computeNeptune(d);\n                break;\n        }\n\n        return this.computePosition(d, orbitalElements);\n    },\n\n    computeMercury(d) {\n        const N = 48.3313 + 3.24587E-5 * d;\n        const i = 7.0047 + 5.00E-8 * d;\n        const w = 29.1241 + 1.01444E-5 * d;\n        const a = 0.387098;  //(AU)\n        const e = 0.205635 + 5.59E-10 * d;\n        const M = 168.6562 + 4.0923344368 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeVenus(d) {\n        const N = 76.6799 + 2.46590E-5 * d;\n        const i = 3.3946 + 2.75E-8 * d;\n        const w = 54.8910 + 1.38374E-5 * d;\n        const a = 0.723330;//  (AU)\n        const e = 0.006773 - 1.302E-9 * d;\n        const M = 48.0052 + 1.6021302244 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeMars(d) {\n        const N = 49.5574 + 2.11081E-5 * d;\n        const i = 1.8497 - 1.78E-8 * d;\n        const w = 286.5016 + 2.92961E-5 * d;\n        const a = 1.523688;  //(AU)\n        const e = 0.093405 + 2.516E-9 * d;\n        const M = 18.6021 + 0.5240207766 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeJupiter(d) {\n        const N = 100.4542 + 2.76854E-5 * d;\n        const i = 1.3030 - 1.557E-7 * d;\n        const w = 273.8777 + 1.64505E-5 * d;\n        const a = 5.20256;  //(AU)\n        const e = 0.048498 + 4.469E-9 * d;\n        const M = 19.8950 + 0.0830853001 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeSaturn(d) {\n        const N = 113.6634 + 2.38980E-5 * d;\n        const i = 2.4886 - 1.081E-7 * d;\n        const w = 339.3939 + 2.97661E-5 * d;\n        const a = 9.55475;  //(AU)\n        const e = 0.055546 - 9.499E-9 * d;\n        const M = 316.9670 + 0.0334442282 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeUranus(d) {\n        const N = 74.0005 + 1.3978E-5 * d;\n        const i = 0.7733 + 1.9E-8 * d;\n        const w = 96.6612 + 3.0565E-5 * d;\n        const a = 19.18171 - 1.55E-8 * d;//  (AU)\n        const e = 0.047318 + 7.45E-9 * d;\n        const M = 142.5905 + 0.011725806 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeNeptune(d) {\n        const N = 131.7806 + 3.0173E-5 * d;\n        const i = 1.7700 - 2.55E-7 * d;\n        const w = 272.8461 - 6.027E-6 * d;\n        const a = 30.05826 + 3.313E-8 * d;//  (AU)\n        const e = 0.008606 + 2.15E-9 * d;\n        const M = 260.2471 + 0.005995147 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computeSun(d) {\n        const N = 0.0;\n        const i = 0.0;\n        const w = 282.9404 + 4.70935E-5 * d;\n        const a = 1.000000;  //(AU)\n        const e = 0.016709 - 1.151E-9 * d;\n        const M = 356.0470 + 0.9856002585 * d;\n\n        return {N, i, w, a, e, M};\n    },\n\n    computePosition(d, {N, i, w, a, e, M}) {\n        N = SunPosition.normalizeAngle360(N) * Angle.DEGREES_TO_RADIANS;\n        i = SunPosition.normalizeAngle360(i) * Angle.DEGREES_TO_RADIANS;\n        w = SunPosition.normalizeAngle360(w) * Angle.DEGREES_TO_RADIANS;\n        //e = SunPosition.normalizeAngle360(e) * Angle.DEGREES_TO_RADIANS;\n        M = SunPosition.normalizeAngle360(M) * Angle.DEGREES_TO_RADIANS;\n\n        let E = M + e * Math.sin(M) * (1.0 + e * Math.cos(M));\n\n        if (e >= 0.06) {\n            for (var aa = 0; aa < 10; aa++) {\n                var E1 = E - (E - e * Math.sin(E) - M) / (1 - e * Math.cos(E));\n                if (Math.abs(E1 - E) < 0.001) {\n                    E = E1;\n                    break;\n                }\n                E = E1;\n            }\n        }\n\n        const xv = a * (Math.cos(E) - e);\n        const yv = a * (Math.sqrt(1.0 - e * e) * Math.sin(E));\n\n        const v = Math.atan2(yv, xv);\n        const r = Math.sqrt(xv * xv + yv * yv);\n\n        let xh = r * (Math.cos(N) * Math.cos(v + w) - Math.sin(N) * Math.sin(v + w) * Math.cos(i));\n        let yh = r * (Math.sin(N) * Math.cos(v + w) + Math.cos(N) * Math.sin(v + w) * Math.cos(i));\n        let zh = r * (Math.sin(v + w) * Math.sin(i));\n\n        const Epoch = 2000.0;\n        const lon_corr = 3.82394E-5 * (365.2422 * (Epoch - 2000.0) - d) * Angle.DEGREES_TO_RADIANS;\n\n        const lonecl = Math.atan2(yh, xh) + lon_corr;\n        const latecl = Math.atan2(zh, Math.sqrt(xh * xh + yh * yh));\n\n\n        /*** perturbations ***/\n        /*** not implemented ***/\n\n\n        xh = r * Math.cos(lonecl) * Math.cos(latecl);\n        yh = r * Math.sin(lonecl) * Math.cos(latecl);\n        zh = r * Math.sin(latecl);\n\n        let {lonsun, rsun} = this.getLonSun(d, this.computeSun(d));\n        lonsun *= Angle.RADIANS_TO_DEGREES;\n        lonsun = SunPosition.normalizeAngle360(lonsun) * Angle.DEGREES_TO_RADIANS;\n\n        const xs = rsun * Math.cos(lonsun);\n        const ys = rsun * Math.sin(lonsun);\n\n        const xg = xh + xs;\n        const yg = yh + ys;\n        const zg = zh;\n\n        const ecl = SunPosition.normalizeAngle360(23.4393 - 3.563E-7 * d) * Angle.DEGREES_TO_RADIANS;\n\n        const xe = xg;\n        const ye = yg * Math.cos(ecl) - zg * Math.sin(ecl);\n        const ze = yg * Math.sin(ecl) + zg * Math.cos(ecl);\n\n        const ra = SunPosition.normalizeAngle360(Math.atan2(ye, xe) * Angle.RADIANS_TO_DEGREES);\n        const dec = Math.atan2(ze, Math.sqrt(xe * xe + ye * ye)) * Angle.RADIANS_TO_DEGREES;\n\n        return {ra, dec};\n    },\n\n    getLonSun(d, {w, e, M}) {\n        w = SunPosition.normalizeAngle360(w) * Angle.DEGREES_TO_RADIANS;\n        //e = SunPosition.normalizeAngle360(e) * Angle.DEGREES_TO_RADIANS;\n        M = SunPosition.normalizeAngle360(M) * Angle.DEGREES_TO_RADIANS;\n\n        const E = M + e * Math.sin(M) * (1.0 + e * Math.cos(M));\n\n        const xv = Math.cos(E) - e;\n        const yv = Math.sqrt(1.0 - e * e) * Math.sin(E);\n\n        const v = Math.atan2(yv, xv);\n        const rsun = Math.sqrt(xv * xv + yv * yv);\n\n        const lonsun = v + w;\n\n        return {lonsun, rsun};\n    },\n\n};\n\nexport default Celestial;","/**\n * @exports StarFieldProgram\n */\nimport WorldWind from 'webworldwind-esa';\n\nconst {\n    ArgumentError,\n    GpuProgram,\n    Logger,\n    Matrix,\n    Color\n} = WorldWind;\n\n/**\n * Constructs a new program.\n * Initializes, compiles and links this GLSL program with the source code for its vertex and fragment shaders.\n * <p>\n * This method creates WebGL shaders for the program's shader sources and attaches them to a new GLSL program.\n * This method then compiles the shaders and then links the program if compilation is successful.\n * Use the bind method to make the program current during rendering.\n *\n * @alias StarFieldProgram\n * @constructor\n * @augments GpuProgram\n * @classdesc StarFieldProgram is a GLSL program that draws points representing stars.\n * @param {WebGLRenderingContext} gl The current WebGL context.\n * @throws {ArgumentError} If the shaders cannot be compiled, or linking of the compiled shaders into a program\n * fails.\n */\nclass StarFieldProgram extends GpuProgram {\n    constructor(gl) {\n        super(gl, 'attribute vec4 vertexPoint;\\n' +\n\n            'uniform mat4 mvpMatrix;\\n' +\n            //number of days (positive or negative) since Greenwich noon, Terrestrial Time,\n            // on 1 January 2000 (J2000.0)\n            'uniform float numDays;\\n' +\n            'uniform vec2 magnitudeRange;\\n' +\n\n            'varying float magnitudeWeight;\\n' +\n\n            //normalizes an angle between 0.0 and 359.0\n            'float normalizeAngle(float angle) {\\n' +\n            '   float angleDivisions = angle / 360.0;\\n' +\n            '   return 360.0 * (angleDivisions - floor(angleDivisions));\\n' +\n            '}\\n' +\n\n            //transforms declination and right ascension in cartesian coordinates\n            'vec3 computePosition(float dec, float ra) {\\n' +\n            '   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\\n' +\n            '   float GHA = normalizeAngle(GMST - ra);\\n' +\n            '   float lon = -GHA + 360.0 * step(180.0, GHA);\\n' +\n            '   float latRad = radians(dec);\\n' +\n            '   float lonRad = radians(lon);\\n' +\n            '   float radCosLat = cos(latRad);\\n' +\n            '   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\\n' +\n            '}\\n' +\n\n            //normalizes a value between 0.0 and 1.0\n            'float normalizeScalar(float value, float minValue, float maxValue){\\n' +\n            '   return (value - minValue) / (maxValue - minValue);\\n' +\n            '}\\n' +\n\n            'void main() {\\n' +\n            '   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\\n' +\n            '   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\\n' +\n            '   gl_Position.z = gl_Position.w - 0.00001;\\n' +\n            '   gl_PointSize = vertexPoint.z;\\n' +\n            '   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\\n' +\n            '}', 'precision mediump float;\\n' +\n\n            'uniform sampler2D textureSampler;\\n' +\n            'uniform int fragMode;\\n' +\n            'uniform vec4 color;\\n' +\n\n            'varying float magnitudeWeight;\\n' +\n\n            'const vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\\n' +\n            'const vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\\n' +\n\n            'void main() {\\n' +\n            '   if (fragMode == 1) {\\n' +\n            '       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\\n' +\n            '   }\\n' +\n            '   else if (fragMode == 0) {\\n' +\n            //paint the starts in shades of grey, where the brightest star is white and the dimmest star is grey\n            '       gl_FragColor = mix(white, grey, magnitudeWeight);\\n' +\n            '   }\\n' +\n            '   else if (fragMode == 2) {\\n' +\n            '       gl_FragColor = color;\\n' +\n            '   }\\n' +\n            '}', [\"vertexPoint\"]);\n\n        this.FRAG_MODE_MIX_COLOR = 0;\n        this.FRAG_MODE_TEXTURE = 1;\n        this.FRAG_MODE_COLOR = 2;\n\n        /**\n         * The WebGL location for this program's 'vertexPoint' attribute.\n         * @type {Number}\n         * @readonly\n         */\n        this.vertexPointLocation = this.attributeLocation(gl, \"vertexPoint\");\n\n        /**\n         * The WebGL location for this program's 'mvpMatrix' uniform.\n         * @type {WebGLUniformLocation}\n         * @readonly\n         */\n        this.mvpMatrixLocation = this.uniformLocation(gl, \"mvpMatrix\");\n\n        /**\n         * The WebGL location for this program's 'numDays' uniform.\n         * @type {WebGLUniformLocation}\n         * @readonly\n         */\n        this.numDaysLocation = this.uniformLocation(gl, \"numDays\");\n\n        /**\n         * The WebGL location for this program's 'magnitudeRangeLocation' uniform.\n         * @type {WebGLUniformLocation}\n         * @readonly\n         */\n        this.magnitudeRangeLocation = this.uniformLocation(gl, \"magnitudeRange\");\n\n        /**\n         * The WebGL location for this program's 'textureSampler' uniform.\n         * @type {WebGLUniformLocation}\n         * @readonly\n         */\n        this.textureUnitLocation = this.uniformLocation(gl, \"textureSampler\");\n\n        /**\n         * The WebGL location for this program's 'textureEnabled' uniform.\n         * @type {WebGLUniformLocation}\n         * @readonly\n         */\n        this.fragModeLocation = this.uniformLocation(gl, \"fragMode\");\n\n        this.colorLocation = this.uniformLocation(gl, \"color\");\n\n        this.localState = {\n            mvpMatrix: null,\n            numDays: null,\n            magnitudeRange: null,\n            textureUnit: null,\n            fragMode: null,\n            color: null,\n        };\n    }\n\n    /**\n     * Loads the specified matrix as the value of this program's 'mvpMatrix' uniform variable.\n     *\n     * @param {WebGLRenderingContext} gl The current WebGL context.\n     * @param {Matrix} matrix The matrix to load.\n     * @throws {ArgumentError} If the specified matrix is null or undefined.\n     */\n    loadModelviewProjection(gl, matrix) {\n        if (!matrix) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"StarFieldProgram\", \"loadModelviewProjection\", \"missingMatrix\"));\n        }\n\n        let forceLoad = false;\n        if (this.localState.mvpMatrix === null) {\n            forceLoad = true;\n            this.localState.mvpMatrix = Matrix.fromIdentity();\n        }\n\n        if (forceLoad || !this.localState.mvpMatrix.equals(matrix)) {\n            this.loadUniformMatrix(gl, matrix, this.mvpMatrixLocation);\n            this.localState.mvpMatrix.copy(matrix);\n        }\n    }\n\n    /**\n     * Loads the specified number as the value of this program's 'numDays' uniform variable.\n     *\n     * @param {WebGLRenderingContext} gl The current WebGL context.\n     * @param {Number} numDays The number of days (positive or negative) since Greenwich noon, Terrestrial Time,\n     * on 1 January 2000 (J2000.0)\n     * @throws {ArgumentError} If the specified number is null or undefined.\n     */\n    loadNumDays(gl, numDays) {\n        if (numDays == null) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"StarFieldProgram\", \"loadNumDays\", \"missingNumDays\"));\n        }\n        if (this.localState.numDays !== numDays) {\n            gl.uniform1f(this.numDaysLocation, numDays);\n            this.localState.numDays = numDays;\n        }\n    }\n\n    /**\n     * Loads the specified numbers as the value of this program's 'magnitudeRange' uniform variable.\n     *\n     * @param {WebGLRenderingContext} gl The current WebGL context.\n     * @param {Number} minMag\n     * @param {Number} maxMag\n     * @throws {ArgumentError} If the specified numbers are null or undefined.\n     */\n    loadMagnitudeRange(gl, minMag, maxMag) {\n        if (minMag == null) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"StarFieldProgram\", \"loadMagRange\", \"missingMinMag\"));\n        }\n        if (maxMag == null) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"StarFieldProgram\", \"loadMagRange\", \"missingMaxMag\"));\n        }\n        let forceLoad = false;\n        if (this.localState.magnitudeRange === null) {\n            forceLoad = true;\n            this.localState.magnitudeRange = [minMag, maxMag];\n        }\n\n        if (forceLoad || this.localState.magnitudeRange[0] !== minMag || this.localState.magnitudeRange[1] !== maxMag) {\n            gl.uniform2f(this.magnitudeRangeLocation, minMag, maxMag);\n            this.localState.magnitudeRange[0] = minMag;\n            this.localState.magnitudeRange[1] = maxMag;\n        }\n    }\n\n    /**\n     * Loads the specified number as the value of this program's 'textureSampler' uniform variable.\n     * @param {WebGLRenderingContext} gl The current WebGL context.\n     * @param {Number} unit The texture unit.\n     */\n    loadTextureUnit(gl, unit) {\n        if (this.localState.textureUnit !== unit) {\n            gl.uniform1i(this.textureUnitLocation, unit - gl.TEXTURE0);\n            this.localState.textureUnit = unit;\n        }\n    }\n\n    loadFragMode(gl, mode) {\n        if (this.localState.fragMode !== mode) {\n            gl.uniform1i(this.fragModeLocation, mode);\n            this.localState.fragMode = mode;\n        }\n    }\n\n    loadColor(gl, color) {\n        let forceLoad = false;\n        if (this.localState.color === null) {\n            forceLoad = true;\n            this.localState.color = new Color(0, 0, 0, 0);\n        }\n\n        if (forceLoad || !this.localState.color.equals(color)) {\n            this.loadUniformColor(gl, color, this.colorLocation);\n            this.localState.color.copy(color);\n        }\n    }\n}\n\n/**\n * A string that uniquely identifies this program.\n * @type {string}\n * @readonly\n */\nStarFieldProgram.key = \"WorldWindGpuStarFieldFullProgram\";\n\nexport default StarFieldProgram;","/*\n * Copyright 2015-2017 WorldWind Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport WorldWind from 'webworldwind-esa';\nconst {\n    Angle,\n    ArgumentError,\n    Logger\n} = WorldWind;\n\n/**\n * Provides utilities for determining the Moon geographic and celestial location.\n * @exports MoonPosition\n */\nconst MoonPosition = {\n\n    /**\n     * Computes the geographic location of the moon for a given date\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {{latitude: Number, longitude: Number}} the geographic location\n     */\n    getAsGeographicLocation: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"MoonPosition\", \"getAsGeographicLocation\",\n                    \"missingDate\"));\n        }\n\n        let celestialLocation = this.getAsCelestialLocation(date);\n        return this.celestialToGeographic(celestialLocation, date);\n    },\n\n    /**\n     * Computes the celestial location of the moon for a given julianDate\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {{declination: Number, rightAscension: Number}} the celestial location\n     */\n    getAsCelestialLocation: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"MoonPosition\", \"getAsCelestialLocation\",\n                    \"missingDate\"));\n        }\n\n        let julianDate = this.computeJulianDate(date);\n\n        //number of days (positive or negative) since Greenwich noon, Terrestrial Time, on 1 January 2000 (J2000.0)\n        let numDays = julianDate - 2451545;\n\n        let eclipticLongitude = this.normalizeAngle360(218.316 + 13.176396 * numDays) * Angle.DEGREES_TO_RADIANS;\n        let meanAnomaly = this.normalizeAngle360(134.963 + 13.064993  * numDays) * Angle.DEGREES_TO_RADIANS;\n        let meanDistance = this.normalizeAngle360(93.272 + 13.229350  * numDays) * Angle.DEGREES_TO_RADIANS;\n\n        let longitude = eclipticLongitude + 6.289 * Math.sin(meanAnomaly) * Angle.DEGREES_TO_RADIANS;\n        let latitude = 5.128 * Math.sin(meanDistance) * Angle.DEGREES_TO_RADIANS;\n        let obliquityOfTheEcliptic = (23.439 - 0.0000004 * numDays) * Angle.DEGREES_TO_RADIANS;\n\n        let rightAscension = Math.atan2( Math.sin(longitude) * Math.cos(obliquityOfTheEcliptic) - Math.tan(latitude) * Math.sin(obliquityOfTheEcliptic) , Math.cos(longitude) ) *\n        Angle.RADIANS_TO_DEGREES;\n\n        let declination = Math.asin( Math.sin(latitude) * Math.cos(obliquityOfTheEcliptic) + Math.cos(latitude) * Math.sin(obliquityOfTheEcliptic) * Math.sin(longitude) ) *\n        Angle.RADIANS_TO_DEGREES;\n\n\n        //compensate for atan result\n        // if (eclipticLongitude >= 90 && eclipticLongitude < 270) {\n        //     rightAscension += 180;\n        // }\n        rightAscension = this.normalizeAngle360(rightAscension);\n\n        return {\n            declination: declination,\n            rightAscension: rightAscension\n        };\n    },\n\n    /**\n     * Converts from celestial coordinates (declination and right ascension) to geographic coordinates\n     * (latitude, longitude) for a given julian date\n     * @param {{declination: Number, rightAscension: Number}} celestialLocation\n     * @param {Date} date\n     * @throws {ArgumentError} if celestialLocation or julianDate are missing\n     * @return {{latitude: Number, longitude: Number}} the geographic location\n     */\n    celestialToGeographic: function (celestialLocation, date) {\n        if (!celestialLocation) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"MoonPosition\", \"celestialToGeographic\",\n                    \"missingCelestialLocation\"));\n        }\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"MoonPosition\", \"celestialToGeographic\", \"missingDate\"));\n        }\n\n        let julianDate = this.computeJulianDate(date);\n\n        //number of days (positive or negative) since Greenwich noon, Terrestrial Time, on 1 January 2000 (J2000.0)\n        let numDays = julianDate - 2451545;\n\n        //Greenwich Mean Sidereal Time\n        let GMST = this.normalizeAngle360(280.46061837 + 360.98564736629 * numDays);\n\n        //Greenwich Hour Angle\n        let GHA = this.normalizeAngle360(GMST - celestialLocation.rightAscension);\n\n        let longitude = Angle.normalizedDegreesLongitude(-GHA);\n\n        return {\n            latitude: celestialLocation.declination,\n            longitude: longitude\n        };\n    },\n\n    /**\n     * Computes the julian date from a javascript date object\n     * @param {Date} date\n     * @throws {ArgumentError} if the date is missing\n     * @return {Number} the julian date\n     */\n    computeJulianDate: function (date) {\n        if (date instanceof Date === false) {\n            throw new ArgumentError(\n                Logger.logMessage(Logger.LEVEL_SEVERE, \"MoonPosition\", \"computeJulianDate\", \"missingDate\"));\n        }\n\n        let year = date.getUTCFullYear();\n        let month = date.getUTCMonth() + 1;\n        let day = date.getUTCDate();\n        let hour = date.getUTCHours();\n        let minute = date.getUTCMinutes();\n        let second = date.getUTCSeconds();\n\n        let dayFraction = (hour + minute / 60 + second / 3600) / 24;\n\n        if (month <= 2) {\n            year -= 1;\n            month += 12;\n        }\n\n        let A = Math.trunc(year / 100);\n        let B = 2 - A + Math.trunc(A / 4);\n        let JD0h = Math.trunc(365.25 * (year + 4716)) + Math.trunc(30.6001 * (month + 1)) + day + B - 1524.5;\n\n        return JD0h + dayFraction;\n    },\n\n    /**\n     * Restricts an angle to the range [0, 360] degrees, wrapping angles outside the range.\n     * Wrapping takes place as though traversing the edge of a unit circle;\n     * angles less than 0 wrap back to 360, while angles greater than 360 wrap back to 0.\n     *\n     * @param {Number} degrees the angle to wrap in degrees\n     *\n     * @return {Number} the specified angle wrapped to [0, 360] degrees\n     */\n    normalizeAngle360: function(degrees) {\n        let angle = degrees % 360;\n        return angle >= 0 ? angle : (angle < 0 ? 360 + angle : 360 - angle);\n    }\n\n};\n\nexport default MoonPosition;","/**\n * @exports StarFieldLayer\n */\nimport Celestial from './Celestial';\nimport StarFieldProgram from './StarFieldProgram';\nimport SunPosition from './SunPosition';\nimport MoonPosition from './MoonPosition';\n\nimport WorldWind from 'webworldwind-esa';\nconst {\n    Color,\n    Layer,\n    Logger,\n    Matrix,\n    REDRAW_EVENT_TYPE\n} = WorldWind;\n\n\n/**\n * Constructs a layer showing stars and the Sun around the Earth.\n * If used together with the AtmosphereLayer, the StarFieldLayer must be inserted before the AtmosphereLayer.\n *\n * If you want to use your own star data, the file provided must be .json\n * and the fields 'ra', 'dec' and 'vmag' must be present in the metadata.\n * ra and dec must be expressed in degrees.\n *\n * This layer uses J2000.0 as the ref epoch.\n *\n * If the star data .json file is too big, consider enabling gzip compression on your web server.\n * For more info about enabling gzip compression consult the configuration for your web server.\n *\n *\n -- output format : json\n SELECT \"I/239/hip_main\".HIP,  \"I/239/hip_main\".Vmag as vmag, \"I/239/hip_main\".\"_RA.icrs\" as ra,  \"I/239/hip_main\".\"_DE.icrs\" as dec\n FROM \"I/239/hip_main\"\n WHERE \"I/239/hip_main\".Vmag <=6.5\n *\n * @alias StarFieldLayer\n * @constructor\n * @classdesc Provides a layer showing stars, and the Sun around the Earth\n * @param {URL} starDataSource optional url for the stars data\n * @augments Layer\n */\nclass StarFieldLayer extends Layer {\n    constructor(starDataSource) {\n        super('StarField');\n\n        // The StarField Layer is not pickable.\n        this.pickEnabled = false;\n\n        /**\n         * The size of the Sun in pixels.\n         * This can not exceed the maximum allowed pointSize of the GPU.\n         * A warning will be given if the size is too big and the allowed max size will be used.\n         * @type {Number}\n         * @default 128\n         */\n        this.sunSize = 128;\n\n        /**\n         * Indicates weather to show or hide the Sun\n         * @type {Boolean}\n         * @default true\n         */\n        this.showSun = true;\n\n        /**\n         * Indicates weather to show or hide the Moon\n         * @type {Boolean}\n         * @default true\n         */\n        this.showMoon = true;\n\n        //Documented in defineProperties below.\n        this._starDataSource = starDataSource || WorldWind.configuration.baseUrl + 'data/stars.json';\n        this._sunImageSource = WorldWind.configuration.baseUrl + 'images/sunTexture.png';\n        this._moonImageSource = WorldWind.configuration.baseUrl + 'images/moonTexture.png';\n\n        //Internal use only.\n        //The MVP matrix of this layer.\n        this._matrix = Matrix.fromIdentity();\n\n        //Internal use only.\n        //gpu cache key for the stars vbo.\n        this._starsPositionsVboCacheKey = null;\n\n        //Internal use only.\n        this._numStars = 0;\n\n        //Internal use only.\n        this._starData = null;\n\n        //Internal use only.\n        this._minMagnitude = Number.MAX_VALUE;\n        this._maxMagnitude = Number.MIN_VALUE;\n\n        //Internal use only.\n        //A flag to indicate the star data is currently being retrieved.\n        this._loadStarted = false;\n\n        //Internal use only.\n        this._minScale = 30e6;\n        this._scale = Number.MAX_SAFE_INTEGER || Math.pow(2, 53) - 1;\n        //this._scale = 50e6;\n\n        //Internal use only.\n        this._sunPositionsCacheKey = '';\n        this._sunBufferView = new Float32Array(4);\n\n        //Internal use only.\n        this._moonPositionsCacheKey = '';\n        this._moonBufferView = new Float32Array(4);\n        \n        //Internal use only.\n        this._MAX_GL_POINT_SIZE = 0;\n\n        this.showPlanets = true;\n\n        const jupiterSize = 32;\n\n        this.planets = [\n            {\n                id: Celestial.MERCURY,\n                url: 'images/Mercury64.png',\n                size: jupiterSize / 4,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.VENUS,\n                url: 'images/Venus64.png',\n                size: jupiterSize / 4,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.MARS,\n                url: 'images/Mars64.png',\n                size: jupiterSize / 4,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.JUPITER,\n                url: 'images/Jupiter64.png',\n                size: jupiterSize,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.SATURN,\n                url: 'images/Saturn64.png',\n                size: jupiterSize,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.URANUS,\n                url: 'images/Uranus64.png',\n                size: jupiterSize / 2,\n                ra: null,\n                dec: null,\n            },\n            {\n                id: Celestial.NEPTUNE,\n                url: 'images/Neptune64.png',\n                size: jupiterSize / 2,\n                ra: null,\n                dec: null,\n            },\n        ];\n\n        this._planetsBufferView = null;\n\n        this._cacheKeys = {\n            sunPosition: '',\n            planetPositions: '',\n            starPositions: ''\n        };\n    }\n\n    /**\n     * Url for the stars data.\n     * @memberof StarFieldLayer.prototype\n     * @type {URL}\n     */\n    get starDataSource() {\n        return this._starDataSource;\n    }\n    \n    set starDataSource(value) {\n        this._starDataSource = value;\n        this.invalidateStarData();\n    }\n\n    /**\n     * Url for the sun texture image.\n     * @memberof StarFieldLayer.prototype\n     * @type {URL}\n     */\n    get sunImageSource() {\n        return this._sunImageSource;\n    }\n    \n    set sunImageSource(value) {\n        this._sunImageSource = value;\n    }\n\n    /**\n     * Url for the moon texture image.\n     * @memberof StarFieldLayer.prototype\n     * @type {URL}\n     */\n    get moonImageSource() {\n        return this._moonImageSource;\n    }\n    \n    set moonImageSource(value) {\n        this._moonImageSource = value;\n    }\n\n    // Documented in superclass.\n    doRender(dc) {\n        if (dc.globe.is2D()) {\n            return;\n        }\n\n        if (!this.haveResources(dc)) {\n            this.loadResources(dc);\n            return;\n        }\n\n        this.beginRendering(dc);\n        try {\n            this.doDraw(dc);\n        }\n        finally {\n            this.endRendering(dc);\n        }\n    }\n\n    // Internal. Intentionally not documented.\n    haveResources(dc) {\n        let sunTexture = dc.gpuResourceCache.resourceForKey(this._sunImageSource);\n        let moonTexture = dc.gpuResourceCache.resourceForKey(this._moonImageSource);\n        let planetTextures = this.planets.every(planet => {\n            const texture = dc.gpuResourceCache.resourceForKey(planet.url);\n            return !!texture;\n        });\n        return (\n            this._starData != null &&\n            sunTexture != null &&\n            moonTexture != null &&\n            planetTextures\n        );\n    }\n\n    // Internal. Intentionally not documented.\n    loadResources(dc) {\n        let gl = dc.currentGlContext;\n        let gpuResourceCache = dc.gpuResourceCache;\n\n        if (!this._starData) {\n            this.fetchStarData();\n        }\n\n        let sunTexture = gpuResourceCache.resourceForKey(this._sunImageSource);\n        if (!sunTexture) {\n            gpuResourceCache.retrieveTexture(gl, this._sunImageSource);\n        }\n\n        let moonTexture = gpuResourceCache.resourceForKey(this._moonImageSource);\n        if (!moonTexture) {\n            gpuResourceCache.retrieveTexture(gl, this._moonImageSource);\n        }\n\n        this.planets.forEach(planet => {\n            const texture = gpuResourceCache.resourceForKey(planet.url);\n            if (!texture) {\n                gpuResourceCache.retrieveTexture(gl, planet.url);\n            }\n        });\n    }\n\n    // Internal. Intentionally not documented.\n    beginRendering(dc) {\n        let gl = dc.currentGlContext;\n        dc.findAndBindProgram(StarFieldProgram);\n        gl.enableVertexAttribArray(0);\n        gl.depthMask(false);\n    }\n\n    // Internal. Intentionally not documented.\n    doDraw(dc) {\n        this.loadCommonUniforms(dc);\n\n        this.renderStars(dc);\n\n        if (this.showSun) {\n            this.renderSun(dc);\n        }\n\n        if (this.showMoon) {\n            this.renderMoon(dc);\n        }\n\n        if (this.showPlanets) {\n            this.renderPlanets(dc);\n        }\n    }\n\n    // Internal. Intentionally not documented.\n    loadCommonUniforms(dc) {\n        let gl = dc.currentGlContext;\n        let program = dc.currentProgram;\n\n        let mvp = dc.modelviewProjection || dc.navigatorState.modelviewProjection;\n        this._matrix.copy(mvp);\n        this._matrix.multiplyByScale(this._scale, this._scale, this._scale);\n\n        program.loadModelviewProjection(gl, this._matrix);\n\n        //this subtraction does not work properly on the GPU, it must be done on the CPU\n        //possibly due to precision loss\n        //number of days (positive or negative) since Greenwich noon, Terrestrial Time, on 1 January 2000 (J2000.0)\n        let julianDate = SunPosition.computeJulianDate(this.time || new Date());\n        program.loadNumDays(gl, julianDate - 2451545.0);\n    }\n\n    // Internal. Intentionally not documented.\n    renderStars(dc) {\n        let gl = dc.currentGlContext;\n        let gpuResourceCache = dc.gpuResourceCache;\n        let program = dc.currentProgram;\n\n        if (!this._starsPositionsVboCacheKey) {\n            this._starsPositionsVboCacheKey = gpuResourceCache.generateCacheKey();\n        }\n        let vboId = gpuResourceCache.resourceForKey(this._starsPositionsVboCacheKey);\n        if (!vboId) {\n            vboId = gl.createBuffer();\n            let positions = this.createStarsGeometry();\n            gpuResourceCache.putResource(this._starsPositionsVboCacheKey, vboId, positions.length * 4);\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n        }\n        dc.frameStatistics.incrementVboLoadCount(1);\n\n        gl.vertexAttribPointer(0, 4, gl.FLOAT, false, 0, 0);\n\n        program.loadMagnitudeRange(gl, this._minMagnitude, this._maxMagnitude);\n        program.loadFragMode(gl, program.FRAG_MODE_MIX_COLOR);\n\n        gl.drawArrays(gl.POINTS, 0, this._numStars);\n    }\n\n    // Internal. Intentionally not documented.\n    renderPlanets(dc) {\n        let gl = dc.currentGlContext;\n        let program = dc.currentProgram;\n        let gpuResourceCache = dc.gpuResourceCache;\n\n        if (!this._MAX_GL_POINT_SIZE) {\n            this._MAX_GL_POINT_SIZE = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE)[1];\n        }\n        if (this.sunSize > this._MAX_GL_POINT_SIZE) {\n            Logger.log(Logger.LEVEL_WARNING, 'StarFieldLayer - sunSize is to big, max size allowed is: ' +\n                this._MAX_GL_POINT_SIZE);\n        }\n\n        this.planets.forEach(planet => {\n            const {ra, dec} = Celestial.getCelestialLocation(planet.id, this.time || new Date());\n            planet.ra = ra;\n            planet.dec = dec;\n        }, this);\n\n        if (!this._planetsBufferView) {\n            this._planetsBufferView = new Float32Array(this.planets.length * 4);\n        }\n\n        for (let i = 0; i < this.planets.length; i++) {\n            let planet = this.planets[i];\n            this._planetsBufferView[i * 4 + 0] = planet.dec;\n            this._planetsBufferView[i * 4 + 1] = planet.ra;\n            this._planetsBufferView[i * 4 + 2] = Math.min(planet.size, this._MAX_GL_POINT_SIZE);\n            this._planetsBufferView[i * 4 + 3] = 1;\n        }\n\n        if (!this._planetsPositionsVboCacheKey) {\n            this._planetsPositionsVboCacheKey = gpuResourceCache.generateCacheKey();\n        }\n        let vboId = gpuResourceCache.resourceForKey(this._planetsPositionsVboCacheKey);\n        if (!vboId) {\n            vboId = gl.createBuffer();\n            gpuResourceCache.putResource(this._planetsPositionsVboCacheKey, vboId, this._planetsBufferView.length * 4);\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferData(gl.ARRAY_BUFFER, this._planetsBufferView, gl.DYNAMIC_DRAW);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._planetsBufferView);\n        }\n        dc.frameStatistics.incrementVboLoadCount(1);\n        gl.vertexAttribPointer(0, 4, gl.FLOAT, false, 0, 0);\n\n        program.loadFragMode(gl, program.FRAG_MODE_TEXTURE);\n\n        for (let i = 0; i < this.planets.length; i++) {\n            let textureSrc = this.planets[i].url;\n            let texture = dc.gpuResourceCache.resourceForKey(textureSrc);\n            texture.bind(dc);\n            gl.drawArrays(gl.POINTS, i, 1);\n        }\n    }\n\n    // Internal. Intentionally not documented.\n    renderSun(dc) {\n        let gl = dc.currentGlContext;\n        let program = dc.currentProgram;\n        let gpuResourceCache = dc.gpuResourceCache;\n\n        if (!this._MAX_GL_POINT_SIZE) {\n            this._MAX_GL_POINT_SIZE = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE)[1];\n        }\n        if (this.sunSize > this._MAX_GL_POINT_SIZE) {\n            Logger.log(Logger.LEVEL_WARNING, 'StarFieldLayer - sunSize is to big, max size allowed is: ' +\n                this._MAX_GL_POINT_SIZE);\n        }\n\n        let sunCelestialLocation = SunPosition.getAsCelestialLocation(this.time || new Date());\n\n        this._sunBufferView[0] = sunCelestialLocation.declination;\n        this._sunBufferView[1] = sunCelestialLocation.rightAscension;\n        this._sunBufferView[2] = Math.min(this.sunSize, this._MAX_GL_POINT_SIZE);\n        this._sunBufferView[3] = 1;\n\n        if (!this._sunPositionsCacheKey) {\n            this._sunPositionsCacheKey = gpuResourceCache.generateCacheKey();\n        }\n        let vboId = gpuResourceCache.resourceForKey(this._sunPositionsCacheKey);\n        if (!vboId) {\n            vboId = gl.createBuffer();\n            gpuResourceCache.putResource(this._sunPositionsCacheKey, vboId, this._sunBufferView.length * 4);\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferData(gl.ARRAY_BUFFER, this._sunBufferView, gl.DYNAMIC_DRAW);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._sunBufferView);\n        }\n        dc.frameStatistics.incrementVboLoadCount(1);\n        gl.vertexAttribPointer(0, 4, gl.FLOAT, false, 0, 0);\n\n        program.loadFragMode(gl, program.FRAG_MODE_TEXTURE);\n\n        let sunTexture = dc.gpuResourceCache.resourceForKey(this._sunImageSource);\n        sunTexture.bind(dc);\n\n        gl.drawArrays(gl.POINTS, 0, 1);\n    }\n\n    // Internal. Intentionally not documented.\n    renderMoon(dc) {\n        let gl = dc.currentGlContext;\n        let program = dc.currentProgram;\n        let gpuResourceCache = dc.gpuResourceCache;\n\n        if (!this._MAX_GL_POINT_SIZE) {\n            this._MAX_GL_POINT_SIZE = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE)[1];\n        }\n        if (this.sunSize > this._MAX_GL_POINT_SIZE) {\n            Logger.log(Logger.LEVEL_WARNING, 'StarFieldLayer - sunSize is to big, max size allowed is: ' +\n                this._MAX_GL_POINT_SIZE);\n        }\n\n        let moonCelestialLocation = MoonPosition.getAsCelestialLocation(this.time || new Date());\n\n        this._moonBufferView[0] = moonCelestialLocation.declination;\n        this._moonBufferView[1] = moonCelestialLocation.rightAscension;\n        this._moonBufferView[2] = Math.min(this.sunSize, this._MAX_GL_POINT_SIZE);\n        this._moonBufferView[3] = 1;\n\n        if (!this._moonPositionsCacheKey) {\n            this._moonPositionsCacheKey = gpuResourceCache.generateCacheKey();\n        }\n        let vboId = gpuResourceCache.resourceForKey(this._moonPositionsCacheKey);\n        if (!vboId) {\n            vboId = gl.createBuffer();\n            gpuResourceCache.putResource(this._moonPositionsCacheKey, vboId, this._moonBufferView.length * 4);\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferData(gl.ARRAY_BUFFER, this._moonBufferView, gl.DYNAMIC_DRAW);\n        }\n        else {\n            gl.bindBuffer(gl.ARRAY_BUFFER, vboId);\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._moonBufferView);\n        }\n        dc.frameStatistics.incrementVboLoadCount(1);\n        gl.vertexAttribPointer(0, 4, gl.FLOAT, false, 0, 0);\n\n        program.loadFragMode(gl, program.FRAG_MODE_TEXTURE);\n\n        let moonTexture = dc.gpuResourceCache.resourceForKey(this._moonImageSource);\n        moonTexture.bind(dc);\n\n        gl.drawArrays(gl.POINTS, 0, 1);\n    }\n\n    // Internal. Intentionally not documented.\n    endRendering(dc) {\n        let gl = dc.currentGlContext;\n        gl.depthMask(true);\n        gl.disableVertexAttribArray(0);\n    }\n\n    // Internal. Intentionally not documented.\n    fetchStarData() {\n        if (this._loadStarted) {\n            return;\n        }\n\n        this._loadStarted = true;\n        let self = this;\n        let xhr = new XMLHttpRequest();\n\n        xhr.onload = function () {\n            if (this.status >= 200 && this.status < 300) {\n                try {\n                    self._starData = JSON.parse(this.response);\n                    self.sendRedrawRequest();\n                }\n                catch (e) {\n                    Logger.log(Logger.LEVEL_SEVERE, 'StarFieldLayer unable to parse JSON for star data ' +\n                        e.toString());\n                }\n            }\n            else {\n                Logger.log(Logger.LEVEL_SEVERE, 'StarFieldLayer unable to fetch star data. Status: ' +\n                    this.status + ' ' + this.statusText);\n            }\n            self._loadStarted = false;\n        };\n\n        xhr.onerror = function () {\n            Logger.log(Logger.LEVEL_SEVERE, 'StarFieldLayer unable to fetch star data');\n            self._loadStarted = false;\n        };\n\n        xhr.ontimeout = function () {\n            Logger.log(Logger.LEVEL_SEVERE, 'StarFieldLayer fetch star data has timeout');\n            self._loadStarted = false;\n        };\n\n        xhr.open('GET', this._starDataSource, true);\n        xhr.send();\n    }\n\n    // Internal. Intentionally not documented.\n    createStarsGeometry() {\n        let indexes = this.parseStarsMetadata(this._starData.metadata);\n\n        if (indexes.raIndex === -1) {\n            throw new Error(\n                Logger.logMessage(Logger.LEVEL_SEVERE, 'StarFieldLayer', 'createStarsGeometry',\n                    'Missing ra field in star data.'));\n        }\n        if (indexes.decIndex === -1) {\n            throw new Error(\n                Logger.logMessage(Logger.LEVEL_SEVERE, 'StarFieldLayer', 'createStarsGeometry',\n                    'Missing dec field in star data.'));\n        }\n        if (indexes.magIndex === -1) {\n            throw new Error(\n                Logger.logMessage(Logger.LEVEL_SEVERE, 'StarFieldLayer', 'createStarsGeometry',\n                    'Missing vmag field in star data.'));\n        }\n\n        let data = this._starData.data;\n        let positions = [];\n\n        this._minMagnitude = Number.MAX_VALUE;\n        this._maxMagnitude = Number.MIN_VALUE;\n\n        for (let i = 0, len = data.length; i < len; i++) {\n            let starInfo = data[i];\n            let declination = starInfo[indexes.decIndex]; //for latitude\n            let rightAscension = starInfo[indexes.raIndex]; //for longitude\n            let magnitude = starInfo[indexes.magIndex];\n            let pointSize = magnitude < 2 ? 2 : 1;\n            positions.push(declination, rightAscension, pointSize, magnitude);\n\n            this._minMagnitude = Math.min(this._minMagnitude, magnitude);\n            this._maxMagnitude = Math.max(this._maxMagnitude, magnitude);\n        }\n        this._numStars = Math.floor(positions.length / 4);\n\n        return positions;\n    }\n\n    // Internal. Intentionally not documented.\n    parseStarsMetadata(metadata) {\n        let raIndex = -1,\n            decIndex = -1,\n            magIndex = -1;\n        for (let i = 0, len = metadata.length; i < len; i++) {\n            let starMetaInfo = metadata[i];\n            if (starMetaInfo.name === 'ra') {\n                raIndex = i;\n            }\n            if (starMetaInfo.name === 'dec') {\n                decIndex = i;\n            }\n            if (starMetaInfo.name === 'vmag') {\n                magIndex = i;\n            }\n        }\n        return {\n            raIndex: raIndex,\n            decIndex: decIndex,\n            magIndex: magIndex\n        };\n    }\n\n    // Internal. Intentionally not documented.\n    invalidateStarData() {\n        this._starData = null;\n        this._starsPositionsVboCacheKey = null;\n    }\n\n    // Internal. Intentionally not documented.\n    sendRedrawRequest() {\n        let e = document.createEvent('Event');\n        e.initEvent(REDRAW_EVENT_TYPE, true, true);\n        window.dispatchEvent(e);\n    }\n}\n\nexport default StarFieldLayer;\n","import WorldWind from 'webworldwind-esa';\n\nconst PickedObject = WorldWind.PickedObject,\n    SurfacePolygon = WorldWind.SurfacePolygon,\n    SurfaceShape = WorldWind.SurfaceShape;\n\n/**\n * If no image is set, it behaves the same as a SurfaceShape.\n * To set an image pass it to the shape .image property (myShape.image = myImg;)\n *\n * Limitations with an image:\n * The boundaries have to define a quadrilateral (can be defined by 4 corners)\n * If the edges arc over the globe, the interior will not be filled properly\n * Shapes that cross the anti-meridian will not use the image\n * Performance is lower\n *\n * When used with an image it will divide the image in cells (based on the step, maxImageWidth, maxImageHeight values)\n * and draw each image cell to the canvas\n * This is a slow operation, try to keep the number of cells \"low\"\n * For example:\n * step = 1, maxImageWidth = 64, maxImageHeight = 64\n * will produce 4096 (64 * 64 * 1) cells\n */\nclass TexturedSurfaceShape extends SurfaceShape {\n    constructor(attributes) {\n        super(attributes);\n\n        /**\n         * Image to draw on the surface of the shape.\n         * @type {Image}\n         */\n        this.image = null;\n\n        /**\n         * Determines the division step of the image\n         * Lower numbers produce better textures at the expense of performance\n         * @type {Number}\n         */\n        this.step = 1;\n\n        /**\n         * Resizes the image\n         * Higher numbers produce better textures at the expense of performance\n         * @type {Number}\n         */\n        this.maxImageWidth = 64;\n        this.maxImageHeight = 64;\n    }\n\n    get image() {\n        return this._image;\n    }\n\n    set image(img) {\n        this._image = img;\n        this.stateKeyInvalid = true;\n        this._stateId = SurfacePolygon.stateId++;\n    }\n\n    renderToTexture(dc, ctx2D, xScale, yScale, dx, dy) {\n        let attributes = (this.highlighted ? (this.highlightAttributes || this._attributes) : this._attributes);\n        let drawInterior = (!this._isInteriorInhibited && attributes.drawInterior);\n        let drawOutline = (attributes.drawOutline && attributes.outlineWidth > 0);\n        let pickColor;\n\n        if (!drawInterior && !drawOutline) {\n            return;\n        }\n\n        if (dc.pickingMode && !this.pickColor) {\n            this.pickColor = dc.uniquePickColor();\n        }\n\n        if (dc.pickingMode) {\n            pickColor = this.pickColor.toHexString();\n        }\n\n        if (this.crossesAntiMeridian || this.containsPole) {\n            if (drawInterior) {\n                this.draw(this._interiorGeometry, ctx2D, xScale, yScale, dx, dy);\n                ctx2D.fillStyle = dc.pickingMode ? pickColor : attributes.interiorColor.toCssColorString();\n                ctx2D.fill();\n            }\n            if (drawOutline) {\n                this.draw(this._outlineGeometry, ctx2D, xScale, yScale, dx, dy);\n                ctx2D.lineWidth = attributes.outlineWidth;\n                ctx2D.strokeStyle = dc.pickingMode ? pickColor : attributes.outlineColor.toCssColorString();\n                ctx2D.stroke();\n            }\n        } else {\n            if (this.image && !dc.pickingMode) {\n                ctx2D.save();\n            }\n            let points = this._interiorGeometry[0].map(location => ({\n                x: location.longitude * xScale + dx,\n                y: location.latitude * yScale + dy\n            }));\n            this.drawPoints(points, ctx2D);\n            if (drawInterior) {\n                if (this.image && !dc.pickingMode) {\n                    ctx2D.clip();\n                    this.drawImageToPolygon(ctx2D, this.image, points);\n                    ctx2D.restore();\n                }\n                else {\n                    ctx2D.fillStyle = dc.pickingMode ? pickColor : attributes.interiorColor.toCssColorString();\n                    ctx2D.fill();\n                }\n            }\n            if (drawOutline) {\n                ctx2D.lineWidth = attributes.outlineWidth;\n                ctx2D.strokeStyle = dc.pickingMode ? pickColor : attributes.outlineColor.toCssColorString();\n                ctx2D.stroke();\n            }\n        }\n\n        if (dc.pickingMode) {\n            let po = new PickedObject(this.pickColor.clone(), this.pickDelegate ? this.pickDelegate : this,\n                null, this.layer, false);\n            dc.resolvePick(po);\n        }\n    }\n\n    drawPoints(points, ctx2D) {\n        ctx2D.beginPath();\n        ctx2D.moveTo(points[0].x, points[0].y);\n        for (let i = 1, len = points.length; i < len; i++) {\n            ctx2D.lineTo(points[i].x, points[i].y);\n        }\n    }\n\n    drawImageToPolygon(ctx, image, points) {\n        let canvasWidth = ctx.canvas.width;\n        let canvasHeight = ctx.canvas.height;\n\n        let offScreenCanvas = TexturedSurfaceShape.offScreenCanvas();\n        let offScreenCtx = TexturedSurfaceShape.offScreenCtx();\n\n        let corners = this.getCorners(points);\n        let axesDim = this.getAxesDimensions(corners);\n\n        let offScreenWidth = Math.min(axesDim.distX, this.maxImageWidth);\n        let offScreenHeight = Math.min(axesDim.distY, this.maxImageHeight);\n\n        offScreenCanvas.width = offScreenWidth;\n        offScreenCanvas.height = offScreenHeight;\n        offScreenCtx.drawImage(image, 0, 0, offScreenWidth, offScreenHeight);\n\n        let step = this.step;\n        let width = offScreenWidth - 1;\n        let height = offScreenHeight - 1;\n        let topLeft, topRight, bottomRight, bottomLeft, y1Current, y2Current, y1Next, y2Next;\n\n        for (let y = 0; y < height; y += step) {\n            y1Current = this.lerp(corners[0], corners[3], y / height);\n            y2Current = this.lerp(corners[1], corners[2], y / height);\n            y1Next = this.lerp(corners[0], corners[3], (y + step) / height);\n            y2Next = this.lerp(corners[1], corners[2], (y + step) / height);\n\n            for (let x = 0; x < width; x += step) {\n                topLeft = this.lerp(y1Current, y2Current, x / width);\n                topRight = this.lerp(y1Current, y2Current, (x + step) / width);\n                bottomRight = this.lerp(y1Next, y2Next, (x + step) / width);\n                bottomLeft = this.lerp(y1Next, y2Next, x / width);\n\n                let dWidth = Math.ceil(Math.max(step, Math.abs(topRight.x - topLeft.x), Math.abs(bottomLeft.x - bottomRight.x))) + 1;\n                let dHeight = Math.ceil(Math.max(step, Math.abs(topLeft.y - bottomLeft.y), Math.abs(topRight.y - bottomRight.y))) + 1;\n\n                if (this.isRectInsideCanvas(topLeft, dWidth, dHeight, canvasWidth, canvasHeight)) {\n                    ctx.drawImage(offScreenCanvas, x, y, step, step, topLeft.x, topLeft.y, dWidth, dHeight);\n                }\n            }\n        }\n    }\n\n    getCorners(points, bbox) {\n        bbox = bbox || this.getBbox(points);\n\n        let edgePoints = points.filter(point => this.isEdgePoint(point, bbox));\n\n        if (edgePoints.length === 5 &&\n            this.arePointsEqual(edgePoints[0], edgePoints[edgePoints.length - 1])) {\n            edgePoints.length = 4;\n        }\n\n        if (edgePoints.length > 4) {\n            let leftPoints = edgePoints.filter(point => point.x === bbox.minX);\n            let rightPoints = edgePoints.filter(point => point.x === bbox.maxX);\n\n            let {top: topLeft, bottom: bottomLeft} = this.getTopBottom(leftPoints);\n            let {top: topRight, bottom: bottomRight} = this.getTopBottom(rightPoints);\n\n            return [topLeft, topRight, bottomRight, bottomLeft];\n        }\n\n        let slope1 = this.getSlope(edgePoints[0], edgePoints[2]);\n        let slope2 = this.getSlope(edgePoints[1], edgePoints[3]);\n        let topLeftPoint = this.getTopLeftPoint(slope1, edgePoints[0], edgePoints[2]) ||\n            this.getTopLeftPoint(slope2, edgePoints[1], edgePoints[3]);\n\n        if (!topLeftPoint) {\n            console.log('Could not determine top left corner with the slope method');\n            return edgePoints;\n        }\n\n        let topLeftIndex = edgePoints.findIndex(point => point.x === topLeftPoint.x && point.y === topLeftPoint.y);\n        let newCorners = [];\n        for (let i = topLeftIndex; i < edgePoints.length + topLeftIndex; i++) {\n            newCorners.push(edgePoints[i % edgePoints.length]);\n        }\n\n        return newCorners;\n    }\n\n    getBbox(points) {\n        let bbox = {\n            minX: Number.MAX_SAFE_INTEGER,\n            maxX: Number.MIN_SAFE_INTEGER,\n            minY: Number.MAX_SAFE_INTEGER,\n            maxY: Number.MIN_SAFE_INTEGER,\n        };\n\n        return points.reduce((bbox, point) => {\n            bbox.minX = Math.min(bbox.minX, point.x);\n            bbox.maxX = Math.max(bbox.maxX, point.x);\n            bbox.minY = Math.min(bbox.minY, point.y);\n            bbox.maxY = Math.max(bbox.maxY, point.y);\n\n            return bbox;\n        }, bbox);\n    }\n\n    getTopBottom(points) {\n        return points.reduce((acc, point) => {\n            if (point.y < acc.top.y) {\n                acc.top = point;\n            }\n\n            if (point.y > acc.bottom.y) {\n                acc.bottom = point;\n            }\n\n            return acc;\n        }, {top: points[0], bottom: points[0]});\n    }\n\n    distance(p1, p2) {\n        let dx = p1.x - p2.x;\n        let dy = p1.y - p2.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    isEdgePoint(point, bbox) {\n        return (\n            point.x === bbox.minX || point.x === bbox.maxX ||\n            point.y === bbox.minY || point.y === bbox.maxY\n        );\n    }\n\n    arePointsEqual(p1, p2) {\n        return p1.x === p2.x && p1.y === p2.y;\n    }\n\n    getSlope(p1, p2) {\n        return (p1.y - p2.y) / (p1.x - p2.x);\n    }\n\n    getTopLeftPoint(slope, point1, point2) {\n        if (slope <= 0) {\n            return null;\n        }\n\n        if (point1.y < point2.y) {\n            return point1;\n        }\n\n        return point2;\n    }\n\n    getAxesDimensions(corners) {\n        let dx = Math.abs(corners[0].x - corners[1].x);\n        let dy = Math.abs(corners[0].y - corners[1].y);\n\n        let distX = 0;\n        let distY = 0;\n\n        if (dx > dy) {\n            distX = this.distance(corners[0], corners[1]);\n            distY = this.distance(corners[0], corners[3]);\n        }\n        else {\n            distX = this.distance(corners[0], corners[3]);\n            distY = this.distance(corners[0], corners[1]);\n        }\n\n        return {distX, distY};\n    }\n\n    lerp(p1, p2, t) {\n        return {\n            x: p1.x + (p2.x - p1.x) * t,\n            y: p1.y + (p2.y - p1.y) * t\n        };\n    }\n\n    isRectInsideCanvas(point, width, height, canvasWidth, canvasHeight) {\n        return (\n            point.x + width >= 0 &&\n            point.x <= canvasWidth &&\n            point.y + height >= 0 &&\n            point.y < canvasHeight\n        );\n    }\n\n    static offScreenCanvas() {\n        if (!TexturedSurfaceShape.canvas) {\n            TexturedSurfaceShape.canvas = document.createElement('canvas');\n        }\n        return TexturedSurfaceShape.canvas;\n    }\n\n    static offScreenCtx() {\n        if (!TexturedSurfaceShape.ctx) {\n            let canvas = TexturedSurfaceShape.offScreenCanvas();\n            TexturedSurfaceShape.ctx = canvas.getContext('2d');\n        }\n        return TexturedSurfaceShape.ctx;\n    }\n}\n\nexport default TexturedSurfaceShape;","import WorldWind from 'webworldwind-esa';\r\n\r\nconst {\r\n    ColladaScene,\r\n    Matrix,\r\n    Renderable\r\n} = WorldWind;\r\n\r\n/**\r\n * @exports Model\r\n */\r\nclass Model extends Renderable {\r\n    /**\r\n     * Constructs model of the satellite on the given position.\r\n     * @param model {Object} Model information. Collada information.\r\n     * @param satellite {Object} The details about the satellite and the way it should be transformed and presented.\r\n     * @param position {Position} The exact position of the center of the satellite.\r\n     */\r\n    constructor(model, satellite, position) {\r\n        super();\r\n\r\n        this._satellite = satellite;\r\n        const satelliteModel = this.parse(model);\r\n        this.draw(position, satelliteModel);\r\n    }\r\n\r\n    /**\r\n     * Updates the position of the model.\r\n     * @param position {Position} Current position of the model.\r\n     */\r\n    position(position) {\r\n        this._model.position = position;\r\n    }\r\n\r\n    /**\r\n     * Draws the collada model into a Collada Scene.\r\n     * @param position {Position} Position of the satellite.\r\n     * @param modelData Collada Model Information.\r\n     */\r\n    draw(position, modelData) {\r\n        const nodesToHide = [\r\n            'PlatformCircleAndName', 'SolarWingsCircleAndName', 'C-SarCircleAndName',\r\n            'PlatformTextsAndArrows', 'SolarWingsTextsAndArrows', 'C-SarTextsAndArrows',\r\n\r\n            'SolarArrayGroup', 'WingsDetailsGroup', 'Group004', 'MsiGroup', 'SatteliteGroup',\r\n\r\n            'SatteliteDimensionsGroup', 'MWRGroup', 'SRALGroup', 'OLCIGroup', 'SLSTRGroup'\r\n        ];\r\n        const {\r\n            rotations,\r\n            translations,\r\n            preRotations,\r\n            scale,\r\n            shortName,\r\n            ignoreLocalTransforms\r\n        } = this._satellite;\r\n\r\n        const model = new ColladaScene(position, modelData);\r\n        model.type = this.type;\r\n        model.satShortName = shortName;\r\n\r\n        model.nodesToHide = nodesToHide;\r\n        model.hideNodes = true;\r\n        model.useTexturePaths = false;\r\n        model.localTransforms = ignoreLocalTransforms;\r\n        model.scale = scale;\r\n        model.xRotation = rotations.x;\r\n        model.yRotation = rotations.y;\r\n        model.zRotation = rotations.z;\r\n        model.xTranslation = translations.x;\r\n        model.yTranslation = translations.y;\r\n        model.zTranslation = translations.z;\r\n        model.preX = preRotations.x;\r\n        model.preY = preRotations.y;\r\n        model.preZ = preRotations.z;\r\n\r\n        this._model = model;\r\n        modelData = null;\r\n    }\r\n\r\n    /**\r\n     * Parses the collada model and update the information relevant to the satellites.\r\n     * @param {{ meshes:Object, root:Object, materials:{reflective:Array, diffuse:Array} }} jsonData\r\n     * @return {Object} Collada model.\r\n     */\r\n    parse(jsonData) {\r\n        const meshes = jsonData.meshes;\r\n        const nodes = jsonData.root.children;\r\n        const materials = jsonData.materials;\r\n\r\n        for (let key in meshes) {\r\n            if (meshes.hasOwnProperty(key)) {\r\n                const buffers = meshes[key].buffers;\r\n\r\n                for (let i = 0; i < buffers.length; i++) {\r\n                    const vertices = buffers[i].vertices || [];\r\n                    const normals = buffers[i].normals || [];\r\n                    const uvs = buffers[i].uvs || [];\r\n                    const indices = buffers[i].indices || [];\r\n\r\n                    const eVertices = new Float32Array(vertices);\r\n                    const eNormals = new Float32Array(normals);\r\n                    const eUvs = new Float32Array(uvs);\r\n                    const eIndices = new Uint16Array(indices);\r\n\r\n                    buffers[i].vertices = eVertices;\r\n                    buffers[i].normals = eNormals;\r\n                    buffers[i].uvs = eUvs;\r\n                    buffers[i].indices = eIndices;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < nodes.length; i++) {\r\n            const node = nodes[i];\r\n            if (node.mesh) {\r\n                const worldMatrix = node.worldMatrix.slice(0);\r\n                node.worldMatrix = Matrix.fromIdentity();\r\n                node.worldMatrix.copy(worldMatrix);\r\n\r\n                if (node.children.length) {\r\n                    console.info('node has children', node);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let key in materials) {\r\n            if (materials.hasOwnProperty(key)) {\r\n                const material = materials[key];\r\n\r\n                if (material.id === '_3_-_Default-material') {\r\n                    if (material.reflective) {\r\n                        material.reflective[0] = 0.289219;\r\n                        material.reflective[1] = 0.713497;\r\n                        material.reflective[2] = 0.870753;\r\n                        material.reflective[3] = 1;\r\n                    }\r\n                } else if (material.id === '_1_-_Default_004-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === '_1_-_Default-material') {\r\n                    material.diffuse[3] = 0;\r\n                } else if (material.id === 'Chrome-material') {\r\n                    material.textures = null;\r\n                    material.diffuse[0] = 0.3137;\r\n                    material.diffuse[1] = 0.3137;\r\n                    material.diffuse[2] = 0.3137;\r\n                } else if (material.id === 'Satellite_panel-material') {\r\n                    material.textures.reflective.mapId = 'image9';\r\n                } else if (material.id === '_3_-_Default') {\r\n                    material.textures.reflective.mapId = 'image4';\r\n                } else if (material.id === '_4_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                } else if (material.id === '_5_-_Default_002-material') {\r\n                    material.textures.reflective.mapId = 'image6';\r\n                } else if (material.id === '_5_-_Default-material') {\r\n                    material.textures.reflective.mapId = 'image5';\r\n                }\r\n            }\r\n        }\r\n\r\n        return jsonData;\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    render(dc) {\r\n        if(!this._model || !this.enabled) {\r\n            return;\r\n        }\r\n\r\n        this._model.render(dc);\r\n    }\r\n}\r\n\r\nexport default Model;","import WorldWind from 'webworldwind-esa';\nimport TexturedSurfaceShape from './TexturedSurfaceShape';\n\nconst SurfacePolygon = WorldWind.SurfacePolygon;\n\n/**\n * @exports TexturedSurfacePolygon\n */\nclass TexturedSurfacePolygon extends TexturedSurfaceShape {\n    /**\n     * Constructs Textured Surface Polygon. The polygon is drawn using the standard attributes. Unlike the standard\n     * surface polygon it draws associated image on the area of the polygon.\n     * @param boundaries {Location[]} Array of locations enclosing the surface polygon.\n     * @param attributes {ShapeAttributes} Attributes used for the styling of the Surface Polygon\n     */\n    constructor(boundaries, attributes) {\n        super(attributes);\n\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - constructor - The specified boundary is not an array.');\n        }\n\n        /**\n         * Boundaries relevant for the current polygon.\n         * @type {Location[]}\n         * @memberof TexturedSurfacePolygon.prototype\n         * @public\n         */\n        this.boundaries = boundaries;\n\n        this._stateId = SurfacePolygon.stateId++;\n    }\n\n    get boundaries() {\n        return this._boundaries;\n    }\n\n    set boundaries(boundaries) {\n        if (!Array.isArray(boundaries)) {\n            throw new Error('TexturedSurfacePolygon - set boundaries - The specified boundary is not an array.');\n        }\n\n        this.resetBoundaries();\n        this._boundaries = boundaries;\n        this._stateId = SurfacePolygon.stateId++;\n        this.stateKeyInvalid = true;\n    }\n\n    /**\n     * @inheritDoc\n     */\n    computeStateKey() {\n        return TexturedSurfacePolygon.staticStateKey(this);\n    }\n\n    /**\n     * @inheritDoc\n     */\n    computeBoundaries(dc) {\n    }\n\n    static staticStateKey(shape) {\n        return SurfacePolygon.staticStateKey(shape) + \" pg \" + shape._stateId;\n    }\n}\n\nexport default TexturedSurfacePolygon;","import WorldWind from 'webworldwind-esa';\nimport SatelliteModel from './wwwx/shapes/satellites/Model';\n\n// const Location = WorldWind.Location,\n//     Sector = WorldWind.Sector,\n//     WmsLayer = WorldWind.WmsLayer;\n\n// class modelsLayer extends Layer {\n//     constructor(){\n//         super({\n//             service: \"https://tiles.maps.eox.at/wms\",\n//             layerNames: \"s2cloudless-2018\",\n//             title: \"Sentinel Cloudless Layer\",\n//             sector: new Sector(-90, 90, -180, 180),\n//             levelZeroDelta: new Location(45, 45),\n//             numLevels: 19,\n//             format: \"image/jpg\",\n//             opacity: 1,\n//             size: 256,\n//             version: \"1.3.0\"\n//         });\n//     }\n// }\n\n// export default SentinelCloudlessLayer;\nconst {\n    Position,\n    RenderableLayer\n} = WorldWind;\n\nconst modelsLayer = new RenderableLayer('Model');\nfetch('./data/sentinel1/s1.json').then(response => {\n    return response.json();\n}).then(satelliteData => {\n    modelsLayer.addRenderable(new SatelliteModel(satelliteData, {\n        rotations: {\n            x: 0,\n            y: 0,\n            z: 0,\n            headingAxis: [0, 0, 1],\n            headingAdd: -90,\n            headingMultiply: 1\n        },\n        preRotations: {\n            x: 0,\n            y: 0,\n            z: 0\n        },\n        scale: 500000,\n        translations: {\n            x: -0.1,\n            y: -0.1,\n            z: 0\n        },\n        ignoreLocalTransforms: true\n    }, new Position(51, 14, 100000)));\n});\nexport default modelsLayer","import  React, { useState, useEffect, useLayoutEffect, useRef } from \"react\";\nimport WorldWind from \"webworldwind-esa\";\nimport StarFieldLayer from \"./wwwx/layer/starfield/StarFieldLayer\"\nimport TexturedSurfacePolygon from './wwwx/shapes/TexturedSurfacePolygon'\nimport modelsLayer from './satelliteLayer';\n\n// BasicWorldWindowController.prototype.applyLimits = function () {\n//     var navigator = this.wwd.navigator;\n\n//     // Clamp latitude to between -90 and +90, and normalize longitude to between -180 and +180.\n//     navigator.lookAtLocation.latitude = WWMath.clamp(navigator.lookAtLocation.latitude, -90, 90);\n//     navigator.lookAtLocation.longitude = Angle.normalizedDegreesLongitude(navigator.lookAtLocation.longitude);\n\n//     // Clamp range to values greater than 1 in order to prevent degenerating to a first-person navigator when\n//     // range is zero.\n//     navigator.range = WWMath.clamp(navigator.range, 1, Number.MAX_VALUE);\n\n//     // Normalize heading to between -180 and +180.\n//     navigator.heading = Angle.normalizedDegrees(navigator.heading);\n\n//     // Clamp tilt to between 0 and +90 to prevent the viewer from going upside down.\n//     navigator.tilt = WWMath.clamp(navigator.tilt, 0, 90);\n\n//     // Normalize heading to between -180 and +180.\n//     navigator.roll = Angle.normalizedDegrees(navigator.roll);\n\n//     // Apply 2D limits when the globe is 2D.\n//     if (this.wwd.globe.is2D() && navigator.enable2DLimits) {\n//         // Clamp range to prevent more than 360 degrees of visible longitude. Assumes a 45 degree horizontal\n//         // field of view.\n//         var maxRange = 2  Math.PI  this.wwd.globe.equatorialRadius;\n//         navigator.range = WWMath.clamp(navigator.range, 1, maxRange);\n\n//         // Force tilt to 0 when in 2D mode to keep the viewer looking straight down.\n//         navigator.tilt = 0;\n//     }\n// };\n\nexport const  useEww = ({ id, clon, clat, alt, starfield, atmosphere, names }) => {\n    console.log('useEww renders')\n    \n  \n    const eww = useRef(null)\n    const FirstPersonCamera = useRef(null)\n    const ArcBallCamera = useRef(null)\n    \n    const [projection, setProjection] = useState(\"3D\")\n    // const [aoi, setAoi] = useState({type: null, value: null})\n    const [aoi, setAoi] = useState('')\n    const [atmo, setAtmo] = useState(atmosphere)\n    const [geojsonlayers, setGeojsonlayers] = useState([])\n    const [quicklooklayers, setQuicklooklayers] = useState([])\n    // const [ewwstate, setEwwState] = useState({latitude: clat, longitude: clon, altitude: alt, aoi:'', pickedItems: []})\n    const [ewwstate, setEwwState] = useState()\n    const [wwd, setWwd] = useState()    \n    const fpcamera = useRef()\n    const abcamera = useRef()\n    const lastAbTilt = useRef()\n    const [cameraMode, setCameraMode] = useState()\n\n    // Turn the globe up north\n    function northUp() {\n        const wwd = eww.current\n        let headingIncrement = 1.0;\n        if (Math.abs(wwd.navigator.heading) > 60) {\n            headingIncrement = 2.0;\n        } else if (Math.abs(navigator.heading) > 120) {\n            headingIncrement = 3.0;\n        }\n        if (wwd.navigator.heading > 0) {\n            headingIncrement = -headingIncrement;\n        }\n\n        let runOperation = () => {\n            if (Math.abs(wwd.navigator.heading) > Math.abs(headingIncrement)) {\n                wwd.navigator.heading += headingIncrement;\n                setTimeout(runOperation, 10);\n            } else {\n                wwd.navigator.heading = 0;\n            }\n            wwd.redraw();\n        };\n        setTimeout(runOperation, 10);\n    }\n\n    // useEffect(() => {\n    //     console.log('toggleStarfield')\n    //     getLayerByName('StarField').enabled = !getLayerByName('StarField').enabled\n    //     eww.current.redraw();\n    // }, [starfield]);\n\n    //toggle atmosphere\n    function setAtmosphere(bool) {\n        console.log('toggleAtmosphere')\n        getLayerByName('Atmosphere').enabled = bool\n        setAtmo(bool)\n        eww.current.redraw();\n    }\n\n\n    //toggle model\n    function toggleModel() {\n        console.log('toggleModel')\n        getLayerByName('Model').enabled = !getLayerByName('Model').enabled\n        eww.current.redraw();\n    }\n\n    //toggle starField\n    function setStarfield(bool) {\n        console.log('toggleStarfield')\n        getLayerByName('StarField').enabled = bool\n        eww.current.redraw();\n    }\n\n    //toggle name overlay\n    function setNames(bool) {\n        console.log('toggleNames')\n        getLayerByName('overlay_bright').enabled = bool\n        eww.current.redraw();\n    }\n    //toggle background overlay\n    function toggleBg() {\n        console.log('toggleTerrain')\n        getLayerByName('terrain').enabled = !getLayerByName('terrain').enabled\n        getLayerByName('s2cloudless-2018').enabled = !getLayerByName('s2cloudless-2018').enabled\n        eww.current.redraw();\n    }\n\n    function  getViewPolygon () {\n        let view = eww.current.viewport\n        let area = {}\n        let polygon = ''\n        // console.log('view: ' + view.x + '/' + view.y + '/' + view.width + '/' + view.height);\n\n        let bl ;\n        try { \n            bl =  eww.current.pickTerrain(eww.current.canvasCoordinates(view.x, view.y + view.height)).terrainObject().position\n            bl.latitude = Math.round(bl.latitude * 10000)/10000\n            bl.longitude = Math.round(bl.longitude * 10000)/10000\n        }\n        catch(err) {bl = null;}\n\n\n        let tr ;\n        try { \n            tr = eww.current.pickTerrain(eww.current.canvasCoordinates(view.x + view.width, view.y)).terrainObject().position\n            tr.latitude = Math.round(tr.latitude * 10000)/10000\n            tr.longitude = Math.round(tr.longitude * 10000)/10000\n        }\n        catch(err) {tr = null;}\n\n        //console.log(bl.longitude+'/'+bl.latitude+'/'+tr.longitude+'/'+tr.latitude);\n        if(bl == null || tr == null )  {\n            //   area = {type:\"bbox\", value:\"-180,-90,180,90\"};\n              polygon = ''\n        } else {\n              area = {\n                    type: \"bbox\",\n                    value:\n                           bl.longitude +','\n                          + bl.latitude +','\n                          +tr.longitude +','\n                          +tr.latitude\n              };\n\n              polygon = 'POLYGON((' \n                + bl.longitude + ' ' + bl.latitude + ',' \n                + tr.longitude + ' ' + bl.latitude + ',' \n                + tr.longitude + ' ' + tr.latitude + ',' \n                + bl.longitude + ' ' + tr.latitude + ',' \n                + bl.longitude + ' ' + bl.latitude + '))' \n        }\n        return polygon\n\n    }\n    \n    const addGeojson = (url,epoch) => {\n\n        // console.log('replace: '+replace)\n\n        function shapeConfigurationCallback(geometry, properties) {\n            let configuration = {};\n            configuration.userProperties = properties\n    \n            let placemarkAttributes = new WorldWind.PlacemarkAttributes(null);\n            placemarkAttributes.imageScale = 10;\n            placemarkAttributes.imageColor = new WorldWind.Color(0, 1, 1, 0.2);\n            placemarkAttributes.labelAttributes.offset = new WorldWind.Offset(\n                WorldWind.OFFSET_FRACTION, 5,\n                WorldWind.OFFSET_FRACTION, 5);\n            //placemarkAttributes.imageSource = whiteDot;\n    \n    \n            if (geometry.isPointType() || geometry.isMultiPointType()) {\n                configuration.attributes = new WorldWind.PlacemarkAttributes(placemarkAttributes);\n                \n            } else if (geometry.isLineStringType() || geometry.isMultiLineStringType()) {\n                configuration.attributes.drawOutline = true;\n                configuration.attributes.outlineColor = new WorldWind.Color(\n                    0.1 * configuration.attributes.interiorColor.red,\n                    0.3 * configuration.attributes.interiorColor.green,\n                    0.7 * configuration.attributes.interiorColor.blue,\n                    1\n                );\n                configuration.attributes.outlineWidth = 1;\n            } else if (geometry.isPolygonType() || geometry.isMultiPolygonType()) {\n                configuration.attributes = new WorldWind.ShapeAttributes(null);\n                configuration.attributes.interiorColor = new WorldWind.Color(1, 0, 0, 0.2);\n                configuration.attributes.outlineColor = new WorldWind.Color(1, 0, 0, 0.3);\n\n                configuration.highlightAttributes = new WorldWind.ShapeAttributes(configuration.attributes);\n                configuration.highlightAttributes.outlineColor = new WorldWind.Color(1, 0, 0, 0.4);\n                configuration.highlightAttributes.interiorColor = new WorldWind.Color(1, 0, 0, 0);\n                // configuration.attributes.outlineWidth = 0.3;\n\n                // configuration.attributes.applyLighting = true;\n                // configuration.attributes.imageSource = properties.quicklookUrl\n\n            }\n    \n            //console.log(configuration.attributes);\n            return configuration;\n        }\n\n        \n        function loadCompleteCallback() {\n            console.log(renderableLayer)\n            setGeojsonlayers((geojsonlayers)=>[...geojsonlayers,renderableLayer])\n            enableRenderables(epoch) // uncomment to disable renderables\n            eww.current.redraw();\n        }\n    \n        // if (replace) removeGeojson()\n        let renderableLayer = new WorldWind.RenderableLayer('Products: '+url.properties.updated+Math.ceil(Math.random() * 10000))\n        \n        eww.current.addLayer(renderableLayer);\n        // setGeojsonlayers((geojsonlayers)=>[...geojsonlayers,renderableLayer])\n        // setGeojsonlayers((geojsonlayers)=>[...geojsonlayers,renderableLayer])\n        // setGeojsonlayers(eww.current.layers)\n        let geoJson = new WorldWind.GeoJSONParser(url);\n        geoJson.load(loadCompleteCallback, shapeConfigurationCallback, renderableLayer);\n        // setGeojsonlayers((geojsonlayers)=>[...geojsonlayers,renderableLayer])        \n    }\n\n    function removeGeojson() {\n        for(let i=0;i<geojsonlayers.length;i++) {\n          eww.current.removeLayer(geojsonlayers[i])\n        //   console.log('removing json layers: ')\n        //   console.log(geojsonlayers[i])\n        }\n        setGeojsonlayers((geojsonlayers)=>[])\n        // console.log(geojsonlayers)\n        eww.current.redraw();\n      }\n\n    function addWMS() {\n    }\n\n    function addQuicklookWMS(renderable) {\n\n        console.log(renderable.computeSectors(eww.current.drawContext))\n        console.log(WorldWind.Sector.FULL_SPHERE)\n\n        // for S2:  \n        // https://view.onda-dias.eu/instance00/ows?&service=WMS&request=GetMap&layers=S2L1C_TRUE_COLOR&styles=&format=image/png&transparent=true&version=1.1.1&width=1500&height=1000&srs=EPSG:4326&bbox=12.357903,41.800495,12.625694,41.984760\n\n        \n        // https://view.onda-dias.eu/instance00/ows?&service=WMS&request=GetMap&layers=S1B_IW_GRDH_1SDV_20190520T050758_20190520T050823_016323_01EB81_6EB6&styles=&format=image%2Fpng&transparent=true&version=1.1.1&width=256&height=256&srs=EPSG%3A3857&bbox=2035059.441064533,7044436.526761846,2191602.4749925737,7200979.560689885\n        let wmsConfigQL = {\n            service: \"https://view.onda-dias.eu/instance00/ows\",\n            // layerNames: renderable.userProperties.title,\n            // layerNames: 'S2L1C_TRUE_COLOR',\n            layerNames: 'S1_IW_GRDH_FullResolution',\n            \n            // title: renderable.userProperties.title,\n            title: 'quicklook',\n            numLevels: 19,\n            format: \"image/png\",\n            size: 256,\n            sector: renderable.computeSectors(eww.current.drawContext)[0],\n            // sector: renderable.sector,\n            // sector: WorldWind.Sector.FULL_SPHERE,\n            levelZeroDelta: new WorldWind.Location(90, 90)\n        }\n\n        // let wmsConfigQL = {\n        //     service: \"https://tiles.maps.eox.at/wms\",\n        //     layerNames: \"overlay_bright\",\n        //     title: \"overlay_bright\",\n        //     numLevels: 19,\n        //     format: \"image/png\",\n        //     size: 256,\n        //     sector: WorldWind.Sector.FULL_SPHERE,\n        //     levelZeroDelta: new WorldWind.Location(90, 90)\n        // }\n        // eww.current.removeLayer(getLayerByName('quicklook') )\n        let qllayer =  new WorldWind.WmsLayer(wmsConfigQL, renderable.userProperties.date)\n        eww.current.addLayer(qllayer)\n        eww.current.redraw()\n        console.log(eww.current.layers)\n    }\n\n    function getLayerByName(name) {\n        for (let i = 0; i < eww.current.layers.length; i++) {\n            // console.log('display name: '+eww.current.layers[i].displayName)\n            if (eww.current.layers[i].displayName === name) return eww.current.layers[i]\n        }\n        return null\n    }\n\n    async function enableRenderables(time) {\n        let timeOffset = 1000 * 60 * 60 * 3 // 3 hours\n        for (let i = 0; i < eww.current.layers.length; i++) {\n            if (eww.current.layers[i].displayName.includes('Products:')) {\n                \n                for (let j = 0; j < eww.current.layers[i].renderables.length; j++) {\n                    let renderable = eww.current.layers[i].renderables[j]\n                    if (time != 0) {\n                        let renderableStartDate = (new Date(renderable.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime)).getTime()\n                        let renderableStopDate = (new Date(renderable.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStopTime)).getTime()\n                        renderable.enabled = (renderableStartDate <= time+timeOffset/2 && renderableStopDate >= time-timeOffset/2) ? true : false   \n                    } else {\n                        renderable.enabled = false\n                    }         \n                }\n            }\n            if (eww.current.layers[i].displayName === 'quicklook') {\n                // eww.current.layers[i].enabled = \n            }\n        }\n\n    }\n\n    function addQuicklook(renderable) {\n\n        function imageLoader(url, useCredentials) {\n            return new Promise((resolve, reject) => {\n                const img = new Image();\n        \n                img.onload = function() {\n                    resolve(img);\n                };\n        \n                img.onerror = function(e){\n                    reject(e);\n                };\n        \n                img.crossOrigin = useCredentials ? 'Use-Credentials' : 'Anonymous';\n                img.src = url;\n                console.log(' adding QL')\n            });\n        }\n\n\n        // console.log(' adding QL')\n        //  console.log(renderable.attributes)\n        // let quicklook =  new TexturedSurfacePolygon(renderable.sector)\n        // let quicklookLayer = new WorldWind.RenderableLayer('Quicklooks')\n        // // quicklookLayer.addRenderable(quicklook)\n        // // setQuicklooklayers((quicklooklayers)=>[...quicklooklayers,quicklookLayer])\n        // // eww.current.addLayer(quicklookLayer)\n        // let ql = new Image()\n        // ql.src = renderable.userProperties.quicklookUrl\n        // quicklook.image = ql\n        \n        imageLoader(renderable.userProperties.quicklookUrl,true).then(image => {\n            let quicklookLayer = getLayerByName('Quicklooks')\n            removeQuicklooks()\n            let footprint = [\n                renderable.boundaries[0][0],\n                renderable.boundaries[0][3],\n                renderable.boundaries[0][2],\n                renderable.boundaries[0][1]\n            ]\n            // footprint[0].pop()\n            console.log(footprint)\n            let quicklook =  new TexturedSurfacePolygon(footprint,renderable.attributes)\n            quicklook.maxImageWidth = 64\n            quicklook.maxImageHeight = 64\n            \n            quicklook.image = image\n            quicklookLayer.addRenderable(quicklook)\n            eww.current.addLayer(quicklookLayer)\n            eww.current.redraw()\n        })\n    }\n\n    function removeQuicklooks() {\n        getLayerByName('Quicklooks').removeAllRenderables()\n        eww.current.redraw()\n    }\n\n    function setTime(epoch) {\n        getLayerByName('StarField').time = getLayerByName('Atmosphere').time = new Date(epoch)\n        enableRenderables(epoch)\n        // console.log('display name: ')\n        // console.log(getLayerByName('StarField').displayName)\n        eww.current.redraw();\n        \n\n     }\n\n\n    function toggleProjection() {\n        setProjection( prevProj => {\n          console.log(\"prevProjection: \"+prevProj)\n          let supportedProjections = [ \"3D\", \"Equirectangular\", \"Mercator\"];\n          let newProj = (supportedProjections.indexOf(prevProj) + 1)%supportedProjections.length\n          console.log(\"newProjection: \"+supportedProjections[newProj])\n          switch (supportedProjections[newProj]) {\n            case \"3D\":\n                eww.current.globe.projection = new WorldWind.ProjectionWgs84();\n                break;\n            case \"Equirectangular\":\n                eww.current.globe.projection = new WorldWind.ProjectionEquirectangular();\n                break;\n            case \"Mercator\":\n                eww.current.globe.projection = new WorldWind.ProjectionMercator();\n                break;\n            case \"North Polar\":\n                eww.current.globe.projection = new WorldWind.ProjectionPolarEquidistant(\"North\");\n                break;\n            case \"South Polar\":\n                eww.current.globe.projection = new WorldWind.ProjectionPolarEquidistant(\"South\");\n                break;\n            default:\n            eww.current.globe.projection = new WorldWind.ProjectionWgs84();\n            }\n          eww.current.redraw();\n          return supportedProjections[newProj]\n          })      \n      }\n\n\n      const setCamera = (mode) => {\n        const copyParamCamera = (fromcamera, tocamera) => {\n            tocamera.position.latitude = fromcamera.position.latitude;\n            tocamera.position.longitude = fromcamera.position.longitude;\n            tocamera.heading = fromcamera.heading;\n            tocamera.tilt = fromcamera.tilt;\n            tocamera.roll = fromcamera.roll;\n            tocamera.range = fromcamera.range;\n          }\n    \n\n          if( mode === 'firstperson' && eww.current.navigator.camera instanceof WorldWind.ArcBallCamera) {\n            lastAbTilt.current = eww.current.navigator.camera.tilt\n            copyParamCamera(eww.current.navigator.camera, fpcamera.current)\n            eww.current.navigator.camera = fpcamera.current\n            eww.current.navigator.camera.tilt = 0\n          } else \n          if ( mode === 'arcball' && eww.current.navigator.camera instanceof WorldWind.FirstPersonCamera) {\n            copyParamCamera(eww.current.navigator.camera, abcamera.current)\n            abcamera.current.tilt = lastAbTilt.current\n            eww.current.navigator.camera = abcamera.current\n          }\n      }\n\n    \n\n    // callback from eww after frame rendering\n    const setGlobeStates = () => {\n        \n        let lo = eww.current.navigator.lookAtLocation.longitude\n        let la = eww.current.navigator.lookAtLocation.latitude\n        let al = eww.current.navigator.range\n        \n        // let vp = (al < 2000000?getViewPolygon():'')\n\n        // switchCamera((al <= 2000)?\"firstPerson\":\"arcBall\")\n\n        setCameraMode((al <= 1000)?\"firstperson\":\"arcball\")\n\n\n        \n        // setEwwState((ewwstate) => { return {...ewwstate, longitude:lo, latitude: la, altitude: al, viewpolygon: vp}}) \n\n    }\n\n    // handler for tap/click\n\n    const handleClick  = (recognizer) => {\n        // console.log('click')\n        let x = recognizer.clientX\n        let y = recognizer.clientY\n        // Perform the pick. Must first convert from window coordinates to canvas coordinates, which are\n        // relative to the upper left corner of the canvas rather than the upper left corner of the page.\n        let pickList = eww.current.pick(eww.current.canvasCoordinates(x, y));\n        console.log(pickList)\n        if (pickList.terrainObject()) {\n            // position = pickList.terrainObject().position;\n            // store list of selected footprints in a string for later comparison\n            eww.current.removeLayer(getLayerByName('quicklook') )\n            // de-highlight all rendereables\n            for (let i = 0; i < eww.current.layers.length; i++) {\n                if (eww.current.layers[i].displayName.includes('Products:')) {                    \n                    for (let j = 0; j < eww.current.layers[i].renderables.length; j++) {\n                        let renderable = eww.current.layers[i].renderables[j]\n                        renderable.highlighted = false\n                    }\n                }\n            }\n    \n            // ... and now highlight all picked rendereables\n            let pickedItems = []\n            for (let i = 0; i < pickList.objects.length; i++) {\n                if (pickList.objects[i].userObject instanceof WorldWind.SurfaceShape) {\n                    pickedItems.push(pickList.objects[i].userObject) \n                    pickList.objects[i].userObject.highlighted = !pickList.objects[i].userObject.highlighted\n                    \n                    addQuicklookWMS(pickList.objects[i].userObject)\n                }\n            }\n            console.log(pickedItems)\n            setEwwState((ewwstate) => { return {...ewwstate, pickedItems: pickedItems}})\n            eww.current.redraw()\n        } else {\n            console.log('No position !');\n            return;\n        }\n\n\n    }\n\n    const handleDoubleClick  = (recognizer) => {\n        console.log('double click')\n        let x = recognizer.clientX\n        let y = recognizer.clientY\n        let pickList = eww.current.pick(eww.current.canvasCoordinates(x, y));\n\n        let position;\n  \n  \n        // Get coordinates of clicked point and list of selected footprints. Do nothing if click done outside the globe.\n        if (pickList.terrainObject()) {\n            position = pickList.terrainObject().position;\n            // eww.current.goTo(new WorldWind.Location(position.latitude, position.longitude));\n\n            let point = \"POINT(\"+position.longitude+' '+position.latitude+\")\"\n            \n            setEwwState((ewwstate) => { return {...ewwstate, aoi: point}}) \n    \n        } else {\n              console.log('No position !');\n              setEwwState((ewwstate) => { return {...ewwstate, aoi: ''}})\n        }\n  \n        \n\n       \n    }\n\n    // useEffect(() => {\n    //     console.log(\"useEffect aoi: \" + aoi)\n    //     let newewwstate = {...ewwstate, aoi: aoi}\n    //     setEwwState(newewwstate)\n    // }, [aoi]); \n\n    \n    \n    // didMount effect\n    useLayoutEffect(() => {\n        console.log(\"Creating the world...\")\n\n        // to use DEM from Eox ESA Map server\n        var elevationModel = new WorldWind.ElevationModel();\n        elevationModel.addCoverage(new WorldWind.TiledElevationCoverage({\n            coverageSector: WorldWind.Sector.FULL_SPHERE,\n            resolution: 0.008333333333333,\n            retrievalImageFormat: \"image/x-aaigrid\",\n            minElevation: -11000,\n            maxElevation: 8850,\n            urlBuilder: new WorldWind.WcsTileUrlBuilder(\"https://dem.esa.maps.eox.at/elevation\", \"copdem\", \"2.0.1\")\n            }));\n        eww.current = new WorldWind.WorldWindow(id, elevationModel);\n        // setWwd(eww.current)\n\n        // Create 2 cameras as ref for later switching\n        // abcamera.current =  eww.current.navigator.camera.clone()\n        fpcamera.current = new WorldWind.FirstPersonCamera(eww.current)\n        abcamera.current = new WorldWind.ArcBallCamera(eww.current)\n        // fpcamera.current = eww.current.navigator.getAsFirstPersonCamera()\n        // eww.current.navigator.camera = fpcamera.current \n        \n\n\n        // eww.current = new WorldWind.WorldWindow(id);\n        eww.current.redrawCallbacks.push(setGlobeStates)\n\n\n        // Define a min/max altitude limit\n        // WorldWind.BasicWorldWindowController.prototype.applyLimits = function () {\n        //     eww.current.navigator.range = WorldWind.WWMath.clamp(eww.current.navigator.range, 1000, 100000000);\n        // }\n\n        // define click/tap recognisers\n        // let tapRecognizer = new WorldWind.TapRecognizer(eww.current, handleClick);\n        // tapRecognizer.numberOfTaps = 1;\n        // let doubleTapRecognizer = new WorldWind.TapRecognizer(eww.current, handleDoubleClick);\n        // doubleTapRecognizer.numberOfTaps = 2;\n        // doubleTapRecognizer.recognizeSimultaneouslyWith(tapRecognizer);\n\n        let clickRecognizer = new WorldWind.ClickRecognizer(eww.current, handleClick);\n        clickRecognizer.numberOfClicks = 1;\n        let doubleClickRecognizer = new WorldWind.ClickRecognizer(eww.current, handleDoubleClick);\n        doubleClickRecognizer.numberOfClicks = 2;\n        doubleClickRecognizer.recognizeSimultaneouslyWith(clickRecognizer);\n        doubleClickRecognizer.maxClickInterval = 200;\n\n        let tapRecognizer = new WorldWind.TapRecognizer(eww.current, handleClick);\n        tapRecognizer.numberOfTaps = 1;\n        let doubleTapRecognizer = new WorldWind.TapRecognizer(eww.current, handleDoubleClick);\n        doubleTapRecognizer.numberOfTaps = 2;\n        doubleTapRecognizer.recognizeSimultaneouslyWith(tapRecognizer);\n        doubleTapRecognizer.maxTapInterval = 200;\n\n\n\n        //setWwd(eww);\n        let wmsConfigBg_s2 = {\n            service: \"https://tiles.maps.eox.at/wms\",\n            layerNames: \"s2cloudless-2018\",\n            title: \"s2cloudless-2018\",\n            numLevels: 19,\n            format: \"image/png\",\n            size: 256,\n            sector: WorldWind.Sector.FULL_SPHERE,\n            levelZeroDelta: new WorldWind.Location(90, 90)\n        }\n        let wmsConfigBg_terrain = {\n            service: \"https://tiles.maps.eox.at/wms\",\n            layerNames: \"terrain\",\n            title: \"terrain\",\n            numLevels: 19,\n            format: \"image/png\",\n            size: 256,\n            sector: WorldWind.Sector.FULL_SPHERE,\n            levelZeroDelta: new WorldWind.Location(90, 90)\n        }\n    \n        let wmsConfigNames = {\n            service: \"https://tiles.maps.eox.at/wms\",\n            layerNames: \"overlay_bright\",\n            title: \"overlay_bright\",\n            numLevels: 19,\n            format: \"image/png\",\n            size: 256,\n            sector: WorldWind.Sector.FULL_SPHERE,\n            levelZeroDelta: new WorldWind.Location(90, 90)\n        }\n\n        WorldWind.configuration.baseUrl = WorldWind.configuration.baseUrl.slice(0,-3)\n\n        //let starFieldLayer = new WorldWindX.StarFieldLayer();\n        // let starFieldLayer = new WorldWind.StarFieldLayer();\n        let starFieldLayer = new StarFieldLayer();\n        let atmosphereLayer = new WorldWind.AtmosphereLayer('images/BlackMarble_2016_01deg.jpg');\n        // let atmosphereLayer = new WorldWind.AtmosphereLayer('images/BlackMarble_2016_3km.jpg');\n        \n        // atmosphereLayer.minActiveAltitude = 3000000\n\n        let quicklookLayer = new WorldWind.RenderableLayer('Quicklooks')\n    \n        let layers = [\n            { layer: new WorldWind.WmsLayer(wmsConfigBg_s2, \"\"), enabled: true },\n            { layer: new WorldWind.WmsLayer(wmsConfigBg_terrain, \"\"), enabled: false },\n            { layer: new WorldWind.WmsLayer(wmsConfigNames, \"\"), enabled: names },\n            { layer: starFieldLayer, enabled: starfield },\n            { layer: atmosphereLayer, enabled: atmo },\n            { layer: quicklookLayer, enabled: true },\n            { layer: modelsLayer, enabled: false }\n        ];\n    \n        for (let l = 0; l < layers.length; l++) {\n            layers[l].layer.enabled = layers[l].enabled;\n            eww.current.addLayer(layers[l].layer);\n        }\n        //let date = new Date();\n        starFieldLayer.time = new Date();\n        atmosphereLayer.time = new Date();\n        setTimeout(() => {\n            eww.current.goToAnimator.travelTime = 1000;\n            eww.current.goTo(new WorldWind.Position(clat, clon, alt));\n            eww.current.redraw();\n            }, 2000)\n    \n        eww.current.redraw();\n        eww.current.deepPicking = true;\n        // eww.current.orderedRenderingFilters.push(declutterByTime)\n    }, []); // effect runs only once\n    \n    useEffect(() => {\n        console.log(\"running effect cameramode\")\n        if(cameraMode) setCamera(cameraMode)\n    }, [cameraMode]); \n\n  \n  return { removeGeojson, addGeojson, addWMS, setStarfield, setAtmosphere, setTime, toggleProjection, setNames, toggleModel, toggleBg, northUp };\n}\n","import React, { useEffect} from 'react'\nimport './Earth.css'\nimport { useEww } from \"./useEww\"\nimport { useHotkeys } from 'react-hotkeys-hook'\n\n\n\n\n\n\nconst Earth = ({ viewdate, id, clat, clon, alt, starfield, atmosphere, names }) =>  {\nconsole.log(\"render Earth\")\n\n    const {\n        ewwstate,\n        addGeojson,\n        removeGeojson,\n        addWMS,\n        toggleProjection,\n        setAtmosphere,\n        setStarfield,\n        setNames,\n        toggleBg,\n        toggleModel,\n        setTime,\n        northUp\n    } = useEww({\n        id: id,\n        clat: clat,\n        clon: clon,\n        alt: alt,\n        starfield: starfield,\n        atmosphere: atmosphere,\n        names: names\n    })\n\n    useHotkeys(\"p\",toggleProjection)  \n    useHotkeys(\"c\",removeGeojson)\n    useHotkeys(\"u\",northUp)\n    useHotkeys(\"b\",toggleBg)\n    useHotkeys(\"m\",toggleModel)\n\n    useEffect(() => {\n        setTime(viewdate.getTime())\n    },[viewdate, setTime])\n\n    useEffect(() => {\n        setStarfield(starfield)\n    },[starfield])\n\n    useEffect(() => {\n        setNames(names)\n    },[names])\n\n    useEffect(() => {\n        setAtmosphere(atmosphere)\n    },[atmosphere])\n\n\n\n    let globeStyle = {\n        background: 'inherit',\n        position: \"fixed\",\n        left: 0,\n        width: '100%',\n        height: '100%'\n    };\n        \n    return (\n            <canvas id={id} style={globeStyle} />\n    );\n}\n\nexport default Earth\n","import React, {useState} from \"react\";\nimport {useSpring, animated} from 'react-spring'\nimport { useGesture } from 'react-use-gesture'\nimport \"./controlpanel.css\"\n\n// import MissionSelector from \"./missionselector\";\n\n\n\n\n\nfunction ControlPanel(props) {\n\n    const [open, setOpen] = useState(false)\n\n    const [{ mr },set] = useSpring(() =>({ mr:  -300 }))\n    const bind = useGesture( {\n        onDrag: ({ down, delta, vxvy }) => {\n            console.log(delta[0])\n            if(vxvy[0]>1 || (!down && delta[0] > 100)) {\n                set({\n                    mr: -300\n                })\n                setOpen( true)\n            } else {\n                set({\n                    mr: down?-Math.max(delta[0],0):0\n                })\n                setOpen( false)\n            }\n        },\n    })\n\n\n    return   (\n\n        <animated.div {...bind()} style={{ right: mr, top:0 }} className='ControlPanel'>\n            <div>\n                <img id='logo'className='Logo' src='./images/EOi_logo.png' alt='' onClick={()=>!open?set({mr:-300}):set({mr:0})} />\n            </div>\n            \n            {props.children}\n        \n        </animated.div>\n\n\n    )\n    \n}\n\nexport default ControlPanel\n","import React from 'react';\nimport dateFormat from \"dateformat\"\nimport './DateLabel.css';\n\nfunction DateLabel({date, highlight, animated}) {\n\n\n    return (\n        <div className='LabelContainer' >\n            <div className='Date'>\n                <div className={highlight!=='day' || highlight==='none'?'DayLabel':'DayLabel Highlighted'}  key='day'  >{dateFormat(date,'UTC:dd')}</div>\n                <div className='YearMonth'>\n                    <div className={highlight!=='month' || highlight==='none'?'MonthLabel ':'MonthLabel  Highlighted'}  key='month' >{dateFormat(date,'UTC:mmm').toUpperCase()}</div>\n                    <div className={highlight!=='year' || highlight==='none'?'YearLabel ':'YearLabel Highlighted'}  key='year' >{date.getUTCFullYear()}</div>\n                </div>\n            </div>\n            <div className={animated?'Line  Line-active':'Line'} key='line' ></div>\n            <div className='TimeLabel'>\n                <div className={highlight!=='hour' || highlight==='none'?'HourLabel ':'HourLabel Highlighted'} key='hour' >{dateFormat(date,'UTC:HH')} </div>\n                <div className='hourseparator'>:</div>\n                <div className='minseparator'>:</div>\n                <div className={highlight!=='minute' || highlight==='none'?'MinuteLabel ':'MinuteLabel Highlighted'} key='minute' >{dateFormat(date,'UTC:MM')}</div>\n                <div className={highlight!=='second' || highlight==='none'?'SecondLabel ':'SecondLabel Highlighted'} key='second' >{dateFormat(date,'UTC:ss')}</div>\n            </div>\n        </div>\n    )\n}\nexport default DateLabel\n","import React, { useRef} from 'react';\nimport './DateSelector.css';\n\nfunction DateSelectorScale({date, zoomfactor}) {\n\n    const scale = useRef()\n        \n    const scaleText = (_start, _zoom) => {\n        // console.log('_start: '+_start.toJSON()+'  zoom: '+_zoom)\n        if(!scale.current) return\n            \n        const monthcode = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC']\n        const YEAR_LEVEL = 1000*60*60*24*30*10\n        const MONTH_LEVEL = 1000*60*60*24*3\n        const DAY5_LEVEL = 1000*60*60*8\n        const DAY_LEVEL = 1000*60*70\n        const HOUR3_LEVEL = 1000*60*7\n        const HOUR_LEVEL = 1000*60*3\n        const MIN10_LEVEL = 1000*40\n        const MIN_LEVEL = 1000*2\n\n        function pad(number, length) {  \n            var str = '' + number;\n            while (str.length < length) {\n                str = '0' + str;\n            }           \n            return str;        \n        }\n\n\n        let day, month, hour, year, minute = 0\n        let lastday =0\n        let lastmonth = 0\n        let lastyear = 0\n        let lasthour = 0\n        let lastminute = 0\n        let tics = []    \n\n        for ( let i=0 ; i < scale.current.offsetHeight ; i+=1 ) {\n            let refdate = new Date( (i- scale.current.offsetHeight/2) * _zoom + _start.getTime()  )\n            day = refdate.getUTCDate()\n            month = refdate.getUTCMonth()\n            hour = refdate.getUTCHours()\n            year = refdate.getUTCFullYear()\n            minute = refdate.getUTCMinutes()\n\n            switch (true) {\n                case _zoom < MIN_LEVEL:\n                    if(minute !== lastminute) {\n                        if (minute !== 0 || hour !== 0) {\n                            tics.push({class:'HourTic', pos: i, label: pad(hour,2)+':'+pad(minute,2)})\n                        } else {\n                            if (minute === 0 && hour === 0) {\n                                tics.push({class:'DayTic_h', pos: i, label: day})\n                                tics.push({class:'MonthTic_h2', pos: i, label: monthcode[month]})\n                                //tics.push({class:'YearTic_h', pos: i, label: year})\n                            }     \n                        }\n                    }\n                break\n\n                case _zoom < MIN10_LEVEL:\n                    if(minute !== lastminute) {\n                        if( (minute !== 0 || hour !=0) && minute % 10 === 0) {\n                            tics.push({class:'HourTic', pos: i, label: pad(hour,2)+':'+pad(minute,2)})\n                        } else {\n                            if (minute === 0 && hour === 0) {\n                                tics.push({class:'DayTic_h', pos: i, label: day})\n                                tics.push({class:'MonthTic_h2', pos: i, label: monthcode[month]})\n                                //tics.push({class:'YearTic_h', pos: i, label: year})\n                            }     \n                        }\n                    }\n                break\n\n                case _zoom < HOUR_LEVEL:\n                    if(hour !== lasthour) {\n                        if (hour !== 0) {\n                            tics.push({class:'HourTic', pos: i, label: pad(hour,2)+':00'})\n                        \n                        } else  {\n                            tics.push({class:'DayTic_h', pos: i, label: day})\n                            tics.push({class:'MonthTic_h2', pos: i, label: monthcode[month]})\n                            // tics.push({class:'YearTic_h', pos: i, label: year})            \n                        }\n                    }\n                break\n\n                case _zoom < HOUR3_LEVEL:\n                    if(hour !== lasthour) {\n                        if (hour !== 0 &&  (hour % 3 === 0 )) {\n                            tics.push({class:'HourTic', pos: i, label: pad(hour,2)+':00'})\n                        } else  {\n                            if (hour === 0) {\n                                tics.push({class:'DayTic_h', pos: i, label: day})\n                                tics.push({class:'MonthTic_h2', pos: i, label: monthcode[month]})\n                                // tics.push({class:'YearTic_h', pos: i, label: year})            \n                            }\n                        }\n                    }    \n                break\n\n                case _zoom < DAY_LEVEL:\n                    if(day !== lastday) {\n                        if ( day !== 1 ) {\n                            tics.push({class:'DayTic', pos: i, label: day})\n                        } else {\n                            tics.push({class:'MonthTic_h', pos: i, label: monthcode[month]})\n                            if (month === 0) tics.push({class:'YearTic_h2', pos: i, label: year})\n                            // tics.push({class:'YearTic_h2', pos: i, label: year})\n                         }\n                        \n                    }    \n                break\n\n                case _zoom < DAY5_LEVEL:\n                    if(day !== lastday) {\n                        if ( day !== 1 && day !== 30 && day % 5 === 0 ) {\n                            tics.push({class:'DayTic', pos: i, label: day})\n                        } else {\n                            if (day == 1) {\n                                // tics.push({class:'DayTic', pos: i, label: day})\n                                tics.push({class:'MonthTic_h', pos: i, label: monthcode[month]})\n                                if (month === 0) tics.push({class:'YearTic_h2', pos: i, label: year})\n                                // tics.push({class:'YearTic_h2', pos: i, label: year})\n                            }\n                         }\n                        \n                    }    \n\n                break\n\n                case _zoom < MONTH_LEVEL:\n                    if( month !== lastmonth ) {\n                        if (month !== 0) {\n                            tics.push({class:'MonthTic', pos: i, label: monthcode[month]})\n                        } else {\n                            tics.push({class:'MonthTic_h', pos: i, label: monthcode[month]})\n                            tics.push({class:'YearTic_h2', pos: i, label: year})\n                        }\n                    }\n    \n                break\n\n                case _zoom < YEAR_LEVEL:\n                    if(year !== lastyear ) {\n                        if (month !== 0) {\n                            tics.push({class:'MonthTic', pos: i, label: monthcode[month]})\n                        } else {\n                            // tics.push({class:'MonthTic', pos: i, label: month})\n                            tics.push({class:'YearTic', pos: i, label: year})\n                        }\n                    }\n    \n                break\n\n                default:\n                break\n            }\n            lastday = day\n            lastyear = year\n            lastmonth = month\n            lasthour = hour\n            lastminute = minute\n        }\n      \n        return tics.map(item => ( <div className={item.class} key={item.class+item.pos} style={{top:item.pos}}>{item.label}</div>))\n    }\n\n    return (\n        <div ref={scale} className='DateSelectorScale' >\n            {(scaleText(date,zoomfactor))}\n        </div>\n    )\n}\nexport default DateSelectorScale\n","import React, {useState, useEffect, useRef} from 'react'\nimport {useSpring} from 'react-spring'\nimport { useGesture } from 'react-use-gesture'\nimport { add, sub, scale } from 'vec-la'\nimport DateSelectorScale from './DateSelectorScale'\n\nimport './DateSelector.css';\n// import { start } from 'repl';\n\nfunction DateSelector({startdate, increment, incrementSpeed, onDateChange, onFinalDateChange, onStepChange}) {  /// add increment: true\\false and incrementStep. controller will set this props\n\n    const MAXZOOM = 1000*60*60*24*15\n    const MINZOOM = 1000\n    const DEFZOOM = 1000*60*60\n    \n    const selector = useRef()\n    const lastZoom = useRef()\n    if(!lastZoom.current) lastZoom.current = DEFZOOM\n\n    \n    const [scaledate, setScaledate ] = useState(startdate)\n    // const debouncedScaledate = useDebounce(scaledate, 10);\n    \n\n    const [lastStartdate, setlLastStartdate ] = useState(startdate)\n    \n    const [active, setActive ] = useState(false)\n    const [step, setStep ] = useState(60000)\n    const [stepLabel, setStepLabel ] = useState('hour')\n\n    // zoomfactor: how long is a pixel in ms\n    const [zoomfactor, setZoomfactor ] = useState(DEFZOOM)\n    if (!lastZoom.current) lastZoom.current = DEFZOOM\n\n    // to detect double taps\n    const lastTap = useRef()\n    const doubleTap = useRef()\n\n\n    const handleDoubleTap = () => {\n        const now = Date.now();\n        if (lastTap.current && (now - lastTap.current) < 300) {\n            doubleTap.current = true\n        } else {\n            lastTap.current = now\n            doubleTap.current = false\n        }\n    }\n\n\n    const [{ posxy_drag}, setyOnDrag] = useSpring(() => ({ posxy_drag: [0,0]  }))\n    const [{ xy2 }, sety2, stop2] = useSpring(() => ({ xy2: [0,0] }))\n    const [{ posxy_wheel }, setyOnWheel, stop] = useSpring(() => ({posxy_wheel: [0,0] }))\n    // const [{ zoom }, setz] = useSpring(() => ({ zoom: DEFZOOM }))\n\n\n    \n    const bind = useGesture({\n\n        onDragEnd: () => {\n                lastZoom.current = zoomfactor\n        },\n\n        onWheel: ( {delta, movement, shiftKey, first,  direction, down, last, wheeling, memo = {\n            lastposxy: posxy_wheel.getValue()\n            }\n        }) => {\n            if (first) {\n                stop()\n                setActive(true)\n                setlLastStartdate(scaledate)\n            }\n            let zoom\n            if ( shiftKey) {\n                zoom = zoomfactor - zoomfactor / 5 * direction[0]\n                if (zoom < MINZOOM) zoom = MINZOOM\n                if (zoom > MAXZOOM) zoom = MAXZOOM\n                setZoomfactor(zoom)\n                if(!down) setActive(false)\n                return memo\n            }\n\n\n            setyOnWheel({                 \n                // posxy_wheel: add(movement,memo.lastposxy), // must be cummulative\n                // posxy_wheel: scale(movement,0.1), // must be cummulative\n                posxy_wheel:movement,\n                // immediate: (Math.abs(movement[1])<500), \n                immediate: true,\n                // config: { },\n                // reset: true,\n                onFrame: ()=>{\n                        let factor = Math.ceil(posxy_wheel.getValue()[1] * zoomfactor  / step)\n                        if (factor == 0 && movement[1] <= 0) factor = -1\n                        if (factor == 0 && movement[1] >= 0) factor = 1\n\n                        let nd = lastStartdate.getTime() + factor * step\n                        let newdate = new Date(nd)\n                        setScaledate(newdate)\n                        onDateChange(newdate)\n\n                    // setlLastStartdate(newdate)\n                },\n                onRest: ()=>{\n                    let factor = Math.ceil(posxy_wheel.getValue()[1] * zoomfactor  / step)\n                    if (factor == 0 && movement[1] <= 0) factor = -1\n                    if (factor == 0 && movement[1] >= 0) factor = 1\n\n                    let nd = lastStartdate.getTime() + factor * step\n                    let newdate = new Date(nd)\n\n                    setScaledate(newdate)\n                    onDateChange(newdate)\n                    onFinalDateChange(newdate)\n                    setlLastStartdate(newdate)\n                    if(last) {\n                        posxy_wheel.setValue([0,0])\n                        setActive(false)\n                    }\n                }\n            })\n            return memo\n\n        },\n\n        onDrag: ({  event, first, direction,down, movement, delta, velocity, shiftKey }) => {\n            //event.preventDefault()\n            let zoom\n\n            if (first) {\n                console.log('shiftKey: '+shiftKey)\n                setActive(true)\n                handleDoubleTap()\n                setlLastStartdate(scaledate)\n            }\n\n            if (doubleTap.current || shiftKey) {\n\n                zoom = zoomfactor - zoomfactor / 50 * ( delta[1] )\n                if (zoom < MINZOOM) zoom = MINZOOM\n                if (zoom > MAXZOOM) zoom = MAXZOOM\n                setZoomfactor(zoom)\n                // temp.xy = [0,0]\n                if(!down) setActive(false)\n                return\n            }\n\n            velocity = (Math.abs(velocity)<.2)?0:velocity  \n\n            setyOnDrag({                 \n                posxy_drag: movement, \n                immediate: down, \n                config: { velocity: scale(direction, velocity), decay: true},\n                onFrame: ()=>{\n                    // console.log('y / deltay:  '+xy.getValue()[1]+'/ '+delta[1])\n                    if (!first) {\n                        let nd = lastStartdate.getTime() - Math.ceil(posxy_drag.getValue()[1] * zoomfactor  / step) * step\n                        let newdate = new Date(nd)\n                        setScaledate(newdate)\n                        onDateChange(newdate)\n                        }\n\n                    // setlLastStartdate(newdate)\n                },\n                onRest: ()=>{\n                    if (!down) {\n                        let nd = lastStartdate.getTime() - Math.ceil(posxy_drag.getValue()[1] * zoomfactor  / step) * step\n                        let newdate = new Date(nd)\n                        setScaledate(newdate)\n                        onDateChange(newdate)\n\n                        onFinalDateChange(newdate)\n                        setlLastStartdate(newdate)\n                        setActive(false)\n\n                    }\n                }\n            })\n\n        }\n    },\n    {\n        // wheel: {\n        //     initial: () => [0,0]\n        // }\n    }\n    )\n\n\n    const moveToDate = (startdate) => {\n\n        if (!active) {\n            let deltaoffset = [0,(lastStartdate.getTime() - startdate.getTime())  / zoomfactor]\n\n            // setActive(true)\n            stop2()\n            sety2({ \n                xy2: deltaoffset,\n                immediate: false, \n                config: {reset: true },\n                onFrame: ()=>{\n                    let newdate = new Date(lastStartdate.getTime() - xy2.getValue()[1] * zoomfactor)\n                    setScaledate(newdate)\n                    onDateChange(newdate)\n                },\n                onRest: ()=>{\n                     let newdate = new Date(lastStartdate.getTime() - xy2.getValue()[1] * zoomfactor)\n                    xy2.setValue([0,0])\n                    setScaledate(newdate)\n                    onDateChange(newdate)\n                    setlLastStartdate(newdate)\n                    onFinalDateChange(newdate)\n                    // setActive(false)\n                }\n            })\n        } \n\n    }\n\n    useEffect(() => {\n        if(!active) {\n            console.log('DateSelector moving date to: '+startdate.toJSON())\n            moveToDate(startdate)\n        }\n    },[startdate])\n\n    // useEffect(() => {\n    //     console.log('laststartdate changed: '+lastStartdate.toJSON())\n    // },[lastStartdate])\n\n    useEffect(() => {\n        console.log('Selector active: '+active)\n    },[active])\n\n\n    useEffect(() => {\n        onStepChange(stepLabel)\n    },[stepLabel])\n\n    useEffect(() => {\n        switch (true) {\n            case zoomfactor > 120426316:\n                setStep(1000*60*60*24*30)\n                setStepLabel('month')\n                break\n            case zoomfactor > 14544702:\n                setStep(1000*60*60*24)\n                setStepLabel('day')\n                break\n            case zoomfactor > 735259:\n                setStep(1000*60*60)\n                setStepLabel('hour')\n                break\n            case zoomfactor > 32274:\n                setStep(1000*60)\n                setStepLabel('minute')\n                break\n            default:\n                setStep(1000)\n                setStepLabel('second')\n        }\n    },[zoomfactor])\n\n    \n\n\n    return (\n        <div {...bind()} className='DateSelector' ref={selector} >\n            <div className=\"Mask\"  >\n\n                <DateSelectorScale className='scale' date={scaledate} zoomfactor={zoomfactor} step={step}></DateSelectorScale>\n                \n                <div className=\"TriangleContainer\" >\n                    <svg height=\"40\" width=\"20\" className=\"Triangle\">\n                        <polygon points=\"20,5 20,35 12,20\" />   \n                    </svg> \n                </div>        \n            </div>\n\n        </div>\n                                  )\n}\nexport default DateSelector\n","import React, {useState, useEffect} from 'react';\nimport DateLabel from './components/datelabel'\nimport DateSelector from './components/dateselector'\n\n\nfunction DateManager({startdate, onDateChange, onFinalDateChange, animated}) {\n\n    // const [selectorStartdate, setSelectorStartdate] = useState(startdate)\n    const [dateLabelHighlight,setDateLabelHighlight] = useState(1)\n    const [dateLabelDate,setDateLabeDate] = useState(startdate)\n\n    const handleSelectorDateChange = (date) => {\n        setDateLabeDate(date)\n        onDateChange(date)\n    }\n\n    const handleSelectorFinalDateChange = (date) => {\n        // console.log('handleSelectorFinalDateChange:' + date.toJSON())\n        onFinalDateChange(date)\n    }\n\n    // useEffect(() => {\n    //     setSelectorStartdate(startdate)\n    // },[startdate]);\n\n\n\n    return (\n        <div >\n          <DateLabel date={dateLabelDate} animated={animated} highlight={dateLabelHighlight}/>\n          <DateSelector startdate={startdate} \n                onDateChange={handleSelectorDateChange} \n                onFinalDateChange={handleSelectorFinalDateChange} \n                onStepChange={setDateLabelHighlight}/>\n        </div>\n    ) \n}\nexport default DateManager","\nimport React, {  useGlobal, useState, useEffect } from 'reactn';\n\nimport DateManager from \"../components/datemanager\"\n\nfunction CDateManager() {\n\n    const [viewDate, setViewDate] = useGlobal('viewDate')\n    const [searchDate, setSearchDate] = useGlobal('searchDate')\n    const [searching, setSearching] = useGlobal('searching')\n    const [increment, ] = useGlobal('increment')\n    const [incrementSpeed, ] = useGlobal('incrementSpeed')\n    const [dateManagerDate, setDdateManagerDate] = useGlobal('dateManagerDate')\n\n\n    return (\n        <DateManager startdate={dateManagerDate} increment={increment} incrementSpeed={incrementSpeed} onDateChange={setViewDate} onFinalDateChange={setSearchDate} animated={searching}/>\n     )\n}\n\nexport default CDateManager;\n\n","import { useState, useEffect, useRef } from \"react\";\n\n\nexport function useDateIncrementor({ autoStart, initdate }) {\n    // console.log('useClock renders')\n    //const { autoStart, duration } = settings || {};\n  \n    // let initDate = startdate\n    const [date, setDate] = useState(initdate)\n    // const [playing, setPlaying] = useState()\n    // const [stepstate, setStepstate] = useState(1000*60*60)\n    // const [refreshrate, setrefreshrate] = useState(200)\n    const playing = useRef()\n\n    const refreshrate = useRef() \n    // step.current = 1000*60*60\n    refreshrate.current = 1000\n\n    const step = useRef()\n    if(!step.current) step.current = refreshrate.current\n    \n    const ldate = useRef()\n    if(!ldate.current) ldate.current = initdate.getTime()\n\n      // Control functions\n    const intervalRef = useRef()\n    \n\n    // function increaseSpeed() {\n    //     setStep ( () => {\n    //         let newstate = (step > 0)? step * 2:step / 2\n    //         if(Math.abs(newstate) < refreshrate) newstate = refreshrate\n    //         return newstate\n    //     })\n    // }\n    // function decreaseSpeed() {\n    //     setStep (() => {\n    //         let newstate = (step > 0)? step / 2:step * 2\n    //         if(Math.abs(newstate) < refreshrate) newstate = refreshrate\n    //         return newstate\n    //     })\n    // }\n    function increaseSpeed() {\n        // stop()\n        step.current = (step.current > 0)? step.current *= 2:step.current /= 2\n        if(Math.abs(step.current) < refreshrate.current) step.current = refreshrate.current\n        console.log('step: '+step.current)\n        // setStepstate((st)=>st*2)\n        // start()\n    }\n    function decreaseSpeed() {\n        step.current = (step.current > 0)? step.current /= 2:step.current *= 2\n        if(Math.abs(step.current) < refreshrate.current) step.current = -1 * refreshrate.current\n        console.log('step: '+step.current)\n        // setStepstate((st)=>st/2)\n    }\n\n    function togglePause(date) {\n        if (playing.current) {\n            stop()\n        } else {\n            start(date)\n        }\n    }\n\n    function increment() {\n        ldate.current += step.current\n        // console.log(\"incrementing: \"+ ldate.current+\" / \"+step.current)\n\n        // setDate(new Date(initdate.getTime()+step.current))\n\n        setDate(new Date(ldate.current))\n\n    }\n    \n    function start() {\n        console.log('start clock')\n        // ldate.current = date.getTime()\n        playing.current = true\n        intervalRef.current = setInterval( \n            increment,\n            // ()=>{\n            // ldate.current += step.current\n            // console.log(\"incrementing: \"+ ldate.current)\n    \n            // setDate(new Date(ldate.current))},\n            refreshrate.current\n        )\n        \n        \n\n    }\n    \n    function stop() {\n        console.log('stop clock')\n        if (intervalRef.current) clearInterval(intervalRef.current)\n        playing.current = false\n    }\n    \n\n    function reset() {\n        stop()\n        ldate.current = new Date().getTime()\n        setDate(new Date(ldate.current))\n\n    }\n\n     \n    function forceDate(newdate) {\n        console.log('forcedate useclock: '+newdate.toJSON())\n        ldate.current = newdate.getTime()\n        setDate(new Date(ldate.current))\n    }\n\n    useEffect(() => {\n        console.log('dateIncrementor date changed '+initdate.toJSON())\n        if (!playing.current) {\n            console.log(\"changing\")\n            ldate.current = initdate.getTime()        \n        }\n    }, [initdate])\n\n\n\n    // didMount effect\n    // useEffect(() => {\n    //     console.log('render useclock')\n    //     // setDate((new Date()).getTime())\n    //     ldate.current = new Date().getTime()\n    //     if (autoStart) {\n    //         start();\n    //     }\n    //     //return reset;\n    // }, [autoStart]);\n\n  \n  return { date, playing, togglePause, reset,  increaseSpeed, decreaseSpeed, forceDate };\n}\n","import React, {useEffect, useRef, useState} from 'react';\nimport { useDateIncrementor } from \"./useDateIncrementor\"\nimport { useHotkeys } from 'react-hotkeys-hook'\n\n\nimport './DateController.css';\n\nfunction DateController({ initdate, onDateChange}) {\n\n    const [startingDate, setStartingDate] = useState(initdate)\n\n    // useClock must be redone to support real time increments\n    const {\n        date,\n        playing,\n        togglePause,\n        reset,\n        increaseSpeed,\n        decreaseSpeed,\n        forceDate\n    } = useDateIncrementor({\n        initdate: startingDate\n    })\n\n\n\n    useHotkeys(\"t\",togglePause)\n    useHotkeys(\"r\",reset)\n    // useHotkeys(\"r\",()=>{reset() })\n    useHotkeys(\".\",increaseSpeed)\n    useHotkeys(\",\",decreaseSpeed)\n\n    \n\n\n    useEffect(() => {\n        if(date) {\n            console.log(\"date from useDateIncrementor: \"+date.toJSON())\n            onDateChange(date)\n        }\n    },[date, playing]);\n\n    // useEffect(() => {\n    //     console.log(\"initdate changed: \"+initdate.toJSON())\n    //     forceDate(initdate)\n    // },[initdate]);\n\n    const lastTap = useRef()\n    const handleClick = () => {\n        const now = Date.now();\n        if (lastTap.current && (now - lastTap.current) < 300) {\n          reset();\n        } else {\n            lastTap.current = now\n            // togglePause()\n        }\n      }\n\n\n    return (\n        <div className='DateController' onClick={handleClick}/>\n    )\n}\nexport default DateController\n","\nimport React, {  useGlobal, useState, useEffect } from 'reactn';\n\nimport DateController from \"../components/datecontroller\"\n\nfunction CDateController() {\n\n    const [viewDate, setViewDate] = useGlobal('viewDate')\n    const [dateManagerDate, setDateManagerDate] = useGlobal('dateManagerDate')\n    const [searchDate, setSearchDate] = useGlobal('searchDate')\n    const [searching, setSearching] = useGlobal('searching')\n\n    const [dateControllerDate, setDateControllerDate] = useState(searchDate)\n\n    useEffect(() => {\n        console.log(\"initdate changed: \"+searchDate.toJSON())\n        setDateControllerDate(searchDate)\n    },[searchDate]);\n\n    const handleControllerDateChange = (date) => {\n        setDateManagerDate(date)\n        // setDateControllerDate(date)\n    }\n\n\n    return (\n        <DateController initdate={dateControllerDate} onDateChange={handleControllerDateChange}/>\n     )\n}\n\nexport default CDateController;\n\n","import React, { useState, useEffect } from \"react\";\n\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport './MissionSelector.css'\n\n\n// should use a prop\n\nfunction MissionSelector({initialmission, onMissionChange}) {\n\n\n    const [mission, setMission] = useState(initialmission)\n    \n    useHotkeys(\"1\",()=>{setMission('S1')}) \n    useHotkeys(\"2\",()=>{setMission('S2')}) \n    useHotkeys(\"3\",()=>{setMission('S3')}) \n    useHotkeys(\"5\",()=>{setMission('S5P')}) \n    useHotkeys(\"6\",()=>{setMission('ENVISAT')})\n\n    useEffect(() => {\n        console.log('Mission changed to: '+ mission)\n        onMissionChange(mission)\n    }, [mission, onMissionChange]);\n    \n    \n    //console.log('mission rendering')\n    return (\n        <div className='MissionSelector'>\n            <div className='Circle'><img className='MissionIcon' src='./images/s1_black.png' alt='' onClick={() => setMission('S1')} /></div>\n            <div className='Circle'><img className='MissionIcon' src='./images/s2_black.png' alt='' onClick={() => setMission('S2')} /></div>\n            <div className='Circle'><img className='MissionIcon' src='./images/s3_black.png' alt='' onClick={() => setMission('S3')} /></div>\n            <div className='Circle'><img className='MissionIcon' src='./images/s5p_black.png' alt='' onClick={() => setMission('S5P')} /></div>\n           \n            \n        </div>\n    )\n}\n\nexport default MissionSelector;\n","import React, {  useGlobal } from 'reactn';\n\nimport MissionSelector from \"../components/missionselector\"\n\nfunction CMissionSelector() {\n\n    const [mission, setMission] = useGlobal('mission')\n\n    return (\n        <MissionSelector initialmission={mission} onMissionChange={setMission}></MissionSelector> \n     )\n}\n\nexport default CMissionSelector;\n","import React, { useState, useEffect } from \"react\";\n\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport './MapSelector.css'\n\n\n// should use a prop\n\nfunction MapSelector({onMapSettingsChange}) {\n\n\n    const [mapSettings, setMapSettings] = useState({starfield: true, names: true, atmosphere: true})\n    const toggleAtmosphere = () => setMapSettings((mapSettings)=>({...mapSettings, atmosphere:!mapSettings.atmosphere}))\n    const toggleStarfield = () => setMapSettings((mapSettings)=>({...mapSettings, starfield:!mapSettings.starfield}))\n    const toggleNames = () => setMapSettings((mapSettings)=>({...mapSettings, names:!mapSettings.names}))\n\n    useHotkeys(\"a\",toggleAtmosphere)  \n    useHotkeys(\"s\",toggleStarfield)  \n    useHotkeys(\"n\",toggleNames)  \n\n    useEffect(() => {\n        onMapSettingsChange(mapSettings)\n    }, [mapSettings, onMapSettingsChange]);\n\n\n    \n    //console.log('mission rendering')\n    return (\n        <div className='MapSelector'>\n            <div className='CircleButton'><img className='MapIcon' draggable=\"false\" src='./images/atmosphere.png' alt='' onClick={toggleAtmosphere} /></div>\n            <div className='CircleButton'><img className='MapIcon' draggable=\"false\" src='./images/starfield.png' alt='' onClick={toggleStarfield} /></div>\n            <div className='CircleButton'><img className='MapIcon' draggable=\"false\" src='./images/names.png' alt='' onClick={toggleNames} /></div>\n           \n        </div>\n    )\n}\n\nexport default MapSelector;\n","import React, {  useGlobal } from 'reactn';\n\nimport MapSelector from \"../components/mapselector\"\n\nfunction CMapSelector() {\n\n    // const [starfield, setStarfield] = useGlobal('starfield')\n    // const [atmosphere, setAtmosphere] = useGlobal('atmosphere')\n    // const [names, setNames] = useGlobal('names')\n\n    const [, setMapSettings] = useGlobal('mapSettings')\n\n    return (\n        <MapSelector onMapSettingsChange={setMapSettings}></MapSelector> \n     )\n}\n\nexport default CMapSelector;\n","import React, {useState, useEffect, useRef} from 'react';\nimport { useGlobal } from 'reactn';\n\nimport './App.css'\nimport Earth from '../earth'\n// import DateManager from '../datemanager'\nimport { useHotkeys } from 'react-hotkeys-hook'\nimport ControlPanel from \"../controlpanel\";\nimport CDateManager from \"../../containers/DateManagerContainer\";\nimport CDateController from \"../../containers/DateControllerContainer\";\n\nimport CMissionSelector from \"../../containers/MissionSelectorContainer\";\nimport CMapSelector from \"../../containers/MapSelectorContainer\";\n\n// import useToggle from 'react-use/lib/useToggle'\nimport Fullscreen from \"react-full-screen\"\nimport { useFullscreen } from '@straw-hat/react-fullscreen'\n\n\nfunction App() {\n    \n\n    const [ mission,  ] = useGlobal('mission');\n    const [ mapSettings, ] = useGlobal('mapSettings')\n    const [ viewDate,  ] = useGlobal('viewDate');\n    const [ searchDate,  ] = useGlobal('searchDate');\n  \n\n\n    // useEffect(() => {\n    //     console.log('View Date: '+viewDate.toJSON())\n    //     // setselectorStartdate(startdate)\n    // },[viewDate])\n\n\n      \n    useEffect(() => {\n        console.log('Search Date: '+searchDate.toJSON())\n    },[searchDate])\n    \n    const [isFull,setIsfull] = useState(false)\n    const { isFullscreen, toggleFullscreen } = useFullscreen(window.document.body);\n    useHotkeys(\"f\",toggleFullscreen) \n\n\n    return (\n        <div className=\"App\" >\n            <Fullscreen enabled={isFull} onChange={() =>  {if(!isFullscreen) setIsfull(false)} }>\n                <div className=\"Earth\">\n                    <Earth viewdate={viewDate} id=\"globe\" starfield={mapSettings.starfield} atmosphere={mapSettings.atmosphere} names={mapSettings.names}  clon='0.5' clat='40' />\n                </div>\n                {/* <DateManager startdate={startdate} onDateChange={changeDate} onFinalDateChange={finalChangeDate} animated={searching}/> */}\n                <CDateManager/>\n                <CDateController/>\n                <ControlPanel active=\"true\">\n                <CMissionSelector></CMissionSelector>\n                <CMapSelector ></CMapSelector>\n                </ControlPanel>\n                <div className='MissionLabel'>{mission}</div>\n            </Fullscreen>\n        </div>\n    )\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { setGlobal } from 'reactn';\n\n\nexport  function initGlobalStates() {\n    console.log(\"init global: \"+(new Date()).getTime())\n\n    // Set current time as global state\n    // setGlobal({appdate: ((new Date()).getTime())})\n    // setGlobal({searchepoch: ((new Date()).getTime())})\n    // setGlobal({mission: 'S1'})\n    // setGlobal({searching: false})\n    // setGlobal({apppolygon: ''})\n    // setGlobal({replace: true})\n    // setGlobal({startend: {start:0, end:0}})\n    // setGlobal({setApppickeditems: []})\n\n\n    setGlobal({\n        mission: 'S1',\n        mapSettings: {\n            atmosphere: true,\n            starfield: true,\n            names: true\n        },\n        viewDate: new Date(),\n        searchDate: new Date(),\n        controllerDate: new Date(),\n        dateManagerDate: new Date(),\n        incrementSpeed: 1,\n        increment: false\n    })\n    \n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/app';\nimport * as serviceWorker from './serviceWorker';\n\n\nimport {initGlobalStates} from \"./initGlobalStates\"\n\ninitGlobalStates()\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}