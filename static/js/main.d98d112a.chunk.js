(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){},27:function(e,t,a){e.exports=a(43)},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(23),o=a.n(i),s=(a(33),a(3)),c=(a(34),a(35),a(14)),l=a.n(c),u=a(19),g=a(18),h=a(10),d=a(2),f=a.n(d),m=a(4),b=a(8),E=a(6),S=a(5),p=a(7),v=f.a.Angle,_=f.a.ArgumentError,M=f.a.Logger,y={getAsGeographicLocation:function(e){if(e instanceof Date===!1)throw new _(M.logMessage(M.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var t=this.getAsCelestialLocation(e);return this.celestialToGeographic(t,e)},getAsCelestialLocation:function(e){if(e instanceof Date===!1)throw new _(M.logMessage(M.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var t=this.computeJulianDate(e)-2451545,a=this.normalizeAngle360(280.46+.9856474*t),n=this.normalizeAngle360(357.528+.9856003*t)*v.DEGREES_TO_RADIANS,r=a+1.915*Math.sin(n)+.02*Math.sin(2*n),i=r*v.DEGREES_TO_RADIANS,o=(23.439-4e-7*t)*v.DEGREES_TO_RADIANS,s=Math.asin(Math.sin(o)*Math.sin(i))*v.RADIANS_TO_DEGREES,c=Math.atan(Math.cos(o)*Math.tan(i))*v.RADIANS_TO_DEGREES;return r>=90&&r<270&&(c+=180),{declination:s,rightAscension:c=this.normalizeAngle360(c)}},celestialToGeographic:function(e,t){if(!e)throw new _(M.logMessage(M.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(t instanceof Date===!1)throw new _(M.logMessage(M.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var a=this.computeJulianDate(t)-2451545,n=this.normalizeAngle360(280.46061837+360.98564736629*a),r=this.normalizeAngle360(n-e.rightAscension),i=v.normalizedDegreesLongitude(-r);return{latitude:e.declination,longitude:i}},computeJulianDate:function(e){if(e instanceof Date===!1)throw new _(M.logMessage(M.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var t=e.getUTCFullYear(),a=e.getUTCMonth()+1,n=e.getUTCDate(),r=(e.getUTCHours()+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24;a<=2&&(t-=1,a+=12);var i=Math.trunc(t/100),o=2-i+Math.trunc(i/4);return Math.trunc(365.25*(t+4716))+Math.trunc(30.6001*(a+1))+n+o-1524.5+r},normalizeAngle360:function(e){var t=e%360;return t>=0?t:t<0?360+t:360-t}},R=f.a.Angle,w={SUN:0,MERCURY:1,VENUS:2,MARS:4,JUPITER:5,SATURN:6,URANUS:7,NEPTUNE:8,getCelestialLocation:function(e,t){var a,n=y.computeJulianDate(t)-2451543.5;switch(e){case this.SUN:a=this.computeSun(n);break;case this.MERCURY:a=this.computeMercury(n);break;case this.VENUS:a=this.computeVenus(n);break;case this.MARS:a=this.computeMars(n);break;case this.JUPITER:a=this.computeJupiter(n);break;case this.SATURN:a=this.computeSaturn(n);break;case this.URANUS:a=this.computeUranus(n);break;case this.NEPTUNE:a=this.computeNeptune(n)}return this.computePosition(n,a)},computeMercury:function(e){return{N:48.3313+324587e-10*e,i:7.0047+5e-8*e,w:29.1241+101444e-10*e,a:.387098,e:.205635+5.59e-10*e,M:168.6562+4.0923344368*e}},computeVenus:function(e){return{N:76.6799+24659e-9*e,i:3.3946+2.75e-8*e,w:54.891+138374e-10*e,a:.72333,e:.006773-1.302e-9*e,M:48.0052+1.6021302244*e}},computeMars:function(e){return{N:49.5574+211081e-10*e,i:1.8497-1.78e-8*e,w:286.5016+292961e-10*e,a:1.523688,e:.093405+2.516e-9*e,M:18.6021+.5240207766*e}},computeJupiter:function(e){return{N:100.4542+276854e-10*e,i:1.303-1.557e-7*e,w:273.8777+164505e-10*e,a:5.20256,e:.048498+4.469e-9*e,M:19.895+.0830853001*e}},computeSaturn:function(e){return{N:113.6634+23898e-9*e,i:2.4886-1.081e-7*e,w:339.3939+297661e-10*e,a:9.55475,e:.055546-9.499e-9*e,M:316.967+.0334442282*e}},computeUranus:function(e){return{N:74.0005+13978e-9*e,i:.7733+1.9e-8*e,w:96.6612+30565e-9*e,a:19.18171-1.55e-8*e,e:.047318+7.45e-9*e,M:142.5905+.011725806*e}},computeNeptune:function(e){return{N:131.7806+30173e-9*e,i:1.77-2.55e-7*e,w:272.8461-6027e-9*e,a:30.05826+3.313e-8*e,e:.008606+2.15e-9*e,M:260.2471+.005995147*e}},computeSun:function(e){return{N:0,i:0,w:282.9404+470935e-10*e,a:1,e:.016709-1.151e-9*e,M:356.047+.9856002585*e}},computePosition:function(e,t){var a=t.N,n=t.i,r=t.w,i=t.a,o=t.e,s=t.M;a=y.normalizeAngle360(a)*R.DEGREES_TO_RADIANS,n=y.normalizeAngle360(n)*R.DEGREES_TO_RADIANS,r=y.normalizeAngle360(r)*R.DEGREES_TO_RADIANS;var c=(s=y.normalizeAngle360(s)*R.DEGREES_TO_RADIANS)+o*Math.sin(s)*(1+o*Math.cos(s));if(o>=.06)for(var l=0;l<10;l++){var u=c-(c-o*Math.sin(c)-s)/(1-o*Math.cos(c));if(Math.abs(u-c)<.001){c=u;break}c=u}var g=i*(Math.cos(c)-o),h=i*(Math.sqrt(1-o*o)*Math.sin(c)),d=Math.atan2(h,g),f=Math.sqrt(g*g+h*h),m=f*(Math.cos(a)*Math.cos(d+r)-Math.sin(a)*Math.sin(d+r)*Math.cos(n)),b=f*(Math.sin(a)*Math.cos(d+r)+Math.cos(a)*Math.sin(d+r)*Math.cos(n)),E=f*(Math.sin(d+r)*Math.sin(n)),S=382394e-10*(0-e)*R.DEGREES_TO_RADIANS,p=Math.atan2(b,m)+S,v=Math.atan2(E,Math.sqrt(m*m+b*b));m=f*Math.cos(p)*Math.cos(v),b=f*Math.sin(p)*Math.cos(v),E=f*Math.sin(v);var _=this.getLonSun(e,this.computeSun(e)),M=_.lonsun,w=_.rsun;M*=R.RADIANS_TO_DEGREES,M=y.normalizeAngle360(M)*R.DEGREES_TO_RADIANS;var O=m+w*Math.cos(M),A=b+w*Math.sin(M),L=E,D=y.normalizeAngle360(23.4393-3.563e-7*e)*R.DEGREES_TO_RADIANS,j=O,T=A*Math.cos(D)-L*Math.sin(D),P=A*Math.sin(D)+L*Math.cos(D);return{ra:y.normalizeAngle360(Math.atan2(T,j)*R.RADIANS_TO_DEGREES),dec:Math.atan2(P,Math.sqrt(j*j+T*T))*R.RADIANS_TO_DEGREES}},getLonSun:function(e,t){var a=t.w,n=t.e,r=t.M;a=y.normalizeAngle360(a)*R.DEGREES_TO_RADIANS;var i=(r=y.normalizeAngle360(r)*R.DEGREES_TO_RADIANS)+n*Math.sin(r)*(1+n*Math.cos(r)),o=Math.cos(i)-n,s=Math.sqrt(1-n*n)*Math.sin(i);return{lonsun:Math.atan2(s,o)+a,rsun:Math.sqrt(o*o+s*s)}}},O=f.a.ArgumentError,A=f.a.GpuProgram,L=f.a.Logger,D=f.a.Matrix,j=f.a.Color,T=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(E.a)(this,Object(S.a)(t).call(this,e,"attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}","precision mediump float;\nuniform sampler2D textureSampler;\nuniform int fragMode;\nuniform vec4 color;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (fragMode == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else if (fragMode == 0) {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n   else if (fragMode == 2) {\n       gl_FragColor = color;\n   }\n}",["vertexPoint"]))).FRAG_MODE_MIX_COLOR=0,a.FRAG_MODE_TEXTURE=1,a.FRAG_MODE_COLOR=2,a.vertexPointLocation=a.attributeLocation(e,"vertexPoint"),a.mvpMatrixLocation=a.uniformLocation(e,"mvpMatrix"),a.numDaysLocation=a.uniformLocation(e,"numDays"),a.magnitudeRangeLocation=a.uniformLocation(e,"magnitudeRange"),a.textureUnitLocation=a.uniformLocation(e,"textureSampler"),a.fragModeLocation=a.uniformLocation(e,"fragMode"),a.colorLocation=a.uniformLocation(e,"color"),a.localState={mvpMatrix:null,numDays:null,magnitudeRange:null,textureUnit:null,fragMode:null,color:null},a}return Object(p.a)(t,e),Object(b.a)(t,[{key:"loadModelviewProjection",value:function(e,t){if(!t)throw new O(L.logMessage(L.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));var a=!1;null===this.localState.mvpMatrix&&(a=!0,this.localState.mvpMatrix=D.fromIdentity()),!a&&this.localState.mvpMatrix.equals(t)||(this.loadUniformMatrix(e,t,this.mvpMatrixLocation),this.localState.mvpMatrix.copy(t))}},{key:"loadNumDays",value:function(e,t){if(null==t)throw new O(L.logMessage(L.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));this.localState.numDays!==t&&(e.uniform1f(this.numDaysLocation,t),this.localState.numDays=t)}},{key:"loadMagnitudeRange",value:function(e,t,a){if(null==t)throw new O(L.logMessage(L.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(null==a)throw new O(L.logMessage(L.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));var n=!1;null===this.localState.magnitudeRange&&(n=!0,this.localState.magnitudeRange=[t,a]),(n||this.localState.magnitudeRange[0]!==t||this.localState.magnitudeRange[1]!==a)&&(e.uniform2f(this.magnitudeRangeLocation,t,a),this.localState.magnitudeRange[0]=t,this.localState.magnitudeRange[1]=a)}},{key:"loadTextureUnit",value:function(e,t){this.localState.textureUnit!==t&&(e.uniform1i(this.textureUnitLocation,t-e.TEXTURE0),this.localState.textureUnit=t)}},{key:"loadFragMode",value:function(e,t){this.localState.fragMode!==t&&(e.uniform1i(this.fragModeLocation,t),this.localState.fragMode=t)}},{key:"loadColor",value:function(e,t){var a=!1;null===this.localState.color&&(a=!0,this.localState.color=new j(0,0,0,0)),!a&&this.localState.color.equals(t)||(this.loadUniformColor(e,t,this.colorLocation),this.localState.color.copy(t))}}]),t}(A);T.key="WorldWindGpuStarFieldFullProgram";var P=T,N=(f.a.Color,f.a.Layer),C=f.a.Logger,x=f.a.Matrix,I=f.a.REDRAW_EVENT_TYPE,F=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(E.a)(this,Object(S.a)(t).call(this,"StarField"))).pickEnabled=!1,a.sunSize=128,a.showSun=!0,a._starDataSource=e||f.a.configuration.baseUrl+"images/stars.json",a._sunImageSource=f.a.configuration.baseUrl+"images/sunTexture.png",a._matrix=x.fromIdentity(),a._starsPositionsVboCacheKey=null,a._numStars=0,a._starData=null,a._minMagnitude=Number.MAX_VALUE,a._maxMagnitude=Number.MIN_VALUE,a._loadStarted=!1,a._minScale=3e7,a._scale=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,a._sunPositionsCacheKey="",a._sunBufferView=new Float32Array(4),a._MAX_GL_POINT_SIZE=0,a.showPlanets=!0;return a.planets=[{id:w.MERCURY,url:"images/Mercury64.png",size:8,ra:null,dec:null},{id:w.VENUS,url:"images/Venus64.png",size:8,ra:null,dec:null},{id:w.MARS,url:"images/Mars64.png",size:8,ra:null,dec:null},{id:w.JUPITER,url:"images/Jupiter64.png",size:32,ra:null,dec:null},{id:w.SATURN,url:"images/Saturn64.png",size:32,ra:null,dec:null},{id:w.URANUS,url:"images/Uranus64.png",size:16,ra:null,dec:null},{id:w.NEPTUNE,url:"images/Neptune64.png",size:16,ra:null,dec:null}],a._planetsBufferView=null,a._cacheKeys={sunPosition:"",planetPositions:"",starPositions:""},a}return Object(p.a)(t,e),Object(b.a)(t,[{key:"doRender",value:function(e){if(!e.globe.is2D())if(this.haveResources(e)){this.beginRendering(e);try{this.doDraw(e)}finally{this.endRendering(e)}}else this.loadResources(e)}},{key:"haveResources",value:function(e){var t=e.gpuResourceCache.resourceForKey(this._sunImageSource),a=this.planets.every(function(t){return!!e.gpuResourceCache.resourceForKey(t.url)});return null!=this._starData&&null!=t&&a}},{key:"loadResources",value:function(e){var t=e.currentGlContext,a=e.gpuResourceCache;this._starData||this.fetchStarData(),a.resourceForKey(this._sunImageSource)||a.retrieveTexture(t,this._sunImageSource),this.planets.forEach(function(e){a.resourceForKey(e.url)||a.retrieveTexture(t,e.url)})}},{key:"beginRendering",value:function(e){var t=e.currentGlContext;e.findAndBindProgram(P),t.enableVertexAttribArray(0),t.depthMask(!1)}},{key:"doDraw",value:function(e){this.loadCommonUniforms(e),this.renderStars(e),this.showSun&&this.renderSun(e),this.showPlanets&&this.renderPlanets(e)}},{key:"loadCommonUniforms",value:function(e){var t=e.currentGlContext,a=e.currentProgram,n=e.modelviewProjection||e.navigatorState.modelviewProjection;this._matrix.copy(n),this._matrix.multiplyByScale(this._scale,this._scale,this._scale),a.loadModelviewProjection(t,this._matrix);var r=y.computeJulianDate(this.time||new Date);a.loadNumDays(t,r-2451545)}},{key:"renderStars",value:function(e){var t=e.currentGlContext,a=e.gpuResourceCache,n=e.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=a.generateCacheKey());var r=a.resourceForKey(this._starsPositionsVboCacheKey);if(r)t.bindBuffer(t.ARRAY_BUFFER,r);else{r=t.createBuffer();var i=this.createStarsGeometry();a.putResource(this._starsPositionsVboCacheKey,r,4*i.length),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW)}e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),n.loadMagnitudeRange(t,this._minMagnitude,this._maxMagnitude),n.loadFragMode(t,n.FRAG_MODE_MIX_COLOR),t.drawArrays(t.POINTS,0,this._numStars)}},{key:"renderPlanets",value:function(e){var t=this,a=e.currentGlContext,n=e.currentProgram,r=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=a.getParameter(a.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&C.log(C.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE),this.planets.forEach(function(e){var a=w.getCelestialLocation(e.id,t.time||new Date),n=a.ra,r=a.dec;e.ra=n,e.dec=r},this),this._planetsBufferView||(this._planetsBufferView=new Float32Array(4*this.planets.length));for(var i=0;i<this.planets.length;i++){var o=this.planets[i];this._planetsBufferView[4*i+0]=o.dec,this._planetsBufferView[4*i+1]=o.ra,this._planetsBufferView[4*i+2]=Math.min(o.size,this._MAX_GL_POINT_SIZE),this._planetsBufferView[4*i+3]=1}this._planetsPositionsVboCacheKey||(this._planetsPositionsVboCacheKey=r.generateCacheKey());var s=r.resourceForKey(this._planetsPositionsVboCacheKey);s?(a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferSubData(a.ARRAY_BUFFER,0,this._planetsBufferView)):(s=a.createBuffer(),r.putResource(this._planetsPositionsVboCacheKey,s,4*this._planetsBufferView.length),a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,this._planetsBufferView,a.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),a.vertexAttribPointer(0,4,a.FLOAT,!1,0,0),n.loadFragMode(a,n.FRAG_MODE_TEXTURE);for(var c=0;c<this.planets.length;c++){var l=this.planets[c].url;e.gpuResourceCache.resourceForKey(l).bind(e),a.drawArrays(a.POINTS,c,1)}}},{key:"renderSun",value:function(e){var t=e.currentGlContext,a=e.currentProgram,n=e.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&C.log(C.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var r=y.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=r.declination,this._sunBufferView[1]=r.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=n.generateCacheKey());var i=n.resourceForKey(this._sunPositionsCacheKey);i?(t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferSubData(t.ARRAY_BUFFER,0,this._sunBufferView)):(i=t.createBuffer(),n.putResource(this._sunPositionsCacheKey,i,4*this._sunBufferView.length),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,this._sunBufferView,t.DYNAMIC_DRAW)),e.frameStatistics.incrementVboLoadCount(1),t.vertexAttribPointer(0,4,t.FLOAT,!1,0,0),a.loadFragMode(t,a.FRAG_MODE_TEXTURE),e.gpuResourceCache.resourceForKey(this._sunImageSource).bind(e),t.drawArrays(t.POINTS,0,1)}},{key:"endRendering",value:function(e){var t=e.currentGlContext;t.depthMask(!0),t.disableVertexAttribArray(0)}},{key:"fetchStarData",value:function(){if(!this._loadStarted){this._loadStarted=!0;var e=this,t=new XMLHttpRequest;t.onload=function(){if(this.status>=200&&this.status<300)try{e._starData=JSON.parse(this.response),e.sendRedrawRequest()}catch(t){C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+t.toString())}else C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);e._loadStarted=!1},t.onerror=function(){C.log(C.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),e._loadStarted=!1},t.ontimeout=function(){C.log(C.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),e._loadStarted=!1},t.open("GET",this._starDataSource,!0),t.send()}}},{key:"createStarsGeometry",value:function(){var e=this.parseStarsMetadata(this._starData.metadata);if(-1===e.raIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(-1===e.decIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(-1===e.magIndex)throw new Error(C.logMessage(C.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var t=this._starData.data,a=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var n=0,r=t.length;n<r;n++){var i=t[n],o=i[e.decIndex],s=i[e.raIndex],c=i[e.magIndex],l=c<2?2:1;a.push(o,s,l,c),this._minMagnitude=Math.min(this._minMagnitude,c),this._maxMagnitude=Math.max(this._maxMagnitude,c)}return this._numStars=Math.floor(a.length/4),a}},{key:"parseStarsMetadata",value:function(e){for(var t=-1,a=-1,n=-1,r=0,i=e.length;r<i;r++){var o=e[r];"ra"===o.name&&(t=r),"dec"===o.name&&(a=r),"vmag"===o.name&&(n=r)}return{raIndex:t,decIndex:a,magIndex:n}}},{key:"invalidateStarData",value:function(){this._starData=null,this._starsPositionsVboCacheKey=null}},{key:"sendRedrawRequest",value:function(){var e=document.createEvent("Event");e.initEvent(I,!0,!0),window.dispatchEvent(e)}},{key:"starDataSource",get:function(){return this._starDataSource},set:function(e){this._starDataSource=e,this.invalidateStarData()}},{key:"sunImageSource",get:function(){return this._sunImageSource},set:function(e){this._sunImageSource=e}}]),t}(N),V=f.a.PickedObject,k=f.a.SurfacePolygon;f.a.SurfaceShape,f.a.SurfacePolygon;function U(e){var t=e.id,a=e.clon,r=e.clat,i=e.alt,o=e.starfield,c=e.atmosphere,d=e.names,m=Object(n.useRef)(null),b=Object(n.useState)("3D"),E=Object(s.a)(b,2),S=(E[0],E[1]),p=Object(n.useState)(""),v=Object(s.a)(p,2),_=(v[0],v[1],Object(n.useState)([])),M=Object(s.a)(_,2),y=M[0],R=M[1],w=Object(n.useState)([]),O=Object(s.a)(w,2),A=(O[0],O[1],Object(n.useState)({latitude:r,longitude:a,altitude:i,aoi:"",pickedItems:[]})),L=Object(s.a)(A,2),D=L[0],j=L[1];function T(e){console.log(e.computeSectors(m.current.drawContext)),console.log(f.a.Sector.FULL_SPHERE);var t={service:"https://view.onda-dias.eu/instance00/ows",layerNames:"S1_IW_GRDH_FullResolution",title:"quicklook",numLevels:19,format:"image/png",size:256,sector:e.computeSectors(m.current.drawContext)[0],levelZeroDelta:new f.a.Location(90,90)},a=new f.a.WmsLayer(t,e.userProperties.date);m.current.addLayer(a),m.current.redraw(),console.log(m.current.layers)}function P(e){for(var t=0;t<m.current.layers.length;t++)if(m.current.layers[t].displayName===e)return m.current.layers[t];return null}function N(e){return C.apply(this,arguments)}function C(){return(C=Object(g.a)(l.a.mark(function e(t){var a,n,r,i,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(108e5,a=0;a<m.current.layers.length;a++){if(m.current.layers[a].displayName.includes("Products:"))for(n=0;n<m.current.layers[a].renderables.length;n++)r=m.current.layers[a].renderables[n],0!=t?(i=new Date(r.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStartTime).getTime(),o=new Date(r.userProperties.earthObservation.acquisitionInformation[0].acquisitionParameter.acquisitionStopTime).getTime(),r.enabled=i<=t+54e5&&o>=t-54e5):r.enabled=!1;m.current.layers[a].displayName}case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var x=function(){var e=m.current.navigator.lookAtLocation.longitude,t=m.current.navigator.lookAtLocation.latitude,a=m.current.navigator.range,n=a<2e6?function(){var e,t,a=m.current.viewport,n="";try{(e=m.current.pickTerrain(m.current.canvasCoordinates(a.x,a.y+a.height)).terrainObject().position).latitude=Math.round(1e4*e.latitude)/1e4,e.longitude=Math.round(1e4*e.longitude)/1e4}catch(r){e=null}try{(t=m.current.pickTerrain(m.current.canvasCoordinates(a.x+a.width,a.y)).terrainObject().position).latitude=Math.round(1e4*t.latitude)/1e4,t.longitude=Math.round(1e4*t.longitude)/1e4}catch(r){t=null}return null==e||null==t?n="":(e.longitude,e.latitude,t.longitude,t.latitude,n="POLYGON(("+e.longitude+" "+e.latitude+","+t.longitude+" "+e.latitude+","+t.longitude+" "+t.latitude+","+e.longitude+" "+t.latitude+","+e.longitude+" "+e.latitude+"))"),n}():"";j(function(r){return Object(u.a)({},r,{longitude:e,latitude:t,altitude:a,viewpolygon:n})})},I=function(e){var t=e.clientX,a=e.clientY,n=m.current.pick(m.current.canvasCoordinates(t,a));if(console.log(n),n.terrainObject()){m.current.removeLayer(P("quicklook"));for(var r=0;r<m.current.layers.length;r++)if(m.current.layers[r].displayName.includes("Products:"))for(var i=0;i<m.current.layers[r].renderables.length;i++){m.current.layers[r].renderables[i].highlighted=!1}for(var o=[],s=0;s<n.objects.length;s++)n.objects[s].userObject instanceof f.a.SurfaceShape&&(o.push(n.objects[s].userObject),n.objects[s].userObject.highlighted=!n.objects[s].userObject.highlighted,T(n.objects[s].userObject));console.log(o),j(function(e){return Object(u.a)({},e,{pickedItems:o})}),m.current.redraw()}else console.log("No position !")},V=function(e){console.log("double click");var t,a=e.clientX,n=e.clientY,r=m.current.pick(m.current.canvasCoordinates(a,n));if(r.terrainObject()){var i="POINT("+(t=r.terrainObject().position).longitude+" "+t.latitude+")";j(function(e){return Object(u.a)({},e,{aoi:i})})}else console.log("No position !"),j(function(e){return Object(u.a)({},e,{aoi:""})})};return Object(n.useEffect)(function(){console.log("useEffect (mount) in Eww  star/atmo: "+o+"/"+c),m.current=new f.a.WorldWindow(t),m.current.redrawCallbacks.push(x),f.a.BasicWorldWindowController.prototype.applyLimits=function(){m.current.navigator.range=f.a.WWMath.clamp(m.current.navigator.range,2e3,3e8)};var e=new f.a.ClickRecognizer(m.current,I);e.numberOfClicks=1;var n=new f.a.ClickRecognizer(m.current,V);n.numberOfClicks=2,n.recognizeSimultaneouslyWith(e),n.maxClickInterval=200;var s=new f.a.TapRecognizer(m.current,I);s.numberOfTaps=1;var l=new f.a.TapRecognizer(m.current,V);l.numberOfTaps=2,l.recognizeSimultaneouslyWith(s),l.maxTapInterval=200;var u={service:"https://tiles.esa.maps.eox.at/wms",layerNames:"s2cloudless-2018",title:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)},g={service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",title:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:f.a.Sector.FULL_SPHERE,levelZeroDelta:new f.a.Location(90,90)};console.log(f.a.configuration.baseUrl),f.a.configuration.baseUrl=f.a.configuration.baseUrl.slice(0,-3),console.log(f.a.configuration.baseUrl);for(var h=new F,b=new f.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg"),E=new f.a.RenderableLayer("Quicklooks"),S=[{layer:new f.a.WmsLayer(u,""),enabled:!0},{layer:new f.a.WmsLayer(g,""),enabled:d},{layer:h,enabled:o},{layer:b,enabled:c},{layer:E,enabled:!0}],p=0;p<S.length;p++)S[p].layer.enabled=S[p].enabled,m.current.addLayer(S[p].layer);h.time=new Date,b.time=new Date,setTimeout(function(){m.current.goToAnimator.travelTime=1e3,m.current.goTo(new f.a.Position(r,a,i)),m.current.redraw()},2e3),m.current.redraw(),m.current.deepPicking=!0},[]),{ewwstate:D,removeGeojson:function(){for(var e=0;e<y.length;e++)m.current.removeLayer(y[e]);R(function(e){return[]}),m.current.redraw()},addGeojson:function(e,t){var a=new f.a.RenderableLayer("Products: "+e.properties.updated+Math.ceil(1e4*Math.random()));m.current.addLayer(a),new f.a.GeoJSONParser(e).load(function(){console.log(a),R(function(e){return[].concat(Object(h.a)(e),[a])}),N(t),m.current.redraw()},function(e,t){var a={};a.userProperties=t;var n=new f.a.PlacemarkAttributes(null);return n.imageScale=10,n.imageColor=new f.a.Color(0,1,1,.2),n.labelAttributes.offset=new f.a.Offset(f.a.OFFSET_FRACTION,5,f.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?a.attributes=new f.a.PlacemarkAttributes(n):e.isLineStringType()||e.isMultiLineStringType()?(a.attributes.drawOutline=!0,a.attributes.outlineColor=new f.a.Color(.1*a.attributes.interiorColor.red,.3*a.attributes.interiorColor.green,.7*a.attributes.interiorColor.blue,1),a.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(a.attributes=new f.a.ShapeAttributes(null),a.attributes.interiorColor=new f.a.Color(1,0,0,.2),a.attributes.outlineColor=new f.a.Color(1,0,0,.3),a.highlightAttributes=new f.a.ShapeAttributes(a.attributes),a.highlightAttributes.outlineColor=new f.a.Color(1,0,0,.4),a.highlightAttributes.interiorColor=new f.a.Color(1,0,0,0)),a},a)},addWMS:function(){},toggleStarfield:function(){console.log("toggleStarfield"),m.current.layers[2].enabled=!m.current.layers[2].enabled,m.current.redraw()},toggleAtmosphere:function(){console.log("toggleAtmosphere"),m.current.layers[3].enabled=!m.current.layers[3].enabled,m.current.redraw()},setTime:function(e){P("StarField").time=P("Atmosphere").time=new Date(e),N(e),m.current.redraw()},toggleProjection:function(){S(function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator"],a=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[a]),t[a]){case"3D":m.current.globe.projection=new f.a.ProjectionWgs84;break;case"Equirectangular":m.current.globe.projection=new f.a.ProjectionEquirectangular;break;case"Mercator":m.current.globe.projection=new f.a.ProjectionMercator;break;case"North Polar":m.current.globe.projection=new f.a.ProjectionPolarEquidistant("North");break;case"South Polar":m.current.globe.projection=new f.a.ProjectionPolarEquidistant("South");break;default:m.current.globe.projection=new f.a.ProjectionWgs84}return m.current.redraw(),t[a]})},toggleNames:function(){console.log("toggleNames"),m.current.layers[1].enabled=!m.current.layers[1].enabled,m.current.redraw()},northUp:function(){var e=m.current,t=1;Math.abs(e.navigator.heading)>60?t=2:Math.abs(navigator.heading)>120&&(t=3),e.navigator.heading>0&&(t=-t),setTimeout(function a(){Math.abs(e.navigator.heading)>Math.abs(t)?(e.navigator.heading+=t,setTimeout(a,10)):e.navigator.heading=0,e.redraw()},10)}}}var G=a(11);var z=function(e){var t=e.viewdate,a=e.id,i=U({id:a,clat:e.clat,clon:e.clon,alt:e.alt,starfield:e.starfield,atmosphere:e.atmosphere,names:e.names}),o=(i.ewwstate,i.addGeojson,i.removeGeojson),s=(i.addWMS,i.toggleProjection),c=i.toggleAtmosphere,l=i.toggleStarfield,u=i.toggleNames,g=i.setTime,h=i.northUp;return Object(G.a)("p",s),Object(G.a)("a",c),Object(G.a)("s",l),Object(G.a)("n",u),Object(G.a)("c",o),Object(G.a)("u",h),Object(n.useEffect)(function(){g(t.getTime())},[t]),r.a.createElement("canvas",{id:a,style:{background:"inherit",position:"fixed",left:0,width:"100%",height:"100%"}})},B=a(20),W=a.n(B);a(38);var Y=function(e){var t=e.date,a=e.highlight,n=e.animated;return r.a.createElement("div",{className:"LabelContainer"},r.a.createElement("div",{className:"Date"},r.a.createElement("div",{className:"day"===a||"none"===a?"DayLabel":"DayLabel Greyedout",key:"day"},W()(t,"UTC:dd")),r.a.createElement("div",{className:"YearMonth"},r.a.createElement("div",{className:"month"===a||"none"===a?"MonthLabel ":"MonthLabel  Greyedout",key:"month"},W()(t,"UTC:mmm").toUpperCase()),r.a.createElement("div",{className:"year"===a||"none"===a?"YearLabel ":"YearLabel Greyedout",key:"year"},t.getUTCFullYear()))),r.a.createElement("div",{className:n?"Line  Line-active":"Line",key:"line"}),r.a.createElement("div",{className:"time"===a||"none"===a?"TimeLabel ":"TimeLabel Greyedout",key:"time"},W()(t,"UTC:HH:MM:ss")))};a(39);var K=function(e){var t=e.startdate,a=e.onDateChange,i=function(e){var t=e.autoStart,a=(e.duration,e.initdate),r=Object(n.useState)(a),i=Object(s.a)(r,2),o=i[0],c=i[1],l=Object(n.useState)(!1),u=Object(s.a)(l,2),g=u[0],h=u[1],d=Object(n.useRef)(),f=Object(n.useRef)();f.current=50;var m=Object(n.useRef)(),b=Object(n.useRef)(),E=Object(n.useRef)();function S(){console.log("start clock"),d.current||(d.current=36e5),b.current=setInterval(function(){m.current+=d.current,c(new Date(m.current))},f.current),h(!0)}function p(){console.log("stop clock"),E.current&&clearTimeout(E.current),b.current&&clearInterval(b.current),h(!1)}return Object(n.useEffect)(function(){console.log("init start useclock "+a.toJSON()),g?(p(),m.current=a.getTime(),S()):m.current=a.getTime()},[a]),Object(n.useEffect)(function(){console.log("render useclock"),m.current=(new Date).getTime(),t&&S()},[]),{date:o,playing:g,togglePause:function(){g?p():S()},reset:function(){p(),m.current=(new Date).getTime(),c(new Date(m.current))},increaseSpeed:function(){d.current=d.current>0?d.current*=2:d.current/=2,Math.abs(d.current)<f.current&&(d.current=f.current),console.log("step: "+d.current)},decreaseSpeed:function(){d.current=d.current>0?d.current/=2:d.current*=2,Math.abs(d.current)<f.current&&(d.current=-1*f.current)},forceDate:function(e){console.log("forcedate useclock: "+e.toJSON()),g?(p(),m.current=e.getTime(),S()):m.current=e.getTime()}}}({autoStart:!1,duration:6e5,initdate:t}),o=i.date,c=i.togglePause,l=i.reset,u=i.increaseSpeed,g=i.decreaseSpeed;Object(G.a)("t",c),Object(G.a)("r",function(){l()}),Object(G.a)(".",u),Object(G.a)(",",g),Object(n.useEffect)(function(){a(o)},[o]),Object(n.useEffect)(function(){},[t]);var h=Object(n.useState)(),d=Object(s.a)(h,2),f=d[0],m=d[1];return r.a.createElement("div",{className:"DateController",onClick:function(){var e=Date.now();f&&e-f<300?l():(m(e),c())}})},X=a(16),q=a(24),J=a(17);a(22);var H=function(e){var t=e.date,a=e.zoomfactor,i=e.immediate,o=Object(n.useRef)(),c=Object(n.useState)(t),l=Object(s.a)(c,2),u=(l[0],l[1],Object(n.useState)(!1)),g=Object(s.a)(u,2),h=(g[0],g[1],Object(n.useState)("")),d=Object(s.a)(h,2),f=d[0],m=d[1];Object(n.useEffect)(function(){return function(){}});var b=function(e,t){if(o.current){for(var a,n,i,s=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],c=0,l=0,u=0,g=0,h=0,d=[],f=t<2592e7,m=t<432e6,b=t<72e5,E=t<12e5,S=t<48e4,p=0;p<o.current.offsetHeight;p+=1){var v=new Date((p-o.current.offsetHeight/2)*t+e.getTime());a=v.getUTCDate(),n=s[v.getUTCMonth()],i=v.getUTCHours(),c=v.getUTCFullYear(),E?i!=h&&(0==i||i%2!=0&&!S?0==i&&(d.push({class:"DayTic",pos:p,label:a}),d.push({class:"MonthTic",pos:p,label:n}),d.push({class:"YearTic",pos:p,label:c})):d.push({class:"HourTic",pos:p,label:i})):b?a!==l&&(1!=a?d.push({class:"DayTic",pos:p,label:a}):(d.push({class:"DayTic",pos:p,label:a}),d.push({class:"MonthTic",pos:p,label:n}),d.push({class:"YearTic",pos:p,label:c}))):m?n!==u&&0!=l&&m&&("JAN"!==n?d.push({class:"MonthTic",pos:p,label:n}):(d.push({class:"MonthTic",pos:p,label:n}),d.push({class:"YearTic",pos:p,label:c}))):f&&c!==g&&0!==u&&("JAN"!==n?d.push({class:"MonthTic",pos:p,label:n}):d.push({class:"YearTic",pos:p,label:c})),l=a,g=c,u=n,h=i}return d.map(function(e){return r.a.createElement("div",{className:e.class,key:e.class+e.pos,style:{top:e.pos}},e.label)})}},E=Object(X.b)(function(){return{dater:t.getTime(),zoomer:a}}),S=Object(s.a)(E,2),p=S[0],v=p.dater,_=p.zoomer,M=S[1];return Object(n.useLayoutEffect)(function(){M({to:{zoomer:a,dater:t.getTime()},config:{duration:400},immediate:!1,onFrame:function(){m(b(new Date(v.value),_.value))}})},[a]),Object(n.useLayoutEffect)(function(){M({to:{zoomer:a,dater:t.getTime()},config:{duration:400},immediate:i,onFrame:function(){m(b(new Date(v.value),_.value))}})},[t]),r.a.createElement(X.a.div,{ref:o,className:"DateSelectorScale"},f)};var Z=function(e){var t=e.startdate,a=e.onDateChange,i=e.onFinalDateChange,o=[36e5,864e5,1296e6],c=[36e5,6e5,108e3,27e3,864e5],l=Object(n.useRef)(),u=Object(n.useRef)();u.current||(u.current=[0,0]);var g=Object(n.useState)(t),h=Object(s.a)(g,2),d=h[0],f=h[1],m=Object(n.useState)(t),b=Object(s.a)(m,2),E=b[0],S=b[1],p=Object(n.useState)(t),v=Object(s.a)(p,2),_=v[0],M=v[1],y=Object(n.useState)(!1),R=Object(s.a)(y,2),w=R[0],O=R[1],A=Object(n.useState)(o[0]),L=Object(s.a)(A,2),D=L[0],j=L[1],T=Object(X.b)(function(){return{xy:[0,0]}}),P=Object(s.a)(T,2),N=P[0].xy,C=P[1],x=Object(q.a)({onDrag:function(e){var t,a,n=e.event,r=e.first,s=e.down,g=e.delta,h=e.velocity,m=e.direction,b=e.temp,E=void 0===b?{xy:N.getValue(),laststeparea:0,deltaoffset:[0,0]}:b,p=l.current.parentElement.offsetWidth-(n.pageX?n.pageX:l.current.parentElement.offsetWidth);return(n.pageY?n.pageY:l.current.parentElement.offsetHeight)-l.current.offsetHeight/2>0?(t=Math.min(o.length-1,Math.floor((p-l.current.offsetWidth)/60+1)),a=o[t=(t=t>o.length-1?o.length:t)<0?0:t]):(t=Math.min(c.length-1,Math.floor((p-l.current.offsetWidth)/60+1)),a=c[t=(t=t>c.length-1?c.length:t)<0?0:t]),t!==E.laststeparea&&(console.log(" step changed: "+E.laststeparea+" to "+t),j(a),M(d),E.laststeparea=t,E.xy=[0,0],E.deltaoffset=g),r&&O(!0),h=Math.abs(h)<.2?0:h,C({xy:Object(J.add)(Object(J.scale)(Object(J.add)(Object(J.sub)(g,E.deltaoffset),u.current),1),E.xy),immediate:s,config:{velocity:Object(J.scale)(m,1*h),decay:!0},onFrame:function(){var e=new Date(_.getTime()-N.getValue()[1]*D);f(e),S(e)},onRest:function(){if(!s){O(!1);var e=new Date(_.getTime()-N.getValue()[1]*D);i(e),u.current=[0,0]}}}),E}});return Object(n.useEffect)(function(){w||(u.current[1]-=(t.getTime()-E.getTime())/D,f(t),S(t))},[t]),Object(n.useEffect)(function(){a(d)},[d]),r.a.createElement(X.a.div,Object.assign({},x(),{className:"DateSelector",ref:l}),r.a.createElement("div",{className:"Mask"},r.a.createElement(H,{className:"scale",date:d,zoomfactor:D,immediate:w}),r.a.createElement("div",{className:"TriangleContainer"},r.a.createElement("svg",{height:"40",width:"20",className:"Triangle"},r.a.createElement("polygon",{points:"20,5 20,35 12,20"})))))};var Q=function(e){var t=e.startdate,a=e.onDateChange,i=(e.onFinalDateChange,e.searching),o=Object(n.useState)(t),c=Object(s.a)(o,2),l=c[0],u=c[1],g=Object(n.useState)(t),h=Object(s.a)(g,2),d=h[0],f=h[1],m=Object(n.useState)(t),b=Object(s.a)(m,2),E=b[0],S=b[1];return Object(n.useEffect)(function(){u(t)},[t]),r.a.createElement("div",null,r.a.createElement(K,{startdate:d,onDateChange:function(e){u(e)}}),r.a.createElement(Y,{date:E,highlight:"none",animated:i}),r.a.createElement(Z,{startdate:l,onDateChange:function(e){S(e),a(e)},onFinalDateChange:function(e){f(e)}}))},$=a(25),ee=a.n($),te=a(26);var ae=function(){var e=new Date,t=Object(n.useState)(e),a=Object(s.a)(t,2),i=a[0],o=a[1],c=Object(n.useState)(e),l=Object(s.a)(c,1)[0],u=Object(n.useState)(!1),g=Object(s.a)(u,1)[0];Object(n.useEffect)(function(){},[]),Object(n.useEffect)(function(){},[l]);var h=Object(n.useState)(!1),d=Object(s.a)(h,2),f=d[0],m=d[1],b=Object(te.a)(window.document.body),E=b.isFullscreen,S=b.toggleFullscreen;return Object(G.a)("f",S),r.a.createElement("div",{className:"App"},r.a.createElement(ee.a,{enabled:f,onChange:function(){E||m(!1)}},r.a.createElement("div",{className:"Earth"},r.a.createElement(z,{viewdate:i,id:"globe",starfield:"true",atmosphere:"true",clon:"0.5",clat:"40",names:"true"})),r.a.createElement(Q,{startdate:l,searching:g,onDateChange:function(e){o(e)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.d98d112a.chunk.js.map